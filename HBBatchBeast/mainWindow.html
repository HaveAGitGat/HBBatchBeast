<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">


</head>

<script>

    "use strict";

    //2 functions to catch/display any errors as early as possible.

    function updateConsole(message, skipWrite) {

        consoleItemCount++

        if (consoleItemCount >= 200) {

            document.getElementById('consoleDiv').removeChild(document.getElementById('consoleDiv').getElementsByTagName('p')[0]);

        }

        document.getElementById("consoleDiv").innerHTML += "<p>" + "[" + getTimeNow() + "]" + message + "</p>"

        document.getElementById("consoleBar").scrollTop = document.getElementById("consoleBar").scrollHeight


        if (skipWrite != true) {
            fs.appendFileSync(homePath + '/Documents/HBBatchBeast/Logs/MasterLog.txt', "[" + getDateNow() + "#" + getTimeNow() + "]" + message + "\r\n", 'utf8');
        }

    }


    process.on('uncaughtException', function (err) {
        //console.error(err.stack);

        updateConsole(err.stack);

        //process.exit();
    });













    //"use strict";


    var zingchart = require("zingchart")
    //SET ENV
    if (__dirname.includes('.asar')) { // If dev
        process.env.NODE_ENV = "production";
        var serverStem = "http://hbbatchbeast.io/"
    } else {

        // var serverStem = "http://hbbatchbeast.io/"
        var serverStem = "http://localhost:8080/"
    }


    var home = require("os").homedir();


    if (process.platform == 'win32' || process.platform == 'linux') {
        // var homePathOld = "."
        var homePath = home
    }

    if (process.platform == 'darwin') {
        var homePath = home
    }



    if (process.platform == 'win32' || process.platform == 'linux') {
        var homePath2 = home
    }

    if (process.platform == 'darwin') {
        var homePath2 = home
    }

    //timenow

    function getTimeNow() {

        var d = new Date(),
            h = (d.getHours() < 10 ? '0' : '') + d.getHours(),
            m = (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();
        var s = (d.getSeconds() < 10 ? '0' : '') + d.getSeconds();
        var timenow = h + ':' + m + ':' + s;

        return timenow
    }

    function getDateNow() {

        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth() + 1;
        var yyyy = today.getFullYear();
        if (dd < 10) {
            dd = '0' + dd
        }
        // if (mm < 10) {
        //     mm = '0' + mm
        // }

        var months = ["January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"];

        mm = months[mm - 1];
        today = dd + '/' + mm + '/' + yyyy;
        var today2 = dd + '-' + mm + '-' + yyyy;
        return today2
    }






    function textAreaHeight() {
        //auto height text boxes
        var tx = document.getElementsByTagName('textarea');
        for (var i = 0; i < tx.length; i++) {
            tx[i].setAttribute('style', 'height:' + (tx[i].scrollHeight) + 'px;overflow-y:hidden;');
            tx[i].addEventListener("input", OnInput, false);
        }


    }


    //create scan number window
    const electron = require('electron')
    const url = require('url');
    //const path = require('path');
    const BrowserWindow = electron.remote.BrowserWindow;

    const electron2 = require('electron');
    const { ipcRenderer } = electron2;

    function createViewError() {

        //create new window

        ViewError = new BrowserWindow({
            width: 1000,
            height: 500,
            frame: false,
            title: 'View Error Window'

        });

        //Load html into window

        ViewError.loadURL(url.format({
            pathname: path.join(__dirname, '/windows/viewError.html'),
            protocol: 'file:',
            slashes: true

        }));



        //Garbage collection handle
        ViewError.on('close', function () {
            ViewError = null;

        });

    }

    function createViewMediaInfo() {

        //create new window

        viewMedia = new BrowserWindow({
            width: 500,
            height: 1000,
            frame: false,
            title: 'View Media Info'

        });

        //Load html into window

        viewMedia.loadURL(url.format({
            pathname: path.join(__dirname, '/windows/viewMediaInfo.html'),
            protocol: 'file:',
            slashes: true
        }));



        //Garbage collection handle
        viewMedia.on('close', function () {
            viewMedia = null;
        });



    }




    //Global variables

    var viewMedia
    var ViewError

    var fs = require('fs');
    var pathIsInside = require("path-is-inside");
    let workers = [];
    var timerModule = "";
    var viewSwitch = 0;
    var cp
    var globalQueueNumberManager = 0;
    var fileNotExistsCounter = 0;
    var totalFileFoundCounter = 0;
    var totalFileSize = 0;
    var inputPathArray = [];
    var outputPathArray = [];
    var sourceQueueArray = [];
    var skipOrCopyArray = [];
    var errorArray = [];
    var sourceQueueFileSizeArray = []
    var presetArray2 = [];

    var destinationQueue = []
    var destinationFinalQueue = []


    var sourceFileSize = 0
    var outputFileSize = 0


    var mode = "";
    var startDate
    var endDate
    var unConvertedFiles;
    var FFprobeArray = []
    var Bench

    var exportStatus
    var exportRemaining
    var exportSuccess
    var exportError
    var exportCancelled
    var exportOther
    var exportLastCompletedTime

    // evaluates "runScan();", deprecated behaviour, need to improve
    var windowRefresh = window.setInterval("runScan();", 1000);
    var updateInfo = 0;

    var countDownOn = 0;
    var QueueNumber1Old
    var colourSwitch = 0
    var sessionNumber = 0;
    var AllCompleted = 0;

    var timerSeconds
    var errorCount;
    var successfulCount;
    var cancelCount;
    var otherCount;


    var queueView
    var fullErrorLogArray = [];
    var tempOutputQueueHTML;
    var workerStatusFinishedArray = [];
    var queueStatusPaused = 0;
    var timeoutCounter
    var workerProgressArray = []
    var deleteArray = []

    var jsonConfig

    var workerStatusArray = []

    var consoleDivListener

    var consoleItemCount = 0

    var workersRunning = false
    var inProgress = false




    var prevTip = ""

    if (process.platform == 'win32') {
        var stringProcessingSlash = "\\";
    }

    if (process.platform == 'linux' || process.platform == 'darwin') {
        var stringProcessingSlash = "/";
    }

    var path = require("path");




    function toolTip(id) {
        if (document.getElementById("consoleBar").style.height == "5%") {

            document.getElementById("consoleBar").style.height = "50%";
            document.body.style.height = "50%";
            updateConsole("<font color=\"red\">------------------------------------------------------</font>", true)
            updateConsole("<font color=\"lightblue\">" + document.getElementById(id).innerHTML + "</font>", true)
            prevTip = id

        } else if (document.getElementById("consoleBar").style.height == "50%") {
            if (id != prevTip) {
                updateConsole("<font color=\"red\">------------------------------------------------------</font>", true)
                updateConsole("<font color=\"lightblue\">" + document.getElementById(id).innerHTML + "</font>", true)
                prevTip = id

            } else {
                document.getElementById("consoleBar").style.height = "5%";
                document.body.style.height = "100%";
                prevTip = ""

            }
        }


    }






    function setLanguage() {


        saveConfig();
        location.reload()

    }

    function setConfig() {
        saveConfig("skip");
        location.reload()
    }

    var selLang
    var selConf

    window.onload = function () {


        // save lang strings to json
        if (process.env.NODE_ENV != 'production') {


            var language_text = {}


            var lang_name_tags = document.getElementsByName("lang_text");
            for (var i = 0; i < lang_name_tags.length; i++) {

                var langText = lang_name_tags[i].textContent

                langText = langText.replace(/(\r\n|\n|\r)/gm, " ");
                langText = langText.replace(/\s+/g, " ");

                language_text[langText] = langText


            }

            var lang_button_tags = document.getElementsByTagName("input");
            for (var i = 0; i < lang_button_tags.length; i++) {
                if (lang_button_tags[i].type == "button") {
                    language_text[lang_button_tags[i].value] = lang_button_tags[i].value
                }
            }

            var jsonContent = JSON.stringify(language_text);

            fs.writeFileSync('./translations/en.json', jsonContent, 'utf8');

        }







        //format title and buttons depending on OS

        if (process.platform == 'win32' || process.platform == 'linux') {

            document.getElementById("window-controls").style.right = 0

            document.getElementById("min-button").style.gridColumn = 1;
            document.getElementById("max-button").style.gridColumn = 2;
            document.getElementById("close-button").style.gridColumn = 3;

        }
        if (process.platform == 'darwin') {

            document.getElementById("window-controls").style.left = 0

            document.getElementById("min-button").style.gridColumn = 2;
            document.getElementById("max-button").style.gridColumn = 3;
            document.getElementById("close-button").style.gridColumn = 1;

            document.getElementById("window-title").style.top = 0;
            document.getElementById("window-title").style.right = 0;
            document.getElementById("window-title").style.position = "absolute";
        }



        //create folders/logs if not exist
        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast")) {
            fs.mkdirSync(homePath + "/Documents/HBBatchBeast");

        }


        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Config")) {
            fs.mkdirSync(homePath + "/Documents/HBBatchBeast/Config");

        }


        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Config/Processes")) {
            fs.mkdirSync(homePath + "/Documents/HBBatchBeast/Config/Processes");
        }


        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Config/Processes/WorkerStatus")) {
            fs.mkdirSync(homePath + "/Documents/HBBatchBeast/Config/Processes/WorkerStatus");
        }


        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Config/Processes/WorkerStatus/Console")) {
            fs.mkdirSync(homePath + "/Documents/HBBatchBeast/Config/Processes/WorkerStatus/Console");
        }

        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Config/Processes/WorkerStatus/ErrorLogs")) {
            fs.mkdirSync(homePath + "/Documents/HBBatchBeast/Config/Processes/WorkerStatus/ErrorLogs");
        }

        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Logs")) {
            fs.mkdirSync(homePath + "/Documents/HBBatchBeast/Logs");
        }

        if (!fs.existsSync(homePath + '/Documents/HBBatchBeast/Logs/MasterLog.txt')) {
            fs.appendFileSync(homePath + '/Documents/HBBatchBeast/Logs/MasterLog.txt', "", 'utf8');
        }


        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Logs/healthyFileList.txt")) {
            fs.appendFileSync(homePath + "/Documents/HBBatchBeast/Logs/healthyFileList.txt", "", 'utf8');
        }

        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Logs/originalFileReplacedList.txt")) {
            fs.appendFileSync(homePath + "/Documents/HBBatchBeast/Logs/originalFileReplacedList.txt", "", 'utf8');
        }

        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Logs/ErrorLog.txt")) {
            fs.appendFileSync(homePath + "/Documents/HBBatchBeast/Logs/ErrorLog.txt", "", 'utf8');
        }


        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Logs/fileConversionLog.txt")) {
            fs.appendFileSync(homePath + "/Documents/HBBatchBeast/Logs/fileConversionLog.txt", "", 'utf8');
        }


        if (!fs.existsSync(homePath + "/Documents/HBBatchBeast/Logs/Scans.txt")) {
            fs.appendFileSync(homePath + "/Documents/HBBatchBeast/Logs/Scans.txt", "", 'utf8');
        }







        //set console
        document.getElementById("consoleBar").style.height = "5%";
        document.body.style.height = "100%";


        updateConsole("" + "HBBatchBeast loaded" + "")



















        if (fs.existsSync(homePath + '/Documents/HBBatchBeast/Config/Configuration.json')) {

            try {

                updateConsole("" + "Loading configuration file" + "")
                jsonConfig = JSON.parse(fs.readFileSync(homePath + '/Documents/HBBatchBeast/Config/Configuration.json', 'utf8'))
                updateConsole("" + "Configuration file loaded" + "")





            } catch (err) {

                console.log("Unable to load configuration file")
                updateConsole("" + "Unable to load configuration file" + "")


                folderChangeAlert();

                initConfig()



            }

        } else {


            updateConsole("" + "Unable to load configuration file" + "")
            folderChangeAlert();

            initConfig()


        }


        function folderChangeAlert() {
            if (process.platform == 'win32') {
                alert("Hello \n\nAs of v2.1.3, the way configuration settings are stored has been changed in order to allow multiple configurations so you'll need to re-do your configurations. \n\nAlso, in order to improve consistency across platforms and to make upgrading easier in future, the HBBatchBeast logs and config settings folder has changed to inside your 'Documents' folder.\n\n To retain your healthy file logs etc please move your old 'HBBatchBeast\\HBBatchBeast\\Logs' and 'HBBatchBeast\\HBBatchBeast\\Config' folders to:\n\n" + home + "\\Documents\\HBBatchBeast\\ \n\nSorry for the inconvenience.");

            }

            if (process.platform == 'linux' || process.platform == 'darwin') {
                alert("Hello \n\nAs of v2.1.3, the way configuration settings are stored has been changed in order to allow multiple configurations so you'll need to re-do your configurations. \n\nAlso, in order to improve consistency across platforms and to make upgrading easier in future, the HBBatchBeast logs and config settings folder has changed to inside your 'Documents' folder.\n\n To retain your healthy file logs etc please move your old 'home\\HBBatchBeast\\Logs' and 'home\\HBBatchBeast\\Config' folders to:\n\n" + home + "\\Documents\\HBBatchBeast\\ \n\nSorry for the inconvenience.");

            }
        }


        function initConfig() {


            jsonConfig = {
                lang: "en",
                selected_config: 0,
                configs: [
                    {},
                    {},
                    {},
                    {},
                    {},
                    {},
                    {},
                    {},
                    {},
                    {},
                ]

            }

            updateConsole("" + "Configuration created" + "")
        }


        if (jsonConfig.version_message != "2.1.5") {

            jsonConfig.version_message = "2.1.5"

            var versionChanges = `
v2.1.5

Bug related:

-Fixed Linux/macOS filename apostrophe issue (No longer necessary to remove apostrophes from filenames)


Features/additions:

-Added daily scan schedule time window - hh:mm - hh:mm. Queue will automatically be continued inside the time window and automatically paused outside of the time window.

-Filter queue and session output items.
-Health check output now shows all items, can filter.
-Verbose health check error logs removed unless 'Save verbose logs?' Checked.
-Moved file container filter to System tab.
-Option to reverse queue order.
-Added date to 'Finish time'
`

            alert(versionChanges)



        }





        selLang = document.getElementById('language_select');
        selLang.value = jsonConfig.lang
        selLang.addEventListener("change", setLanguage);

        var selected_config_no = jsonConfig.selected_config

        selConf = document.getElementById('select_configuration')
        selConf.value = selected_config_no
        selConf.addEventListener("change", setConfig);


        //load lang strings from json


        if (process.env.NODE_ENV != 'production') {
            var new_language = JSON.parse(fs.readFileSync('./translations/' + selLang.value + '.json', 'utf8'))
        } else {

            var new_language = require('./translations/' + selLang.value + '.json')

        }



        var lang_name_tags = document.getElementsByName("lang_text");
        for (var i = 0; i < lang_name_tags.length; i++) {

            var langText = lang_name_tags[i].textContent
            langText = langText.replace(/(\r\n|\n|\r)/gm, " ");
            langText = langText.replace(/\s+/g, " ");

            lang_name_tags[i].textContent = new_language[langText]


        }

        var lang_button_tags = document.getElementsByTagName("input");
        for (var i = 0; i < lang_button_tags.length; i++) {
            if (lang_button_tags[i].type == "button") {

                lang_button_tags[i].value = new_language[lang_button_tags[i].value]

            }
        }







        //Initialise undefined parts of config object
        for (var i = 0; i < 10; i++) {
            //Video health check tab
            jsonConfig.configs[i].tab_health == undefined ? jsonConfig.configs[i].tab_health = {} : true;
            jsonConfig.configs[i].tab_health.path == undefined ? jsonConfig.configs[i].tab_health.path = {} : true;

            // Batch tab

            jsonConfig.configs[i].tab_batch == undefined ? jsonConfig.configs[i].tab_batch = {} : true;
            jsonConfig.configs[i].tab_batch.path == undefined ? jsonConfig.configs[i].tab_batch.path = {} : true;
            jsonConfig.configs[i].tab_batch.advanced == undefined ? jsonConfig.configs[i].tab_batch.advanced = {} : true;



            // Remote viewing tab
            jsonConfig.configs[i].tab_remote == undefined ? jsonConfig.configs[i].tab_remote = {} : true;

            // System tab
            jsonConfig.configs[i].tab_system == undefined ? jsonConfig.configs[i].tab_system = {} : true;
        }







        document.getElementById("remoteMonitoringSpan").style.color = '#ef435d';

        fetch(serverStem + 'api/version', {
            method: 'get',
            headers: {

                'Content-Type': 'application/json',
                'Accept': 'application/json'


            },
        }).then(res => {
            if (res.ok) return res.json()
            //console.log(res.json())


        })
            .then(data => {


                document.getElementById("remoteMonitoringSpan").style.color = '#4CAF50';

                console.log(data)

                var Status = data

                if ("2.1.5" != Status.version) {

                    updateConsole("" + "New version available" + "")

                    // if (process.platform == 'win32') {
                    //     var systemFileType = ".7z"
                    //     var systemType = "Windows"

                    // } else if (process.platform == 'linux') {
                    //     var systemFileType = ".deb"
                    //     var systemType = "Linux"

                    // } else if (process.platform == 'darwin') {
                    //     var systemFileType = ".dmg"
                    //     var systemType = "macOS"
                    // }


                    if (process.platform == 'win32') {
                        var downloadLink = Status.windowsLink
                    } else if (process.platform == 'linux') {

                        var downloadLink = Status.linuxLink

                    } else if (process.platform == 'darwin') {
                        var downloadLink = Status.macOSLink
                    }


                    // 
                    // document.getElementById("downloadID").innerHTML = "<input type=\"button\" class=\"infoButton\"  onclick=\"openURL('https://github.com/HaveAGitGat/Documents/HBBatchBeast/releases/download/" + Status.version + "/hbbatchbeast-" + systemType + "-v" + Status.version + systemFileType + "')\" value=\"Download\">"

                    document.getElementById("downloadID").innerHTML = Status.version + " <input type=\"button\" class=\"infoButton\"  onclick=\"openURL('" + downloadLink + "')\" value=\"Download\">"
                    document.getElementById("newVersionDiv").style.display = 'block';

                } else {
                    updateConsole("" + "HBBatchBeast up to date" + "")
                }

            })


        if (process.platform == 'win32') {
            ipcRenderer.send('item:add', 'icon');
        }


        console.log((__dirname).replace('app.asar', 'app.asar.unpacked'))


        //  var ffmpegPath = (path.join(__dirname, '\\node_modules\\@ffmpeg-installer\\win32-x64\\ffmpeg.exe' )).replace('app.asar', 'app.asar.unpacked')

        // console.log(ffmpegPath)

        //testing
        try {
            var ffmpegPath = require('@ffmpeg-installer/ffmpeg').path;
            console.log(ffmpegPath)
        } catch (err) {

            console.log(err)
        }


        try {


            var ffmpegPath = require('@ffmpeg-installer/ffmpeg').path.replace('app.asar', 'app.asar.unpacked');
            console.log(ffmpegPath)
        } catch (err) {
            console.log(err)
        }
        //













        //   createViewError();






        textAreaHeight();





        //show custom bat path div if on Windows

        if (process.platform == 'win32') {
            document.getElementById("customBatPathDiv").style.display = 'block';
        }




        //var logpath = homePath + '/somefolderwhichexists/' + title + '.txt';


        //create program folders







        ////

        //Video health check tab

        jsonConfig.configs[selected_config_no].tab_health.path.corrupt_destination_path == undefined ? document.getElementById("corruptDestinationPath").value = "" : document.getElementById("corruptDestinationPath").value = jsonConfig.configs[selected_config_no].tab_health.path.corrupt_destination_path;
        jsonConfig.configs[selected_config_no].tab_health.move_corrupt_files_toggle == 1 ? document.getElementById("moveCorruptFileOnOff").checked = true : document.getElementById("moveCorruptFileOnOff").checked = false;
        jsonConfig.configs[selected_config_no].tab_health.thorough_health_check_toggle == 1 ? document.getElementById("runThoroughHealthCheck").checked = true : document.getElementById("runThoroughHealthCheck").checked = false;
        jsonConfig.configs[selected_config_no].tab_health.thorough_health_check_repair_toggle == 1 ? document.getElementById("repairAttempt").checked = true : document.getElementById("repairAttempt").checked = false;
        jsonConfig.configs[selected_config_no].tab_health.crf_repair_value == undefined ? document.getElementById("CRFRepairValue").value = 23 : document.getElementById("CRFRepairValue").value = jsonConfig.configs[selected_config_no].tab_health.crf_repair_value;


        //Batch tab

        jsonConfig.configs[selected_config_no].tab_batch.path.source_path == undefined ? document.getElementById("sourcePath").value = "" : document.getElementById("sourcePath").value = jsonConfig.configs[selected_config_no].tab_batch.path.source_path;

        if (jsonConfig.configs[selected_config_no].tab_batch.path.temp_toggle == 1) {
            document.getElementById("selectTemporaryConversionFolder").checked = true;
            document.getElementById("tempConversionFolderDiv").style.display = 'block';
        } else {
            document.getElementById("selectTemporaryConversionFolder").checked = false;
        }




        jsonConfig.configs[selected_config_no].tab_batch.path.destination_path == undefined ? document.getElementById("destinationPath").value = "" : document.getElementById("destinationPath").value = jsonConfig.configs[selected_config_no].tab_batch.path.destination_path;
        jsonConfig.configs[selected_config_no].tab_batch.path.temp_destination_path == undefined ? document.getElementById("tempDestinationPath").value = "" : document.getElementById("tempDestinationPath").value = jsonConfig.configs[selected_config_no].tab_batch.path.temp_destination_path;


        if (jsonConfig.configs[selected_config_no].tab_batch.HandBrake_toggle == 1) {
            document.getElementById("handBrakeMode").checked = true;
            document.getElementById("standardPresetOptionDiv").style.display = 'block';

        } else {
            document.getElementById("handBrakeMode").checked = false;

        }


        jsonConfig.configs[selected_config_no].tab_batch.FFmpeg_toggle == 1 ? document.getElementById("FFmpegMode").checked = true : document.getElementById("FFmpegMode").checked = false;

        if (jsonConfig.configs[selected_config_no].tab_batch.custom_preset_toggle == 0) {
            document.getElementById("selectStandardPreset").checked = true;
            document.getElementById("selectCustomPreset").checked = false;
            document.getElementById("customPresetDiv").style.display = 'none';
            document.getElementById("standardPresetDiv").style.display = 'block';
        } else {
            document.getElementById("selectCustomPreset").checked = true
            document.getElementById("selectStandardPreset").checked = false;
            document.getElementById("customPresetDiv").style.display = 'block';
            document.getElementById("standardPresetDiv").style.display = 'none';
        }


        jsonConfig.configs[selected_config_no].tab_batch.preset == undefined ? document.getElementById("preset").selectedIndex = "" : document.getElementById("preset").selectedIndex = jsonConfig.configs[selected_config_no].tab_batch.preset;
        jsonConfig.configs[selected_config_no].tab_batch.custom_preset_string == undefined ? document.getElementById("customPresets").value = "" : document.getElementById("customPresets").value = jsonConfig.configs[selected_config_no].tab_batch.custom_preset_string;
        jsonConfig.configs[selected_config_no].tab_batch.container == undefined ? document.getElementById("container").value = "" : document.getElementById("container").value = jsonConfig.configs[selected_config_no].tab_batch.container;


        if (jsonConfig.configs[selected_config_no].tab_batch.periodic_scanning_toggle == 1) {
            document.getElementById("scanOnOff").checked = true;
            document.getElementById("showHideScanInterval").style.display = 'block';
            document.getElementById("showHideDailyRunTime").style.display = 'none';
        } else {
            document.getElementById("scanOnOff").checked = false;
            document.getElementById("showHideScanInterval").style.display = 'none';
        }


        if (jsonConfig.configs[selected_config_no].tab_batch.daily_scanning_toggle == 1) {
            document.getElementById("dailyRunTimeOnOff").checked = true;
            document.getElementById("showHideScanInterval").style.display = 'none';
            document.getElementById("showHideDailyRunTime").style.display = 'block';
        } else {
            document.getElementById("dailyRunTimeOnOff").checked = false;
            document.getElementById("showHideDailyRunTime").style.display = 'none';
        }




        jsonConfig.configs[selected_config_no].tab_batch.advanced.periodic_scan_interval == undefined ? document.getElementById("timer").value = "300" : document.getElementById("timer").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.periodic_scan_interval;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.daily_run_time == undefined ? document.getElementById("dailyRunTime").value = "" : document.getElementById("dailyRunTime").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.daily_run_time;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.daily_run_time_end == undefined ? document.getElementById("dailyRunTimeEnd").value = "" : document.getElementById("dailyRunTimeEnd").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.daily_run_time_end;

        jsonConfig.configs[selected_config_no].tab_batch.advanced.file_name_suffix == undefined ? document.getElementById("fileNameSuffix").value = "" : document.getElementById("fileNameSuffix").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.file_name_suffix;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.file_name_suffix_toggle == 1 ? document.getElementById("fileNameSuffixToggle").checked = true : document.getElementById("fileNameSuffixToggle").checked = false;




        jsonConfig.configs[selected_config_no].tab_batch.advanced.included_file_types == undefined ? document.getElementById("includedFileTypes").value == "" : document.getElementById("includedFileTypes").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.included_file_types;

        if (jsonConfig.configs[selected_config_no].tab_batch.advanced.included_file_types == undefined) {
            document.getElementById("includedFileTypes").value = "mp4,mkv,mov,m4v,mpg,mpeg,avi,flv,webm,wmv,vob,evo,mts,m2ts,ts,iso,"
        } else {
            document.getElementById("includedFileTypes").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.included_file_types
        }

        jsonConfig.configs[selected_config_no].tab_batch.advanced.min_file_size_filter_toggle == 1 ? document.getElementById("minimumFileSizeOnOff").checked = true : document.getElementById("minimumFileSizeOnOff").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.max_file_size_filter_toggle == 1 ? document.getElementById("maximumFileSizeOnOff").checked = true : document.getElementById("maximumFileSizeOnOff").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.min_file_size_filter == undefined ? document.getElementById("minimumFileSize").value = "" : document.getElementById("minimumFileSize").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.min_file_size_filter;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.max_file_size_filter == undefined ? document.getElementById("maximumFileSize").value = "" : document.getElementById("maximumFileSize").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.max_file_size_filter;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.title_word_filter == undefined ? document.getElementById("titleWordFilter").value = "" : document.getElementById("titleWordFilter").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.title_word_filter;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter == undefined ? document.getElementById("includePropertyFileFilter").value = "" : document.getElementById("includePropertyFileFilter").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter == undefined ? document.getElementById("excludePropertyFileFilter").value = "" : document.getElementById("excludePropertyFileFilter").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter;

        jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter_any_toggle == 1 ? document.getElementById("includeAnyFilesWithProperties").checked = true : document.getElementById("includeAnyFilesWithProperties").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter_all_toggle == 1 ? document.getElementById("includeAllFilesWithProperties").checked = true : document.getElementById("includeAllFilesWithProperties").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter_any_toggle == 1 ? document.getElementById("excludeAnyFilesWithProperties").checked = true : document.getElementById("excludeAnyFilesWithProperties").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter_all_toggle == 1 ? document.getElementById("excludeAllFilesWithProperties").checked = true : document.getElementById("excludeAllFilesWithProperties").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.copy_filtered_files_toggle == 1 ? document.getElementById("copyFilteredFiles").checked = true : document.getElementById("copyFilteredFiles").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.delete_source_files_toggle == 1 ? document.getElementById("deleteSourceFiles").checked = true : document.getElementById("deleteSourceFiles").checked = false;



        jsonConfig.configs[selected_config_no].tab_batch.advanced.replace_original_file_if_converted_is_smaller_toggle == 1 ? document.getElementById("replaceOriginalFile").checked = true : document.getElementById("replaceOriginalFile").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.replace_original_file_always_toggle == 1 ? document.getElementById("replaceOriginalFileAlways").checked = true : document.getElementById("replaceOriginalFileAlways").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.copy_srt_files_toggle == 1 ? document.getElementById("copySRTFiles").checked = true : document.getElementById("copySRTFiles").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.auto_create_folders_toggle == 1 ? document.getElementById("autoCreateFolders").checked = true : document.getElementById("autoCreateFolders").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.custom_bat_path == undefined ? document.getElementById("customBatPath").value = "" : document.getElementById("customBatPath").value = jsonConfig.configs[selected_config_no].tab_batch.advanced.custom_bat_path;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.low_process_priority_toggle == 1 ? document.getElementById("runPriority").checked = true : document.getElementById("runPriority").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.remove_filename_apostrophes == 1 ? document.getElementById("removeApostrophes").checked = true : document.getElementById("removeApostrophes").checked = false;
        jsonConfig.configs[selected_config_no].tab_batch.advanced.reverse_file_queue == 1 ? document.getElementById("reverseFileQueue").checked = true : document.getElementById("reverseFileQueue").checked = false;


        // Remote viewing tab

        jsonConfig.api_key == undefined ? generateNewAPIKey() : document.getElementById("apiKEY").innerHTML = jsonConfig.api_key;
        jsonConfig.configs[selected_config_no].tab_remote.remote_view_toggle == 1 ? document.getElementById("remoteViewOnOFF").checked = true : document.getElementById("remoteViewOnOFF").checked = false;


        // System tab
        jsonConfig.configs[selected_config_no].tab_system.worker_instance_number == undefined ? document.getElementById("instanceNumber").value = "4" : document.getElementById("instanceNumber").value = jsonConfig.configs[selected_config_no].tab_system.worker_instance_number;
        jsonConfig.configs[selected_config_no].tab_system.max_queue_view_size == undefined ? document.getElementById("queueSizeViewLimit").value = "1000" : document.getElementById("queueSizeViewLimit").value = jsonConfig.configs[selected_config_no].tab_system.max_queue_view_size;
        jsonConfig.configs[selected_config_no].tab_system.run_on_program_startup_toggle == 1 ? document.getElementById("autoStart").checked = true : document.getElementById("autoStart").checked = false;
        jsonConfig.configs[selected_config_no].tab_system.save_worker_logs_toggle == 1 ? document.getElementById("saveWorkerLogs").checked = true : document.getElementById("saveWorkerLogs").checked = false;

        jsonConfig.configs[selected_config_no].tab_system.email_address == undefined ? document.getElementById("emailAddress").value = "" : document.getElementById("emailAddress").value = jsonConfig.configs[selected_config_no].tab_system.email_address;
        jsonConfig.configs[selected_config_no].tab_system.smtp_server == undefined ? document.getElementById("SMTPServer").value = "" : document.getElementById("SMTPServer").value = jsonConfig.configs[selected_config_no].tab_system.smtp_server;






        var checkboxDelete = document.querySelector("input[name=deleteSourceFilesname]");

        checkboxDelete.addEventListener('change', function () {
            if (this.checked == true) {
                //document.getElementById("deleteItemDiv2").style.backgroundColor = '#ef435d';
                document.getElementById("deleteSourceFilesdiv").style.color = '#ef435d';
            } else if (this.checked == false) {
                document.getElementById("deleteSourceFilesdiv").style.color = 'rgba(255,255,255,0.4)';
            }
        });


        cbChange2();

        if (document.getElementById("deleteSourceFiles").checked == true) {
            document.getElementById("deleteSourceFilesdiv").style.color = '#ef435d';
        } else {
            document.getElementById("deleteSourceFilesdiv").style.color = 'rgba(255,255,255,0.4)';
        }

        if (document.getElementById("autoStart").checked == true) {
            convertFiles('scanandconvert');
        }
    }



    function cbChange1(obj) {
        if (obj.checked == false) {
            obj.checked = false;
        } else if (obj.checked == true) {
            var cbs = document.getElementsByClassName("cb1");
            for (var i = 0; i < cbs.length; i++) {
                cbs[i].checked = false;
            }
            obj.checked = true;
        }

        document.getElementById("standardPresetDiv").style.display = 'none';
        document.getElementById("customPresetDiv").style.display = 'none';

        if (document.getElementById("selectStandardPreset").checked == true) {
            document.getElementById("standardPresetDiv").style.display = 'block';
        }

        if (document.getElementById("selectCustomPreset").checked == true) {
            document.getElementById("customPresetDiv").style.display = 'block';
        }

        textAreaHeight()
    }




    function cbChange2() {

        if (document.getElementById("selectTemporaryConversionFolder").checked == true) {
            document.getElementById("tempConversionFolderDiv").style.display = 'block';
            document.getElementById("ShowHide1").style.display = 'none';
            document.getElementById("ShowHide2").style.display = 'block';
        } else {
            document.getElementById("tempConversionFolderDiv").style.display = 'none';
            document.getElementById("ShowHide1").style.display = 'block';
            document.getElementById("ShowHide2").style.display = 'none';
        }

        textAreaHeight()
    }


    function cbChange3() {
        if (document.getElementById("advancedSettings").style.display == 'block') {
            document.getElementById("advancedSettings").style.display = 'none';
        } else {
            document.getElementById("advancedSettings").style.display = 'block'
        }
        textAreaHeight()
    }





    function cbChange4(obj) {
        if (obj.checked == false) {
            obj.checked = false;
        } else if (obj.checked == true) {
            var cbs = document.getElementsByClassName("cb4");
            for (var i = 0; i < cbs.length; i++) {
                cbs[i].checked = false;
            }
            obj.checked = true;
        }

        document.getElementById("showHideScanInterval").style.display = 'none';
        document.getElementById("showHideDailyRunTime").style.display = 'none';

        if (document.getElementById("scanOnOff").checked == true) {
            document.getElementById("showHideScanInterval").style.display = 'block';
        }

        if (document.getElementById("dailyRunTimeOnOff").checked == true) {
            document.getElementById("showHideDailyRunTime").style.display = 'block';
        }

        textAreaHeight()
    }

    function cbChange5(obj) {
        document.getElementById("deleteSourceFilesdiv").style.color = 'rgba(255,255,255,0.4)';

        if (obj.checked == false) {
            obj.checked = false;
        } else if (obj.checked == true) {
            var cbs = document.getElementsByClassName("cb5");
            for (var i = 0; i < cbs.length; i++) {
                cbs[i].checked = false;
            }
            obj.checked = true;
        }
    }

    function cbChange6(obj) {

        if (obj.checked == false) {
            obj.checked = false;
        } else if (obj.checked == true) {
            var cbs = document.getElementsByClassName("cb6");
            for (var i = 0; i < cbs.length; i++) {
                cbs[i].checked = false;
            }
            obj.checked = true;
        }
    }


    function cbChange7(obj) {

        if (obj.checked == false) {
            obj.checked = false;
        } else if (obj.checked == true) {
            var cbs = document.getElementsByClassName("cb7");
            for (var i = 0; i < cbs.length; i++) {
                cbs[i].checked = false;
            }
            obj.checked = true;
        }



        document.getElementById("standardPresetOptionDiv").style.display = 'none';
        document.getElementById("selectStandardPreset").checked = false
        //document.getElementById("selectCustomPreset").checked = false

        if (document.getElementById("handBrakeMode").checked == true) {
            document.getElementById("standardPresetOptionDiv").style.display = 'block';

        } else if (document.getElementById("FFmpegMode").checked == true) {
            document.getElementById("selectCustomPreset").checked = true
        }




        //cb1

        document.getElementById("standardPresetDiv").style.display = 'none';
        document.getElementById("customPresetDiv").style.display = 'none';

        if (document.getElementById("selectStandardPreset").checked == true) {
            document.getElementById("standardPresetDiv").style.display = 'block';
        }

        if (document.getElementById("selectCustomPreset").checked == true) {
            document.getElementById("customPresetDiv").style.display = 'block';
        }

        textAreaHeight()
    }






    function showAlert(message, obj) {

        if (document.getElementById("deleteSourceFiles").checked == true) {
            alert(message);
        }
        cbChange5(obj);
    }

    var errorIndex

    function showAlert2(message) {

        createViewError();
        errorIndex = message
        //sleep(1000);    
    }


    ipcRenderer.on('item:ready', function (e, item) {
        ViewError.webContents.send('item:Error', fullErrorLogArray[errorIndex]);
        // /fullErrorLogArray[message]

    });






    ipcRenderer.on('mediaview:ready', function (e, item) {

        viewMedia.webContents.send('item:filepath', itemfilePath);
        itemfilePath = "";
        // /fullErrorLogArray[message]
    });


    var itemfilePath = "";

    function showAlert3(filepath) {

        createViewMediaInfo()

        //filePath=decodeURI(filepath)
        itemfilePath = decodeURI(filepath)

        //     var ffprobe = require('ffprobe'),
        //   ffprobeStatic = require('ffprobe-static');
        //   var path = require("path");
        //   var ffprobeStaticPath = ''

        //   if(process.env.NODE_ENV == 'production'){

        //   ffprobeStaticPath = require('ffprobe-static').path.replace('app.asar', 'app.asar.unpacked')

        //   }else{
        //   ffprobeStaticPath = require('ffprobe-static').path
        //   }

        //     var thisval

        //     var JSONBomb ="USE CTRL+C TO COPY THIS TEXT"+" \n\n" +filePath+" \n\n";
        // ffprobe(filePath, { path: ffprobeStaticPath }, function (err, jsonInfo) {
        //   if (err){
        //    // console.log("Error")
        //   }



        //     try{

        //             for (var i = 0; i < jsonInfo.streams.length; i++) {
        //                 Object.keys(jsonInfo.streams[i]).forEach(function(key) {
        //                     JSONBomb += key+": '"+jsonInfo.streams[i][key]+"' \n"
        //                 });
        //             }



        //     }catch(err){

        //         JSONBomb += "Could not extract info"


        //    }


        // });
    }



    function getHandBrakeCLIPath() {


        var fullPath = __dirname;
        fullPath = fullPath.slice(0, fullPath.lastIndexOf(global.stringProcessingSlash));
        fullPath = fullPath.slice(0, fullPath.lastIndexOf(global.stringProcessingSlash));
        var fullPath2 = fullPath + "\\HandBrakeCLI.exe"



        //handbrake CLI path
        if (process.platform == 'win32' && process.env.NODE_ENV == 'production') {
            //production
            var handBrakeCLIPath = "\"" + fullPath2 + "\"";

        } else if (process.platform == 'win32' && process.env.NODE_ENV != 'production') {
            //development
            var handBrakeCLIPath = "\"" + __dirname + "/HandBrakeCLI.exe\"";
        }


        if (process.platform == 'linux' || process.platform == 'darwin') {
            //development && //production
            var handBrakeCLIPath = "HandBrakeCLI -i \""
        }

        return handBrakeCLIPath

    }

    function getFFmpegCLIPath() {

        if (process.env.NODE_ENV == 'production') {
            if (process.platform == 'win32') {
                var ffmpegPath = (path.join(__dirname, '\\node_modules\\@ffmpeg-installer\\win32-x64\\ffmpeg.exe')).replace('app.asar', 'app.asar.unpacked')
            } else {
                var ffmpegPath = require('@ffmpeg-installer/ffmpeg').path.replace('app.asar', 'app.asar.unpacked');
            }
        } else {
            var ffmpegPath = require('@ffmpeg-installer/ffmpeg').path;
        }

        return ffmpegPath

    }






    function saveConfig(skipSave) {






        jsonConfig.lang = document.getElementById('language_select').value

        var selected_config_no = document.getElementById('select_configuration').value

        jsonConfig.selected_config = selected_config_no





        if (skipSave != "skip") {


            updateConsole("" + "Saving configuration settings" + "")


            //Video health check tab

            jsonConfig.configs[selected_config_no].tab_health.path.corrupt_destination_path = document.getElementById("corruptDestinationPath").value
            document.getElementById("moveCorruptFileOnOff").checked ? jsonConfig.configs[selected_config_no].tab_health.move_corrupt_files_toggle = 1 : jsonConfig.configs[selected_config_no].tab_health.move_corrupt_files_toggle = 0;
            document.getElementById("runThoroughHealthCheck").checked ? jsonConfig.configs[selected_config_no].tab_health.thorough_health_check_toggle = 1 : jsonConfig.configs[selected_config_no].tab_health.thorough_health_check_toggle = 0;
            document.getElementById("repairAttempt").checked ? jsonConfig.configs[selected_config_no].tab_health.thorough_health_check_repair_toggle = 1 : jsonConfig.configs[selected_config_no].tab_health.thorough_health_check_repair_toggle = 0;
            jsonConfig.configs[selected_config_no].tab_health.crf_repair_value = document.getElementById("CRFRepairValue").value



            //Batch tab

            jsonConfig.configs[selected_config_no].tab_batch.path.source_path = document.getElementById("sourcePath").value
            document.getElementById("selectTemporaryConversionFolder").checked ? jsonConfig.configs[selected_config_no].tab_batch.path.temp_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.path.temp_toggle = 0;
            jsonConfig.configs[selected_config_no].tab_batch.path.destination_path = document.getElementById("destinationPath").value
            jsonConfig.configs[selected_config_no].tab_batch.path.temp_destination_path = document.getElementById("tempDestinationPath").value
            document.getElementById("handBrakeMode").checked ? jsonConfig.configs[selected_config_no].tab_batch.HandBrake_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.HandBrake_toggle = 0;
            document.getElementById("FFmpegMode").checked ? jsonConfig.configs[selected_config_no].tab_batch.FFmpeg_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.FFmpeg_toggle = 0;
            document.getElementById("selectStandardPreset").checked ? jsonConfig.configs[selected_config_no].tab_batch.custom_preset_toggle = 0 : jsonConfig.configs[selected_config_no].tab_batch.custom_preset_toggle = 1;
            jsonConfig.configs[selected_config_no].tab_batch.preset = document.getElementById("preset").value
            jsonConfig.configs[selected_config_no].tab_batch.custom_preset_string = document.getElementById("customPresets").value
            jsonConfig.configs[selected_config_no].tab_batch.container = document.getElementById("container").value

            document.getElementById("scanOnOff").checked ? jsonConfig.configs[selected_config_no].tab_batch.periodic_scanning_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.periodic_scanning_toggle = 0;
            document.getElementById("dailyRunTimeOnOff").checked ? jsonConfig.configs[selected_config_no].tab_batch.daily_scanning_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.daily_scanning_toggle = 0;
            jsonConfig.configs[selected_config_no].tab_batch.advanced.periodic_scan_interval = document.getElementById("timer").value
            jsonConfig.configs[selected_config_no].tab_batch.advanced.daily_run_time = document.getElementById("dailyRunTime").value
            jsonConfig.configs[selected_config_no].tab_batch.advanced.daily_run_time_end = document.getElementById("dailyRunTimeEnd").value

            jsonConfig.configs[selected_config_no].tab_batch.advanced.file_name_suffix = document.getElementById("fileNameSuffix").value
            document.getElementById("fileNameSuffixToggle").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.file_name_suffix_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.file_name_suffix_toggle = 0;

            jsonConfig.configs[selected_config_no].tab_batch.advanced.included_file_types = document.getElementById("includedFileTypes").value
            document.getElementById("minimumFileSizeOnOff").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.min_file_size_filter_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.min_file_size_filter_toggle = 0;
            document.getElementById("maximumFileSizeOnOff").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.max_file_size_filter_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.max_file_size_filter_toggle = 0;
            jsonConfig.configs[selected_config_no].tab_batch.advanced.min_file_size_filter = document.getElementById("minimumFileSize").value
            jsonConfig.configs[selected_config_no].tab_batch.advanced.max_file_size_filter = document.getElementById("maximumFileSize").value
            jsonConfig.configs[selected_config_no].tab_batch.advanced.title_word_filter = document.getElementById("titleWordFilter").value
            jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter = document.getElementById("includePropertyFileFilter").value
            jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter = document.getElementById("excludePropertyFileFilter").value
            document.getElementById("includeAnyFilesWithProperties").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter_any_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter_any_toggle = 0;
            document.getElementById("includeAllFilesWithProperties").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter_all_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.included_property_filter_all_toggle = 0;
            document.getElementById("excludeAnyFilesWithProperties").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter_any_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter_any_toggle = 0;
            document.getElementById("excludeAllFilesWithProperties").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter_all_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.excluded_property_filter_all_toggle = 0;
            document.getElementById("copyFilteredFiles").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.copy_filtered_files_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.copy_filtered_files_toggle = 0;
            document.getElementById("deleteSourceFiles").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.delete_source_files_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.delete_source_files_toggle = 0;








            document.getElementById("replaceOriginalFile").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.replace_original_file_if_converted_is_smaller_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.replace_original_file_if_converted_is_smaller_toggle = 0;
            document.getElementById("replaceOriginalFileAlways").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.replace_original_file_always_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.replace_original_file_always_toggle = 0;
            document.getElementById("copySRTFiles").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.copy_srt_files_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.copy_srt_files_toggle = 0;
            document.getElementById("autoCreateFolders").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.auto_create_folders_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.auto_create_folders_toggle = 0;
            jsonConfig.configs[selected_config_no].tab_batch.advanced.custom_bat_path = document.getElementById("customBatPath").value
            document.getElementById("runPriority").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.low_process_priority_toggle = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.low_process_priority_toggle = 0;
            document.getElementById("removeApostrophes").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.remove_filename_apostrophes = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.remove_filename_apostrophes = 0;
            document.getElementById("reverseFileQueue").checked ? jsonConfig.configs[selected_config_no].tab_batch.advanced.reverse_file_queue = 1 : jsonConfig.configs[selected_config_no].tab_batch.advanced.reverse_file_queue = 0;



            // Remote viewing tab

            jsonConfig.api_key = document.getElementById("apiKEY").innerHTML
            document.getElementById("remoteViewOnOFF").checked ? jsonConfig.configs[selected_config_no].tab_remote.remote_view_toggle = 1 : jsonConfig.configs[selected_config_no].tab_remote.remote_view_toggle = 0;


            // System tab
            jsonConfig.configs[selected_config_no].tab_system.worker_instance_number = document.getElementById("instanceNumber").value
            jsonConfig.configs[selected_config_no].tab_system.max_queue_view_size = document.getElementById("queueSizeViewLimit").value
            document.getElementById("autoStart").checked ? jsonConfig.configs[selected_config_no].tab_system.run_on_program_startup_toggle = 1 : jsonConfig.configs[selected_config_no].tab_system.run_on_program_startup_toggle = 0;
            document.getElementById("saveWorkerLogs").checked ? jsonConfig.configs[selected_config_no].tab_system.save_worker_logs_toggle = 1 : jsonConfig.configs[selected_config_no].tab_system.save_worker_logs_toggle = 0;


            jsonConfig.configs[selected_config_no].tab_system.email_address = document.getElementById("emailAddress").value
            jsonConfig.configs[selected_config_no].tab_system.smtp_server = document.getElementById("SMTPServer").value

            updateConsole("" + "Configuration settings saved" + "")

        }



        //---

        console.log(jsonConfig)

        var jsonContentString = JSON.stringify(jsonConfig);

        fs.writeFileSync(homePath + '/Documents/HBBatchBeast/Config/Configuration.json', jsonContentString, 'utf8');





    }


    function sleep(milliseconds) {
        var start = new Date().getTime();
        for (var i = 0; i < 1e7; i++) {
            if ((new Date().getTime() - start) > milliseconds) {
                break;
            }
        }
    }




    function convertFiles(processMode, Benchmark) {


        if (processMode == "healthCheck") {
            updateConsole("" + "Commencing health check" + "")
        }
        if (processMode == "scanandconvert") {
            updateConsole("" + "Commencing scan and convert" + "")
        }
        if (processMode == "scanonly") {
            updateConsole("" + "Commencing scan only" + "")
        }


        //reset queue status
        fs.writeFileSync(homePath + '/Documents/HBBatchBeast/Config/queueStartStop.txt', "1", 'utf8');


        Bench = Benchmark

        if (Bench == 1) {

            updateConsole("" + "Loading benchmark settings" + "")


            document.getElementById("selectTemporaryConversionFolder").checked = false;
            document.getElementById("sourcePath").value = homePath2 + "/Documents/HBBatchBeast/Bench/Input"
            document.getElementById("destinationPath").value = homePath2 + "/Documents/HBBatchBeast/Bench/Output"



            document.getElementById("handBrakeMode").checked = true;
            document.getElementById("FFmpegMode").checked = false;


            document.getElementById("selectStandardPreset").checked = true;
            document.getElementById("selectCustomPreset").checked = false;

            document.getElementById("preset").selectedIndex = 0


            document.getElementById("container").value = ".mp4"
            document.getElementById("fileNameSuffix").value = ""


            document.getElementById("scanOnOff").checked = false;
            document.getElementById("dailyRunTimeOnOff").checked = false;
            document.getElementById("includedFileTypes").value = "mp4,mkv,mov,m4v,mpg,mpeg,avi,flv,webm,wmv,vob,evo,mts,m2ts,ts,iso,"

            document.getElementById("minimumFileSizeOnOff").checked = false;
            document.getElementById("maximumFileSizeOnOff").checked = false;


            document.getElementById("titleWordFilter").value = ""
            document.getElementById("includePropertyFileFilter").value = ""
            document.getElementById("excludePropertyFileFilter").value = ""



            document.getElementById("includeAnyFilesWithProperties").checked = false
            document.getElementById("includeAllFilesWithProperties").checked = false
            document.getElementById("excludeAnyFilesWithProperties").checked = false
            document.getElementById("excludeAllFilesWithProperties").checked = false


            document.getElementById("copyFilteredFiles").checked = false;

            document.getElementById("deleteSourceFiles").checked = false;


            document.getElementById("replaceOriginalFile").checked = false;
            document.getElementById("replaceOriginalFileAlways").checked = false;

            document.getElementById("copySRTFiles").checked = false;

            document.getElementById("autoCreateFolders").checked = true;
            document.getElementById("customBatPath").value = "";


            document.getElementById("runPriority").checked = false;

            document.getElementById("removeApostrophes").checked = false;
            document.getElementById("reverseFileQueue").checked = false;


            document.getElementById("instanceNumber").value = "4"

            document.getElementById("autoStart").checked = false;


        }





        //reset divs
        document.getElementById("totalFilesDiv").innerHTML = ""
        document.getElementById("buildQueueDiv").innerHTML = ""
        document.getElementById("totalUnconvertedFilesDiv").innerHTML = ""
        document.getElementById("startTimeDiv").innerHTML = ""
        document.getElementById("durationDiv").innerHTML = ""
        document.getElementById("endTimeDiv").innerHTML = ""
        document.getElementById("viewStatus").innerHTML = "";
        document.getElementById("timerDiv").innerHTML = "";
        document.getElementById("workerStatusDiv").innerHTML = "";

        document.getElementById("myChartDiv").style.display = 'none';


        //set countdown timer
        timerSeconds = document.getElementById("timer").value


        mode = processMode;

        startDate = new Date();

        // if (mode == "scanandconvert" || mode == "healthCheck") { //test

        document.getElementById("startTimeDiv").innerHTML = "<p>Start time: " + getTimeNow() + "<\p>";



        // }

        document.getElementById("pauseButtonDiv").style.display = 'none';
        document.getElementById("stopButtonDiv").style.display = 'none';

        document.getElementById("continueButtonDiv").style.display = 'none';
        document.getElementById("continueButtonGreyDiv").style.display = 'none';

        document.getElementById('healthCheckDiv').innerHTML = "";

        globalQueueNumberManager = 0;
        AllCompleted = 0;


        workers = [];
        inputPathArray = [];
        outputPathArray = [];
        sourceQueueArray = [];
        skipOrCopyArray = [];

        errorArray = [];
        FFprobeArray = [];
        sourceQueueFileSizeArray = []
        var outputPathArrayFinal = [];


        var inputPathArrayCounter = 0;
        var outputFolderPathold = "";
        var outputFolderPathFinalold = "";

        fileNotExistsCounter = 0;
        totalFileFoundCounter = 0;
        totalFileSize = 0;

        errorCount = 0;
        successfulCount = 0;

        cancelCount = 0;
        otherCount = 0;


        var g;

        var outPutPathStem
        var outPutPathStemFinal

        var inputPathStem
        var inputPathStemSplit
        var topFolder
        var topFolderCharLength
        var programPath = ""

        sourceFileSize = 0
        outputFileSize = 0

        queueView = "enabled"

        tempOutputQueueHTML = "";
        workerStatusFinishedArray = [];
        queueStatusPaused = 0;

        exportRemaining = 0
        exportSuccess = 0
        exportError = 0
        exportCancelled = 0
        exportOther = 0

        timeoutCounter = 0
        workerProgressArray = []

        deleteArray = [];
        workerStatusArray = []


        if (process.platform == 'win32') {

            var validationSlash = "\\";
        }

        if (process.platform == 'linux' || process.platform == 'darwin') {

            var validationSlash = "";
        }


        updateConsole("" + "Validating configuration settings" + "")


        //validate config inputs
        validationSection:
        {



            var inputPathStemArray = "";
            inputPathStemArray = document.getElementById("sourcePath").value;
            inputPathStemArray = inputPathStemArray.toString().split("\n");

            var outPutPathStemArray = "";
            outPutPathStemArray = document.getElementById("destinationPath").value;
            outPutPathStemArray = outPutPathStemArray.toString().split("\n");

            var outPutPathStemFinalArray = [];

            if (document.getElementById("selectTemporaryConversionFolder").checked == true) {
                outPutPathStemFinalArray = document.getElementById("tempDestinationPath").value;
                outPutPathStemFinalArray = outPutPathStemFinalArray.toString().split("\n");
            }


            var corruptFolderStem = document.getElementById("corruptDestinationPath").value;


            if (mode != "healthCheck") {
                if (document.getElementById("selectCustomPreset").checked == true) {

                    var presetArray = [];
                    presetArray = document.getElementById("customPresets").value;
                    presetArray = presetArray.toString().split("\n");



                    if (inputPathStemArray.length != presetArray.length) {

                        alert(document.getElementById("alert_validation_custom_preset_1").textContent + " " + inputPathStemArray.length + " " + document.getElementById("alert_validation_custom_preset_2").textContent + " " + presetArray.length + " " + document.getElementById("alert_validation_custom_preset_3").textContent + "");
                        break validationSection;

                    }

                    if (document.getElementById("fileNameSuffixToggle").checked) {

                        var fileNameSuffixArray = [];
                        fileNameSuffixArray = document.getElementById("fileNameSuffix").value;
                        fileNameSuffixArray = fileNameSuffixArray.toString().split("\n");

                        if (inputPathStemArray.length != fileNameSuffixArray.length) {

                            alert(document.getElementById("alert_validation_filenamesuffix_1").textContent + " " + inputPathStemArray.length + " " + document.getElementById("alert_validation_filenamesuffix_2").textContent + " " + fileNameSuffixArray.length + " " + document.getElementById("alert_validation_filenamesuffix_3").textContent);
                            break validationSection;

                        }
                    }






                }



            }

            //check number of source/dest/temp folders matches alert_validation_dest_folderno_1


            if (mode != "healthCheck") {

                if (document.getElementById("selectTemporaryConversionFolder").checked == false) {
                    if (inputPathStemArray.length != outPutPathStemArray.length) {

                        alert(document.getElementById("alert_validation_source_folderno_1").textContent + " " + inputPathStemArray.length + " " + document.getElementById("alert_validation_source_folderno_2").textContent + " " + outPutPathStemArray.length + " " + document.getElementById("alert_validation_source_folderno_3").textContent);
                        break validationSection;

                    }
                }

                if (document.getElementById("selectTemporaryConversionFolder").checked == true) {

                    if (inputPathStemArray.length != outPutPathStemArray.length) {

                        alert(document.getElementById("alert_validation_temp_folderno_1").textContent + " " + inputPathStemArray.length + " " + document.getElementById("alert_validation_temp_folderno_2").textContent + " " + outPutPathStemArray.length + " " + document.getElementById("alert_validation_temp_folderno_3").textContent);
                        break validationSection;

                    }

                    if (inputPathStemArray.length != outPutPathStemFinalArray.length) {

                        alert(document.getElementById("alert_validation_dest_folderno_1").textContent + " " + inputPathStemArray.length + " " + document.getElementById("alert_validation_dest_folderno_2").textContent + " " + outPutPathStemFinalArray.length + " " + document.getElementById("alert_validation_dest_folderno_3").textContent);
                        break validationSection;

                    }

                }
            }



            for (var y = 0; y < inputPathStemArray.length; y++) {


                //make sure there are no trailing slashes on file paths


                if (mode == "healthCheck") {

                    if (document.getElementById("moveCorruptFileOnOff").checked == true) {

                        if (corruptFolderStem.charAt(corruptFolderStem.length - 1) == "\\") {

                            var temPath = corruptFolderStem
                            temPath = temPath.split("")
                            temPath.pop()
                            corruptFolderStem = temPath.join("")

                            //alert("Please remove trailing slashes from source folder path " + corruptFolderStem + "!");
                            //break validationSection;
                        }

                    }
                }







                if (inputPathStemArray[y].charAt(inputPathStemArray[y].length - 1) == stringProcessingSlash) {

                    var temPath = inputPathStemArray[y]
                    temPath = temPath.split("")
                    temPath.pop()
                    inputPathStemArray[y] = temPath.join("")

                    // alert("Please remove trailing slashes from source folder path " + inputPathStemArray[y] + "!");
                    // break validationSection;
                }


                if (mode != "healthCheck") {

                    if (document.getElementById("selectTemporaryConversionFolder").checked == true) {

                        if (outPutPathStemArray[y].charAt(outPutPathStemArray[y].length - 1) == stringProcessingSlash) {


                            var temPath = outPutPathStemArray[y]
                            temPath = temPath.split("")
                            temPath.pop()
                            outPutPathStemArray[y] = temPath.join("")

                            //  alert("Please remove trailing slashes from the temporary folder path " + outPutPathStemArray[y] + "!");
                            //  break validationSection;


                        }
                    } else {




                        if (outPutPathStemArray[y].charAt(outPutPathStemArray[y].length - 1) == stringProcessingSlash) {


                            var temPath = outPutPathStemArray[y]
                            temPath = temPath.split("")
                            temPath.pop()
                            outPutPathStemArray[y] = temPath.join("")

                            //alert("Please remove trailing slashes from the destination folder path " + outPutPathStemArray[y] + "!");
                            //break validationSection;


                        }

                    }

                    if (document.getElementById("selectTemporaryConversionFolder").checked == true) {

                        if (outPutPathStemFinalArray[y].charAt(outPutPathStemFinalArray[y].length - 1) == stringProcessingSlash) {


                            var temPath = outPutPathStemFinalArray[y]
                            temPath = temPath.split("")
                            temPath.pop()
                            outPutPathStemFinalArray[y] = temPath.join("")


                            // alert("Please remove trailing slashes from the destination folder path " + outPutPathStemFinalArray[y] + "!");
                            //break validationSection;


                        }

                    }

                }

                // check container

                if (mode != "healthCheck") {

                    if (!(document.getElementById("container").value).includes('.')) {

                        //

                        alert(document.getElementById("alert_validation_container").textContent);
                        break validationSection;
                    }
                }




                //check folders exist

                if (mode == "healthCheck") {

                    if (document.getElementById("moveCorruptFileOnOff").checked == true) {


                        if (fs.existsSync(corruptFolderStem + validationSlash) == false || corruptFolderStem == "") {

                            alert(document.getElementById("alert_validation_corrupt_file_folder_1").textContent + " " + corruptFolderStem + " " + document.getElementById("alert_validation_corrupt_file_folder_2").textContent);
                            break validationSection;

                        }
                    }
                }





                //alert_validation_source_folder_exist_1



                if (fs.existsSync(inputPathStemArray[y] + validationSlash) == false || inputPathStemArray[y] == "") {


                    alert(document.getElementById("alert_validation_source_folder_exist_1").textContent + " " + (y + 1) + " " + inputPathStemArray[y] + " " + document.getElementById("alert_validation_source_folder_exist_2").textContent);
                    break validationSection;

                }

                if (mode != "healthCheck") {





                    if (document.getElementById("selectTemporaryConversionFolder").checked == true) {




                        //  if (outPutPathStemFinalArray[y].includes(inputPathStemArray[y])) {



                        if (pathIsInside(outPutPathStemArray[y], inputPathStemArray[y])) {


                            //
                            alert(document.getElementById("alert_validation_tempOn_tempinside_source_1").textContent + " " + (y + 1) + " " + outPutPathStemArray[y] + " " + document.getElementById("alert_validation_tempOn_tempinside_source_2").textContent + " " + (y + 1) + " " + inputPathStemArray[y] + " " + document.getElementById("alert_validation_tempOn_tempinside_source_3").textContent);
                            break validationSection;



                        }



                        if (pathIsInside(outPutPathStemFinalArray[y], inputPathStemArray[y])) {


                            //

                            alert(document.getElementById("alert_validation_tempOn_destinside_source_1").textContent + " " + (y + 1) + " " + outPutPathStemFinalArray[y] + " " + document.getElementById("alert_validation_tempOn_destinside_source_2").textContent + " " + (y + 1) + " " + inputPathStemArray[y] + " " + document.getElementById("alert_validation_tempOn_destinside_source_3").textContent);
                            break validationSection;



                        }




                    } else {





                        //if (outPutPathStemArray[y].includes(inputPathStemArray[y])) {



                        if (pathIsInside(outPutPathStemArray[y], inputPathStemArray[y])) {
                            //

                            alert(document.getElementById("alert_validation_tempOff_destinside_source_1").textContent + " " + (y + 1) + " " + outPutPathStemArray[y] + " " + document.getElementById("alert_validation_tempOff_destinside_source_2").textContent + " " + (y + 1) + " " + inputPathStemArray[y] + " " + document.getElementById("alert_validation_tempOff_destinside_source_3").textContent);
                            break validationSection;



                        }




                    }










                    if (document.getElementById("selectTemporaryConversionFolder").checked == true) {

                        if (fs.existsSync(outPutPathStemArray[y] + validationSlash) == false || outPutPathStemArray[y] == "") {


                            if (document.getElementById("autoCreateFolders").checked == true) {


                                try {
                                    fs.mkdirSync(outPutPathStemArray[y] + validationSlash);
                                } catch (err) {



                                    alert(document.getElementById("alert_validation_tempOn_err_creating_temp_1").textContent + " " + (y + 1) + ": " + outPutPathStemArray[y] + validationSlash);






                                    break validationSection;

                                }


                            } else {

                                alert(document.getElementById("alert_validation_tempOn_temp_not_exist_1").textContent + " " + (y + 1) + " " + outPutPathStemArray[y] + " " + document.getElementById("alert_validation_tempOn_temp_not_exist_2").textContent);



                                break validationSection;
                            }
                        }



                    } else {

                        if (fs.existsSync(outPutPathStemArray[y] + validationSlash) == false || outPutPathStemArray[y] == "") {

                            if (document.getElementById("autoCreateFolders").checked == true) {


                                try {
                                    fs.mkdirSync(outPutPathStemArray[y] + validationSlash);
                                } catch (err) {

                                    alert(document.getElementById("alert_validation_tempOff_err_creating_dest_1").textContent + " " + (y + 1) + ": " + outPutPathStemArray[y] + validationSlash);

                                    // 

                                    break validationSection;
                                }


                            } else {


                                alert(document.getElementById("alert_validation_tempOff_dest_not_exist_1").textContent + " " + (y + 1) + " " + outPutPathStemArray[y] + " " + document.getElementById("alert_validation_tempOff_dest_not_exist_2").textContent);











                                break validationSection;
                            }
                        }

                    }

                    if (document.getElementById("selectTemporaryConversionFolder").checked == true) {


                        if (fs.existsSync(outPutPathStemFinalArray[y] + validationSlash) == false || outPutPathStemFinalArray[y] == "") {

                            if (document.getElementById("autoCreateFolders").checked == true) {


                                try {
                                    fs.mkdirSync(outPutPathStemFinalArray[y] + validationSlash);
                                } catch (err) {

                                    alert(document.getElementById("alert_validation_tempOn_err_creating_dest_1").textContent + " " + (y + 1) + ": " + outPutPathStemFinalArray[y] + validationSlash);


                                    // 
                                    break validationSection;
                                }


                            } else {



                                alert(document.getElementById("alert_validation_tempOn_dest_not_exist_1").textContent + " " + (y + 1) + " " + outPutPathStemFinalArray[y] + " " + document.getElementById("alert_validation_tempOn_dest_not_exist_2").textContent);







                                break validationSection;
                            }
                        }



                    }





                } else {
                    outPutPathStemArray[y] = "";
                    outPutPathStemFinalArray[y] = "";



                }









            }



















            if (mode != "healthCheck") {

                if (document.getElementById("handBrakeMode").checked == false && document.getElementById("FFmpegMode").checked == false) {

                    alert(document.getElementById("alert_validation_HandBrake_or_FFmpeg").textContent);



                    break validationSection;
                }



                if (document.getElementById("selectStandardPreset").checked == false && document.getElementById("selectCustomPreset").checked == false) {

                    alert(document.getElementById("alert_validation_standard_or_custom").textContent);
                    //
                    break validationSection;
                }


                var scanIntervalVal = document.getElementById("timer").value


                if (document.getElementById("scanOnOff").checked) {
                    if (scanIntervalVal < 5) {

                        alert(document.getElementById("alert_validation_scan_interval_min").textContent);

                        //

                        break validationSection;
                    }
                }

            }

            var instanceNumberVal = document.getElementById("instanceNumber").value
            if (instanceNumberVal < 1) {

                alert(document.getElementById("alert_validation_worker_numbers").textContent);

                //
                break validationSection;
            }




            var apiKEYVal = (document.getElementById("apiKEY").innerHTML).trim();

            if (apiKEYVal.length < 40) {

                alert(document.getElementById("alert_validation_api_invalid").textContent);
                //

                break validationSection;
            }










            // createViewError();




            // daily timer run validation

            //  if (mode == "scanandconvert") {  //test

            if (mode != "healthCheck") {

                var dailyRunTime = document.getElementById("dailyRunTime").value
                var dailyRunTimeEnd = document.getElementById("dailyRunTimeEnd").value
                if (document.getElementById("dailyRunTimeOnOff").checked == true) {


                    if (isNaN(parseInt(dailyRunTime.charAt(0))) || isNaN(parseInt(dailyRunTime.charAt(1))) || isNaN(parseInt(dailyRunTime.charAt(3))) || isNaN(parseInt(dailyRunTime.charAt(4)))) {


                        alert(document.getElementById("alert_validation_daily_run_time").textContent);


                        //


                        break validationSection;



                    } else if (isNaN(parseInt(dailyRunTimeEnd.charAt(0))) || isNaN(parseInt(dailyRunTimeEnd.charAt(1))) || isNaN(parseInt(dailyRunTimeEnd.charAt(3))) || isNaN(parseInt(dailyRunTimeEnd.charAt(4)))) {

                        alert(document.getElementById("alert_validation_daily_run_time_end").textContent);

                        break validationSection;


                    } else {







                        if (viewSwitch == 0) {
                            document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\">Scan will run at: <font color=\"#66ccff\">" + dailyRunTime + "</font></p>";
                            exportStatus = "<p style=\"font-size: 2em;\">Scan will run at: <font color=\"#66ccff\">" + dailyRunTime + "</font></p>";
                            viewSwitch = 1

                        } else {

                            document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\">Scan will run at: <font color=\"#ef435d\">" + dailyRunTime + "</font></p>";
                            exportStatus = "<p style=\"font-size: 2em;\">Scan will run at: <font color=\"#ef435d\">" + dailyRunTime + "</font></p>";
                            viewSwitch = 0

                        }
                        apiStatusSend();



                        var scheduleStartTime = parseInt(((parseInt(dailyRunTime.charAt(0) + "" + dailyRunTime.charAt(1))) * 60)) + parseInt(((dailyRunTime.charAt(3) + "" + dailyRunTime.charAt(4))));
                        var scheduleEndTime = parseInt(((parseInt(dailyRunTimeEnd.charAt(0) + "" + dailyRunTimeEnd.charAt(1))) * 60)) + parseInt(((dailyRunTimeEnd.charAt(3) + "" + dailyRunTimeEnd.charAt(4))));
                        var date = new Date();
                        var timenow = (date.getHours() * 60) + date.getMinutes();
                        //var timenow = 1;


                        //boost schedule end time if scheduled time crosses midnight.
                        if (scheduleEndTime < scheduleStartTime) {


                            //check if timenow is between midnight and schedule end time
                            if (timenow > 0 && timenow < scheduleEndTime) {
                                timenow += (24 * 60)
                            }

                            scheduleEndTime += (24 * 60)

                        }



                        if (scheduleStartTime <= timenow && timenow <= scheduleEndTime) {
                            // break validationSection;

                        } else {

                            // // creat timer module
                            // var timerInfoBomb = [
                            //     "runTimer",
                            //     "dailyRunTime",
                            //     2,
                            // ];



                            // var childProcess = require("child_process");
                            // var timerModulePath = "/modules/scheduler.js"

                            // // if(timerModule != ""){
                            // timerModule = childProcess.fork(path.join(__dirname, timerModulePath));
                            // // }
                            // timerModule.send(timerInfoBomb);
                            // timerModule.on("exit", function (code, signal, ) {
                            //     console.log('Child exited:', code, signal);

                            // });

                            // timerModule.on('message', function (message) {



                            //     if (message[0] == "scanandconvert") {


                            //         convertFiles('scanandconvert');
                            //     }

                            // });


                            setTimeout(convertFiles, 2000, 'scanandconvert');






                            break validationSection;
                        }
                    }
                }
            }


            updateConsole("" + "Configuration settings validated" + "")



            if (Bench == 1) {
                // saveConfig();

            } else {



                saveConfig();


            }








            //initiate counters
            fileNotExistsCounter = 0;
            totalFileFoundCounter = 0;


            inputPathArrayCounter = 0

            inputPathArray = [];
            outputPathArray = [];




















            var sourceQueueArrayCounter = 0;



            //reset preset arrays
            var presetArray = [];
            var fileNameSuffixArray = []
            presetArray2 = [];
            destinationQueue = []
            destinationFinalQueue = []

            if (document.getElementById("selectStandardPreset").checked == true) {

                for (var y = 0; y < inputPathStemArray.length; y++) {
                    presetArray[y] = "-Z \"" + document.getElementById("preset").options[document.getElementById("preset").selectedIndex].text + "\"";


                    fileNameSuffixArray[y] = ((document.getElementById("fileNameSuffix").value).toString().split("\n"))[0]
                }

            } else {

                presetArray = [];
                presetArray = document.getElementById("customPresets").value;
                presetArray = presetArray.toString().split("\n");

                fileNameSuffixArray = [];
                fileNameSuffixArray = document.getElementById("fileNameSuffix").value;
                fileNameSuffixArray = fileNameSuffixArray.toString().split("\n");



            }

            if (document.getElementById("fileNameSuffixToggle").checked == false) {

                for (var y = 0; y < inputPathStemArray.length; y++) {
                    fileNameSuffixArray[y] = "";
                }


            }




            if (mode == "healthCheck") {

                for (var y = 0; y < inputPathStemArray.length; y++) {

                    if (document.getElementById("runThoroughHealthCheck").checked) {
                        presetArray[y] = "-v error, -f null";

                    } else {
                        presetArray[y] = "--scan";
                    }
                }

            }



            // var queueInfoBomb = {



            //     inputPathStemArray: inputPathStemArray,
            //     outPutPathStemArray: outPutPathStemArray,

            //     outPutPathStemFinalArray: outPutPathStemFinalArray,

            //     tempConversionFolderCheckedOnOff: document.getElementById("selectTemporaryConversionFolder").checked,

            //     supportedFileTypeArray: document.getElementById("includedFileTypes").value,

            //     containerType: document.getElementById("container").options[document.getElementById("container").selectedIndex].text,

            //     mode: mode,


            // };

            if (document.getElementById("copySRTFiles").checked == true && mode != "healthCheck") {
                var fileFilterArray = document.getElementById("includedFileTypes").value + ",srt,SRT"


            } else {
                var fileFilterArray = document.getElementById("includedFileTypes").value
            }



            var queueInfoBomb = [

                "queueInfoBomb",
                inputPathStemArray,
                outPutPathStemArray,
                outPutPathStemFinalArray,
                document.getElementById("selectTemporaryConversionFolder").checked,
                fileFilterArray,
                document.getElementById("container").value,
                mode,
                presetArray,
                document.getElementById("titleWordFilter").value,
                document.getElementById("replaceOriginalFile").checked,
                fileNameSuffixArray,
                document.getElementById("removeApostrophes").checked,
                document.getElementById("replaceOriginalFileAlways").checked,
                document.getElementById("reverseFileQueue").checked


            ];




            //  console.log(queueInfoBomb)


            // launch Queue builder module




            //  var path = require("path");
            var childProcess = require("child_process");
            var queueBuildModulePath = "/modules/queueBuild.js"


            updateConsole("" + "Launching file scanner" + "")

            // var queueBuildModule = childProcess.fork(path.join(__dirname, queueBuildModulePath ),[], { silent: true });

            var queueBuildModule = childProcess.fork(path.join(__dirname, queueBuildModulePath));

            updateConsole("" + "File scanner launched" + "")


            // queueBuildModule.stdout.on('data', function(data) {
            //         console.log('stdout: ' + data);
            //         //Here is where the output goes
            //             });





            queueBuildModule.on("exit", function (code, signal, ) {
                console.log('Child exited:', code, signal);

                updateConsole("" + "File scanner exited" + "")

            });
            //   queueBuildModule.on("error", console.error.bind(console));








            queueBuildModule.on('message', function (message) {

                //   console.log("Message:"+message);

                if (message.error) {
                    console.error(message.error);
                }

                if (message[0] == "readyforInfo") {

                    updateConsole("" + "File scanner ready for info. Sending." + "")
                    queueBuildModule.send(queueInfoBomb);


                }



                if (message[0] == "writeRequest") {

                    try {
                        fs.writeFileSync(message[1], message[2], 'utf8');

                    } catch (err) { }

                }

                if (message[0] == "consoleMessage") {


                    updateConsole("" + message[1] + "")


                }




                if (message[0] == "appendRequest") {
                    try {
                        fs.appendFileSync(message[1], message[2], 'utf8');
                    } catch (err) { }

                }


                if (message[0] == "complete") {

                    updateConsole("" + "File scanner finished" + "")


                    totalFileFoundCounter = message[1];
                    sourceQueueArray = message[2];
                    presetArray2 = message[3];
                    skipOrCopyArray = message[4];
                    destinationQueue = message[5];
                    destinationFinalQueue = message[6];
                    unConvertedFiles = message[7];




                    runEndSection();

                }

                if (message[0] == "exitRequest") {
                    var exitMessage = [
                        "exitApproved",
                    ];
                    queueBuildModule.send(exitMessage);

                }

                if (message[0] == "totalFiles") {
                    document.getElementById("totalFilesDiv").innerHTML = "<p>Files found: " + message[1] + "<\p>";
                }

                if (message[0] == "buildQueue") {
                    document.getElementById("buildQueueDiv").innerHTML = "<p>Building queue: " + message[1] + "<\p>";
                }



            });









            //Close scan Window

            // try {
            //     ViewError.close();
            // } catch (err) {}






            //      runEndSection();



            document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Searching for files</font></p>";
            exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Searching for files</font></p>";

            hideTabs();





        }// end validation section






    }//end convertfiles function

    function runEndSection() {


        updateConsole("" + "Configuring pre-launch" + "")


        if (mode == "healthCheck") {

            document.getElementById("myChartDiv").innerHTML = "<div id='myChart'></div>";

        } else {
            document.getElementById("myChartDiv").innerHTML = "<div class=\"grid-container\" ><div class=\"grid-itemleft\"><div id='myChart'></div></div><div class=\"grid-itemright\"><div id='myBarChart'></div> </div></div>"




        }



        document.getElementById("queueButton").style.display = 'block';

        document.getElementById("outputButton").style.display = 'block';



        if (mode == "scanandconvert" || mode == "healthCheck") {
            document.getElementById("convertSelectedButton").style.display = 'none';

        } else {

            document.getElementById("fullQueueDiv").style.display = 'block';
            document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Finished searching for files</font></p>";
            exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Finished searching for files</font></p>";

            document.getElementById("convertSelectedButton").style.display = 'block';
        }



        document.getElementById("sessionConversions").style.display = 'none';





        if (mode != "healthCheck") {

            document.getElementById("buildQueueDiv").innerHTML = "<p>Building queue: " + unConvertedFiles + "<\p>";
            document.getElementById("totalUnconvertedFilesDiv").innerHTML = "<p>Unconverted files found: " + unConvertedFiles + "<\p>";
        }

        if (mode == "healthCheck") {

            document.getElementById("viewStatus").innerHTML += "<p > <font color=\"red\">Corrupt</font> items will be shown in the output section once finished.<\p>";


        }





        document.getElementById("totalFilesDiv").innerHTML = "<p>Total files found: " + totalFileFoundCounter + "<\p>";

        document.getElementById("buildQueueDiv").innerHTML = "<p>Building queue: " + unConvertedFiles + "<\p>";










        if (process.platform == 'win32') {
            ipcRenderer.send('item:add', 'iconrunning');
        }

        //load conversion queue into table




        var tableHTML = "";
        var tableQueueNumber = 1;







        if (sourceQueueArray.length >= 1) {












            tableHTML += "<table class=\"outputTable\" id=\"queueTable\">"

                + "<tr>"

                + "<th class=\"headcol\">Source file</th>"

                + "<th class=\"headcol\">Queue no.</th>"
                + "<th class=\"headcol\">Preset</th>"
                + "<th class=\"headcol\">Worker</th>"
                + "<th class=\"headcol\">FFprobe</th>"
                + "<th class=\"headcol\">Status</th>"
                + "<th class=\"headcol\">Process?</th>"
                + "<th class=\"headcol\">Finish time</th>"

                + "<th class=\"headcol\">Old size (GB)</th>"
                + "<th class=\"headcol\">New size (GB)</th>"

                + "</tr>"

            for (var i = 0; i < (sourceQueueArray.length); i++) {



                var currentSourceLine = (sourceQueueArray[i]);


                var tablePreset = "<td > " + presetArray2[i] + "</td>";


                if (mode != "healthCheck") {

                    if (skipOrCopyArray[i] == 1) {

                        if (document.getElementById("copyFilteredFiles").checked == true) {

                            tablePreset = "<td >" + "<font color=\"#ff2d2d\">Copy (Due to word filter)</font>" + "</td>";

                        } else {

                            tablePreset = "<td >" + "<font color=\"#ff2d2d\">Skip (Due to word filter)</font>" + "</td>";

                        }

                        if (currentSourceLine.includes('.srt') || currentSourceLine.includes('.SRT')) {

                            tablePreset = "<td >" + "<font color=\"#ff2d2d\">Copy srt" + "</td>";



                        }





                    }
                }



                tableHTML += "<tr>"
                    + "<td>" + currentSourceLine + "</td>"




                    + "<td>" + tableQueueNumber + "</td>"
                    + tablePreset
                    + "<td > - </td>"
                    + "<td > - </td>"
                    + "<td > - </td>"
                    + "<td ><input id=\"tableQueueNumber" + tableQueueNumber + "\" type=\"checkbox\" checked=\"true\"></td>"
                    + "<td > - </td>"
                    + "<td > - </td>"
                    + "<td > - </td>"

                    + "</tr>"

                tableQueueNumber++;


            }

            tableHTML += "</table>";



            if (queueView == "enabled") {
                document.getElementById("fullQueue").innerHTML = tableHTML;
            } else {

                document.getElementById("fullQueue").innerHTML = "";
            }


        }





        if (mode == "scanandconvert" || mode == "healthCheck") {


            updateConsole("" + "Launching worker modules" + "")


            launchWorkerModules();

        }// end if

    }


    function launchWorkerModules(mode2) {



        document.getElementById("convertSelectedButton").style.display = 'none';





        if (mode2 == "launchModules") {

            mode = "scanandconvert";
        }

        // update display

        document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Running</font></p>";
        exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Running</font></p>";

        document.getElementById("pauseButtonDiv").style.display = 'block';
        document.getElementById("stopButtonDiv").style.display = 'block';

        if (totalFileFoundCounter >= document.getElementById("queueSizeViewLimit").value) {
            document.getElementById("fullQueueDiv").style.display = 'none';
            document.getElementById("viewStatus").innerHTML += "<p style=\"color:red\">Queue size view limit exceeded(" + document.getElementById("queueSizeViewLimit").value + ")! Queue view disabled.You can increase this on the 'System' tab.<\p>";

            queueView = "disabled";

        } else {

            document.getElementById("fullQueueDiv").style.display = 'block';
        }

        for (var i = 1; i <= document.getElementById("instanceNumber").value; i++) {
            document.getElementById("workerStatusDiv").innerHTML += "<div id=\"worker" + i + "Status\"> </div>";
        }
        updateGraph('initialisation');



        //





        // Run all worker modules

        var workerPath = "/modules/worker1.js"
        //   var workerPath2 = "worker2.js"


        var cp = [];
        var childProcess = require("child_process");
        //var path = require("path");




        //document.getElementById("instanceNumber").value

        for (var i = 1; i <= document.getElementById("instanceNumber").value; i++) {


            var child_argv = [
                i,
            ]

            //workers.push(childProcess.fork(path.join(__dirname, workerPath ),[], { silent: true }));
            workers.push(childProcess.fork(path.join(__dirname, workerPath), child_argv));


            updateConsole("" + "Worker " + i + " launched" + "")



            // workers[i - 1].stdout.on('data', function(data) {
            // //console.log('stdout: ' + data);
            // //Here is where the output goes
            // });



            // var messageOut = [
            //     "workerNumber",
            //     i,
            // ];

            // workers[i - 1].send(messageOut);





            // var worker = workers[1];
            //  worker.send("w:"+2);


            workers[i - 1].on("exit", function (code, signal) {

                updateConsole("" + "Worker exited" + "")



            });
            workers[i - 1].on("error", console.error.bind(console));






            workers[i - 1].on('message', function (message) {

                // updateConsole("Worker "+message[0]+":"+message+"");


                //  console.log("Message:" + message);








                if (message[1] == "deleteThisFile") {

                    deleteArray.push(sourceQueueArray[message[2]])


                }




                if (message[1] == "exitRequest") {
                    var exitMessage = [
                        "exitApproved",
                    ];
                    workers[message[0] - 1].send(exitMessage);

                }


                if (message[1] == "consoleMessage") {

                    if (document.getElementById("saveWorkerLogs").checked == true) {

                        updateConsole("Worker " + message[0] + ":" + message[2] + "");

                    } else {
                        updateConsole("Worker " + message[0] + ":" + message[2] + "", true);

                    }
                }




                if (message[1] == "queueRequest") {

                    console.log(globalQueueNumberManager)

                    if (globalQueueNumberManager <= sourceQueueArray.length - 1) {


                        var messageOut = queueWorkerMessage()

                        globalQueueNumberManager++;

                    } else {

                        workerStatusArray.push("Complete")

                        var messageOut = [
                            "completed",
                        ];

                    }
                    //  workers[message[0] - 1].send(message);

                    // console.log(messageOut)

                    workers[message[0] - 1].send(messageOut);





                }


                if (message[1] == "processing") {

                    workerStatusFinishedArray[message[0] - 1] = ""
                    var currentRow = parseInt(message[2]) + 1
                    if (queueView == "enabled") {
                        queueTable.rows[currentRow].cells[3].innerHTML = "Worker " + message[0];


                        //done
                        queueTable.rows[currentRow].cells[5].innerHTML = message[3];

                        queueTable.rows[currentRow].style.backgroundColor = "#ffa24c";
                    }

                    //Need to update workerprogressarray if this is changed.
                    document.getElementById("worker" + message[0] + "Status").innerHTML = "<div class=\"grid-itemleft\" style=\"white-space:nowrap;\"><p>Worker " + message[0] + " processing file:<div id=\"cancelButtonDiv" + message[0] + "\"><input type='button' id=\"cancelButton" + message[0] + "\" class=\"infoButton\" value='Cancel item' onclick='cancelItemProcess(\"" + message[0] + "\")'/></div></p><div id=\"worker" + message[0] + "Percentage\"><p><font color=\"#66ccff\">Running</font></p></div></div><div class=\"grid-itemright\"><p>" + sourceQueueArray[message[2]] + "</p></div>";




                    //style="display: none;"
                    //document.getElementById("pauseButtonDiv").style.display = 'none';



                    // workerStatusDiv

                }

                if (mode != "healthCheck") {

                    if (message[1] == "fileSizes") {

                        sourceFileSize += parseFloat(message[3])
                        outputFileSize += parseFloat(message[4])

                        var currentRow = parseInt(message[2]) + 1


                        try{
                        queueTable.rows[currentRow].cells[8].innerHTML = parseFloat(message[3]).toPrecision(3)
                        queueTable.rows[currentRow].cells[9].innerHTML = parseFloat(message[4]).toPrecision(3)
                    }catch(err){}

                        //    console.log(sourceFileSize)
                        //   console.log(outputFileSize)

                    }



                }

                if (message[1] == "percentage") {
                    // document.getElementById("workerStatusDiv").innerHTML += "<div id=\"worker" + i + "Status\"> </div>";       
                    document.getElementById("worker" + message[0] + "Percentage").innerHTML = "<p><font color=\"#66ccff\">" + message[3] + "</font></p>";
                    //updateConsole("Worker " + message[0] + ":" + message[3] + ":" + sourceQueueArray[message[2]] + "");
                    var currentRow = parseInt(message[2]) + 1
                    if (queueView == "enabled") {
                        //done    
                        queueTable.rows[currentRow].cells[5].innerHTML = message[3];
                    }
                    // workerStatusDiv
                }

                if (message[1] == "repair_worker_percentage") {
                    // document.getElementById("workerStatusDiv").innerHTML += "<div id=\"worker" + i + "Status\"> </div>";       
                    document.getElementById("worker" + message[0] + "Percentage").innerHTML = "<p><font color=\"#66ccff\">Attempting repair:" + message[3] + "</font></p>";
                    updateConsole("Worker " + message[0] + ":" + message[3] + ":" + sourceQueueArray[message[2]] + "");
                    var currentRow = parseInt(message[2]) + 1
                    if (queueView == "enabled") {
                        //done    
                        queueTable.rows[currentRow].cells[5].innerHTML = "Attempting repair:" + message[3];
                    }
                    // workerStatusDiv
                }






                function informationUpdate(workerNumber, preset, errorLog, globalQueueNumber, backgroundColor, Status, Status2) {

                    workerStatusFinishedArray[workerNumber - 1] = "Finished"

                    if (queueStatusPaused == 1) {
                        verifyContinue();
                    }

                    //hide cancel item button
                    document.getElementById("cancelButtonDiv" + workerNumber).innerHTML = "<input type='button' class=\"infoButtonGrey\" value='Cancel item' />"


                    var currentRow = parseInt(globalQueueNumber) + 1




                    //var currentRow = parseInt(message[2]) + 1
                    if (queueView == "enabled") {
                        queueTable.rows[currentRow].cells[2].innerHTML = preset;
                        queueTable.rows[currentRow].cells[3].innerHTML = "";

                        //[4] FFPROBE

                        queueTable.rows[currentRow].cells[5].innerHTML = Status;
                        queueTable.rows[currentRow].cells[7].innerHTML = getDateNow() + " " + getTimeNow();

                        queueTable.rows[currentRow].style.backgroundColor = backgroundColor;
                    }

                    document.getElementById("worker" + workerNumber + "Percentage").innerHTML = Status2;


                    fullErrorLogArray.push(errorLog)
                    errorArray.push(sourceQueueArray[currentRow - 1])

                    exportLastCompletedTime = getTimeNow() + " on " + getDateNow();

                    updateGraph();



                    if (mode != "healthCheck" || mode == "healthCheck") {

                        // tempOutputQueueHTML += "<tr>"
                        //     + "<td >" + sourceQueueArray[globalQueueNumber] + "</td>"
                        //     + "<td  >" + sessionNumber + "</td>"
                        //     + "<td  >" + preset + "</td>"
                        //     + "<td  >" + FFprobeArray[globalQueueNumber] + "</td>"
                        //     + "<td  >" + Status + "</td>"
                        //     + "<td  >" + getTimeNow() + "</td>"
                        //     + "</tr>";

                        var temprow = document.getElementById("sessionConversionsTable").insertRow();
                        var tempcell0 = temprow.insertCell(0);
                        var tempcell1 = temprow.insertCell(1);
                        var tempcell2 = temprow.insertCell(2);
                        var tempcell3 = temprow.insertCell(3);
                        var tempcell4 = temprow.insertCell(4);
                        var tempcell5 = temprow.insertCell(5);

                        var tempcell6 = temprow.insertCell(6);
                        var tempcell7 = temprow.insertCell(7);



                        tempcell0.innerHTML = sourceQueueArray[globalQueueNumber]

                        tempcell1.innerHTML = sessionNumber
                        tempcell2.innerHTML = preset
                        tempcell3.innerHTML = FFprobeArray[globalQueueNumber]
                        tempcell4.innerHTML = Status
                        tempcell5.innerHTML = getDateNow() + " " + getTimeNow()

                        tempcell6.innerHTML = queueTable.rows[currentRow].cells[8].innerHTML
                        tempcell7.innerHTML = queueTable.rows[currentRow].cells[9].innerHTML

                        if ((temprow.cells[4].innerHTML).toString().includes("Completed")) {
                            temprow.style.backgroundColor = "#59ff74";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("Error")) {
                            temprow.style.backgroundColor = "#ff2d2d";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("Cancelled")) {
                            temprow.style.backgroundColor = "#ffda6d";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("Skipped")) {
                            temprow.style.backgroundColor = "#ffa24c";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("Copied to destination")) {
                            temprow.style.backgroundColor = "#59ff74";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("Copy to destination failed")) {
                            temprow.style.backgroundColor = "#ff2d2d";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("Original replaced")) {
                            temprow.style.backgroundColor = "#59ff74";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("Original not replaced")) {
                            temprow.style.backgroundColor = "#ffa24c";
                        } else if ((temprow.cells[4].innerHTML).toString().includes("File repaired. Please inspect files.")) {
                            temprow.style.backgroundColor = "#59ff74";
                        }




                        toggleShowRowsQ(document.getElementById("showSuccess1"), "rgb(89, 255, 116)", "rgb(89, 255, 116)")
                        toggleShowRowsQ(document.getElementById("showError1"), "rgb(255, 45, 45)", "rgb(255, 45, 45)")
                        toggleShowRowsQ(document.getElementById("showCancelled1"), "rgb(255, 218, 109)", "rgb(255, 218, 109)")
                        toggleShowRowsQ(document.getElementById("showRemaining1"), "rgb(242, 242, 242)", "")
                        toggleShowRowsQ(document.getElementById("showOther1"), "rgb(255, 162, 76)", "rgb(255, 162, 76)")

                        toggleShowRowsO(document.getElementById("showSuccess"), "rgb(89, 255, 116)")
                        toggleShowRowsO(document.getElementById("showError"), "rgb(255, 45, 45)")
                        toggleShowRowsO(document.getElementById("showCancelled"), "rgb(255, 218, 109)")
                        toggleShowRowsO(document.getElementById("showOther"), "rgb(255, 162, 76)")


                    }



                    sessionNumber++;

                }



                if (message[1] == "error") {
                    errorCount++;

                    informationUpdate(message[0], message[3], message[4], message[2], "#ff2d2d", "<input type=\"button\" class=\"infoButton\" onclick=\"showAlert2('" + sessionNumber + "')\" value=\"Error (Click for info)\">", "<p><font color=\"#ff2d2d\">Error</font></p>")

                }



                if (message[1] == "success") {
                    successfulCount++;
                    informationUpdate(message[0], message[3], message[4], message[2], "#59ff74", "Completed", "<p><font color=\"#66ccff\">Completed</font></p>")

                }

                try {
                    if (message[1].includes("Skipped")) {

                        otherCount++;
                        informationUpdate(message[0], message[3], message[4], message[2], "#ffa24c", message[1], "<p><font color=\"#66ccff\">Completed</font></p>")
                    }
                } catch (err) { }

                if (message[1] == "copied") {

                    successfulCount++;
                    informationUpdate(message[0], message[3], message[4], message[2], "#59ff74", "Copied to destination", "<p><font color=\"#66ccff\">Completed</font></p>")
                }


                if (message[1] == "copiedFail") {

                    errorCount++;
                    informationUpdate(message[0], message[3], message[4], message[2], "#ff2d2d", "Copy to destination failed", "<p><font color=\"#66ccff\">Completed</font></p>")

                }


                //if (message[1] == "originalReplaced") {
                try {
                    if (message[1].includes("Original replaced")) {

                        successfulCount++;
                        informationUpdate(message[0], message[3], message[4], message[2], "#59ff74", message[1], "<p><font color=\"#66ccff\">Completed</font></p>")

                    }
                } catch (err) { }

                //if (message[1] == "originalNotReplaced") {
                try {
                    if (message[1].includes("Original not replaced")) {

                        successfulCount++;
                        informationUpdate(message[0], message[3], message[4], message[2], "#ffa24c", message[1], "<p><font color=\"#66ccff\">Completed</font></p>")

                    }
                } catch (err) { }



                try {
                    if (message[1].includes("File repaired")) {

                        successfulCount++;
                        informationUpdate(message[0], message[3], message[4], message[2], "#59ff74", message[1], "<p><font color=\"#66ccff\">File repaired. Please inspect files.</font></p>")

                    }
                } catch (err) { }

                try {
                    if (message[1].includes("Unable to repair file")) {

                        errorCount++;
                        informationUpdate(message[0], message[3], message[4], message[2], "#ff2d2d", "<input type=\"button\" class=\"infoButton\" onclick=\"showAlert2('" + sessionNumber + "')\" value=\"Error: Unable to repair file(Click for info)\">", "<p><font color=\"#ff2d2d\">Error:Unable to repair file</font></p>")


                        //  informationUpdate(message[0], message[3], message[4], message[2], "#ff2d2d", "<input type=\"button\" class=\"infoButton\" onclick=\"showAlert2('" + sessionNumber + "')\" value=\"Unable to repair (Click for info)\">", "<p><font color=\"#ff2d2d\">Error</font></p>")

                    }
                } catch (err) { }




                if (message[1] == "FFPROBE") {

                    var currentRow = parseInt(message[2]) + 1
                    if (queueView == "enabled") {


                        queueTable.rows[currentRow].cells[4].innerHTML = "<input type=\"button\" class=\"infoButton\" onclick=\"showAlert3('" + encodeURI(message[4]) + "')\" value=\"" + message[3] + "\">"

                        // message[3];

                        //  "<input type=\"button\" class=\"infoButton\" onclick=\"showAlert2('"+sessionNumber+"')\" value=\"Error (Click for info)\">"
                    }
                    FFprobeArray[currentRow - 1] = "<input type=\"button\" class=\"infoButton\" onclick=\"showAlert3('" + encodeURI(message[4]) + "')\" value=\"" + message[3] + "\">"

                }






                if (message[1] == "cancelled") {

                    cancelCount++;
                    informationUpdate(message[0], message[3], message[4], message[2], "#ffda6d", "Cancelled", "<p>Cancelled</p>")
                }


                if (message[1] == "writeRequest") {



                    try {
                        fs.writeFileSync(message[2], message[3], 'utf8');

                    } catch (err) { }

                }




                if (message[1] == "appendRequest") {
                    try {
                        fs.appendFileSync(message[2], message[3], 'utf8');
                    } catch (err) { }

                }







            });







        }




        updateInfo = 1;





        if (mode == "scanandconvert") {

            if (document.getElementById("scanOnOff").checked == true || document.getElementById("dailyRunTimeOnOff").checked == true) {
                document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Running</font></p>";
                exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Running</font></p>";
                countDownOn = 1;

            } else {
                countDownOn = 0;
            }
        }



        //  var elmnt = document.getElementById("worker4");
        //  elmnt.scrollIntoView()


        workersRunning = true
        inProgress = true


    }

    function updateGraph(graphMode) {

        var successfulCount2;
        var errorCount2;
        var cancelCount2;
        var otherCount2;

        if (graphMode == "initialisation") {




            successfulCount2 = 0;
            errorCount2 = 0;
            cancelCount2 = 0;
            otherCount2 = 0;

        } else {

            successfulCount2 = successfulCount
            errorCount2 = errorCount

            cancelCount2 = cancelCount
            otherCount2 = otherCount

        }



        if (sourceQueueArray.length >= 1) {

            if (mode == "healthCheck") {

                var totalFilesGraph = totalFileFoundCounter;

            } else {

                var totalFilesGraph = unConvertedFiles


            }



            var myConfig = {
                type: "ring",
                backgroundColor: "#1A2933",
                plot: {
                    borderColor: "#2B313B",
                    borderWidth: 0,
                    // slice: 90,
                    valueBox: {
                        placement: 'out',
                        // text: '%t\n%npv%',
                        text: '%t\n%pv\n%npv%',
                        fontFamily: "Open Sans"
                    },
                    tooltip: {
                        fontSize: '18',
                        fontFamily: "Open Sans",
                        padding: "5 10",
                        text: "%npv%"
                    },
                },
                source: {
                    text: '',
                    fontColor: "#8e99a9",
                    fontFamily: "Open Sans"
                },
                title: {
                    fontColor: "#fff",
                    text: '',
                    align: "left",
                    offsetX: 10,
                    fontFamily: "Open Sans",
                    fontSize: 25
                },
                subtitle: {
                    offsetX: 10,
                    offsetY: 10,
                    fontColor: "#8e99a9",
                    fontFamily: "Open Sans",
                    fontSize: "16",
                    text: '',
                    align: "left"
                },
                plotarea: {
                    margin: "20 0 0 0"

                },
                series: [
                    {
                        values: [(successfulCount2)],
                        text: "Success",
                        backgroundColor: '#4CAF50',
                    },
                    {
                        values: [(errorCount2)],
                        text: "Error",
                        backgroundColor: '#ef435d'
                    },
                    {
                        values: [(cancelCount2)],
                        text: "Cancelled",
                        backgroundColor: '#ffda6d'
                    },
                    {
                        values: [(otherCount2)],
                        text: "Other",
                        backgroundColor: '#ffa24c'
                    },
                    {
                        values: [totalFilesGraph - (successfulCount + errorCount + cancelCount + otherCount)],
                        text: "Remaining",
                        backgroundColor: '#50ADF5'
                    },



                ]
            };

            zingchart.render({
                id: 'myChart',
                data: myConfig,
                //   height: 500,
                width: '100%'
            });


            ///

            if (mode != "healthCheck") {

                var graphSourceSize = parseFloat(sourceFileSize.toPrecision(4))
                var graphOutputFileSize = parseFloat(outputFileSize.toPrecision(4))

                //  console.log(graphSourceSize)
                //  console.log(graphOutputFileSize)

                var myBarConfig = {
                    type: "bar",
                    plot: {
                        borderColor: "#2B313B",
                        borderWidth: 0,
                        // slice: 90,
                        valueBox: {

                            // text: '%t\n%npv%',
                            text: '%t\n%pvGB',
                            fontFamily: "Open Sans"
                        },
                        tooltip: {
                            fontSize: '1em',
                            fontFamily: "Open Sans",
                            padding: "",
                            text: "%t"
                        },
                    },
                    backgroundColor: "#1A2933",
                    "scale-y": {
                        lineColor: 'none',
                        tick: {
                            visible: false
                        },
                        guide: {
                            visible: false
                        },
                        item: {
                            visible: false
                        }
                    },
                    "scale-x": {
                        visible: false
                    },
                    series: [

                        {
                            "values": [
                                graphSourceSize,
                            ],
                            "alpha": 0.95,
                            "borderRadiusTopLeft": 7,
                            "borderRadiusTopRight": 7,
                            "background-color": "#067ea5",
                            "text": "Old size",
                        },
                        {
                            "values": [
                                graphOutputFileSize,
                            ],
                            "borderRadiusTopLeft": 7,
                            "borderRadiusTopRight": 7,
                            "alpha": 0.95,
                            "background-color": "#0aa2aa",
                            "text": "New size"
                        },
                        // {
                        //     "values": [
                        //     10,
                        //     5,

                        //     ],
                        //     "alpha": 0.95,
                        //     "borderRadiusTopLeft": 7,
                        //     "background-color": "#8993c7",
                        //     "text": "Old size",
                        // }
                    ]
                };

                zingchart.render({
                    id: 'myBarChart',
                    data: myBarConfig,
                    // height: 500,
                    width: '100%'
                });

            }




            ///

            document.getElementById("myChartDiv").style.display = 'block';



            exportRemaining = (totalFilesGraph - (successfulCount + errorCount + cancelCount + otherCount))
            exportSuccess = successfulCount2
            exportError = errorCount2
            exportCancelled = cancelCount2
            exportOther = otherCount2


            //   apiStatusSend();







        }


    }





    function fancyTimeFormat(time) {
        // Hours, minutes and seconds
        var hrs = ~~(time / 3600);
        var mins = ~~((time % 3600) / 60);
        var secs = ~~time % 60;

        // Output like "1:01" or "4:03:59" or "123:03:59"
        var ret = "";

        if (hrs > 0) {
            ret += "" + hrs + ":" + (mins < 10 ? "0" : "");
        }

        ret += "" + mins + ":" + (secs < 10 ? "0" : "");
        ret += "" + secs;
        return ret;
    }





    function runScan() {



        if (mode != "healthCheck") {
            if (document.getElementById("dailyRunTimeOnOff").checked == true && inProgress == true) {




                var dailyRunTime = document.getElementById("dailyRunTime").value
                var dailyRunTimeEnd = document.getElementById("dailyRunTimeEnd").value
                var scheduleStartTime = parseInt(((parseInt(dailyRunTime.charAt(0) + "" + dailyRunTime.charAt(1))) * 60)) + parseInt(((dailyRunTime.charAt(3) + "" + dailyRunTime.charAt(4))));
                var scheduleEndTime = parseInt(((parseInt(dailyRunTimeEnd.charAt(0) + "" + dailyRunTimeEnd.charAt(1))) * 60)) + parseInt(((dailyRunTimeEnd.charAt(3) + "" + dailyRunTimeEnd.charAt(4))));
                var date = new Date();
                var timenow = (date.getHours() * 60) + date.getMinutes();
                //var timenow = 1;


                //boost schedule end time if scheduled time crosses midnight.
                if (scheduleEndTime < scheduleStartTime) {


                    //check if timenow is between midnight and schedule end time
                    if (timenow > 0 && timenow < scheduleEndTime) {
                        timenow += (24 * 60)
                    }

                    scheduleEndTime += (24 * 60)

                }



                if (scheduleStartTime <= timenow && timenow <= scheduleEndTime) {

                    // if paused, start


                    if (queueStatusPaused == 1 && workerStatusArray.length != document.getElementById("instanceNumber").value && document.getElementById("continueButtonGreyDiv").style.display == 'none') {


                        continueQueue()

                    }


                } else {
                    //if running, pause


                    if (workersRunning == true && queueStatusPaused == 0 && workerStatusArray.length != document.getElementById("instanceNumber").value) {


                        pauseQueueInitiate(2)




                    }



                }
            }
        }

        //


        var includePropertyFileFilterVar = ((document.getElementById("includePropertyFileFilter").value)).split(",");

        if (includePropertyFileFilterVar.length != 0) {
            document.getElementById("includeAllFilesWithPropertiesNumber").innerHTML = " " + (includePropertyFileFilterVar.length - 1) + " ";
        } else {
            document.getElementById("includeAllFilesWithPropertiesNumber").innerHTML = " 0 ";

        }

        var excludePropertyFileFilterVar = ((document.getElementById("excludePropertyFileFilter").value)).split(",");

        if (excludePropertyFileFilterVar - 1 != 0) {
            document.getElementById("excludeAllFilesWithPropertiesNumber").innerHTML = " " + (excludePropertyFileFilterVar.length - 1) + " ";
        } else {
            document.getElementById("excludeAllFilesWithPropertiesNumber").innerHTML = " 0 ";

        }


        //check if nvenc detected
        if (document.getElementById("customPresets").value.includes("nvenc")) {
            document.getElementById("custompresetNotification").style.display = 'block';
        } else {
            document.getElementById("custompresetNotification").style.display = 'none';
        }


        //check if imported preset detected
        if (document.getElementById("customPresets").value.includes("import")) {
            document.getElementById("custompresetNotificationImportedJSON").style.display = 'block';
        } else {
            document.getElementById("custompresetNotificationImportedJSON").style.display = 'none';
        }



        // console.log("updateInfo"+updateInfo)

        if (updateInfo == 1) {


            if (document.getElementById("runPriority").checked == true) {
                setProcessPriority();

            }

            apiStatusSend();





            if (mode == "scanandconvert" || mode == "healthCheck") {
                endDate = new Date();
                var seconds2 = (endDate.getTime() - startDate.getTime()) / 1000;

                var time = Math.round(seconds2);



                document.getElementById("durationDiv").innerHTML = "<p>Duration: " + fancyTimeFormat(time) + "<\p>";


                //timeout if item takes too long



                if (document.getElementById("handBrakeMode").checked && queueStatusPaused != 1 && mode != "healthCheck") {




                    if (timeoutCounter == 0) {

                        for (var j = 1; j <= document.getElementById("instanceNumber").value; j++) {

                            try {
                                workerProgressArray[j - 1] = document.getElementById("worker" + (j) + "Status").innerHTML
                            } catch (err) { }

                        }
                    }



                    timeoutCounter++

                    if (timeoutCounter == 180) {

                        for (var j = 1; j <= document.getElementById("instanceNumber").value; j++) {

                            if (workerProgressArray[j - 1] == document.getElementById("worker" + (j) + "Status").innerHTML) {

                                updateConsole("" + "Worker " + j + " 180 second timeout, cancelling item" + "")

                                cancelItemProcess(j)

                            }


                        }


                        timeoutCounter = 0

                    }



                }

            }



            if (mode != "healthCheck" && mode != "scanandconvert") {

                updateInfo = 0;

            }





            var globalQueueNumber = globalQueueNumberManager - 1;


            if (sourceQueueArray.length >= 1) {

            } else {

                document.getElementById("myChartDiv").style.display = 'none';
            }

            if (sourceQueueArray.length == 0) {

                updateConsole("" + "All workers complete " + "")

                AllComplete();

            }







            if (sourceQueueArray.length >= 1) {


                // console.log("workerStatusArray.length"+workerStatusArray.length)
                // console.log("instanceNumber"+document.getElementById("instanceNumber").value)

                if (workerStatusArray.length == document.getElementById("instanceNumber").value) {

                    updateConsole("" + "All workers complete " + "")

                    AllComplete();
                }
            }













            function AllComplete() {

                workersRunning = false
                inProgress = false


                for (var i = 0; i < deleteArray.length; i++) {

                    if (fs.existsSync(deleteArray[i])) {

                        try {

                            updateConsole("" + "Deleting source file:" + deleteArray[i] + "")

                            fs.unlinkSync(deleteArray[i])





                        } catch (err) {
                            updateConsole("" + "Deleting source file failed:" + deleteArray[i] + "")
                        }


                    }
                }












                //push conversion queue to output table


                updateConsole("" + "Updating output table" + "")


                // document.getElementById('sessionConversionsTable').innerHTML += tempOutputQueueHTML

                //notify

                document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Finished</font></p>";
                exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Finished</font></p>";
                apiStatusSend();




                //Hide pause button

                document.getElementById("pauseButtonDiv").style.display = 'none';
                document.getElementById("stopButtonDiv").style.display = 'none';
                document.getElementById("continueButtonDiv").style.display = 'none';
                document.getElementById("continueButtonGreyDiv").style.display = 'none';

                //reset status div
                document.getElementById("workerStatusDiv").innerHTML = "";



                //send email alert                

                if (errorCount != 0) {
                    if (process.platform == 'win32') {
                        ipcRenderer.send('item:add', 'iconerror');

                    }


                    emailAlert();

                } else {
                    if (process.platform == 'win32') {
                        ipcRenderer.send('item:add', 'icon');
                    }
                }







                document.getElementById("fullQueue").innerHTML = "";



                document.getElementById('healthCheckDiv').innerHTML = "";
                //health check stats

                if (mode == "healthCheck") {

                    var healthPercentage = ((successfulCount / (errorCount + successfulCount)) * 100).toFixed(2);

                    document.getElementById('healthCheckDiv').innerHTML = "<h1>Healthy files:<font color=\"green\">" + successfulCount + "</font> Corrupt files:<font color=\"red\">" + errorCount + "</font> Health:" + healthPercentage + "%<\h1>"

                }






                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth() + 1;
                var yyyy = today.getFullYear();
                if (dd < 10) {
                    dd = '0' + dd
                }
                if (mm < 10) {
                    mm = '0' + mm
                }
                today = dd + '/' + mm + '/' + yyyy;
                var today2 = dd + '-' + mm + '-' + yyyy;

                var d = new Date(),
                    h = (d.getHours() < 10 ? '0' : '') + d.getHours(),
                    m = (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();
                var s = (d.getSeconds() < 10 ? '0' : '') + d.getSeconds();
                var timenow = h + '-' + m + '-' + s;









                var convertedFiles = globalQueueNumberManager;




                var preset












                if (mode == "healthCheck") {
                    preset = "Health check"
                } else {

                    if (document.getElementById("selectStandardPreset").checked == true) {

                        preset = "-Z \"" + document.getElementById("preset").options[document.getElementById("preset").selectedIndex].text + "\""

                    }
                    if (document.getElementById("selectCustomPreset").checked == true) {

                        preset = document.getElementById("customPresets").value

                    }




                }
                fs.appendFileSync(homePath + "/Documents/HBBatchBeast/Logs/Scans.txt", "Scan completed on " + today2 + "-" + timenow + ".-------Total files found:" + totalFileFoundCounter + "---------Unconverted files:" + unConvertedFiles + "------.Files processed:" + convertedFiles + " out of " + unConvertedFiles + "-------Preset:" + preset + ". \r\n", 'utf8');
                document.getElementById("sessionConversions").style.display = 'block';
                document.getElementById("endTimeDiv").innerHTML = "<p>End time: " + getTimeNow() + "<\p>";




                if (Bench == 1) {


                    homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test1.mp4"


                    if (fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test1.mp4") && fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test2.mp4") && fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test3.mp4") && fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test4.mp4")) {

                        endDate = new Date();
                        var seconds2 = (endDate.getTime() - startDate.getTime()) / 1000;
                        // var time = Math.round(seconds2);



                        //
                        var today = new Date();
                        var dd = today.getDate();
                        var mm = today.getMonth() + 1;
                        var yyyy = today.getFullYear();
                        if (dd < 10) {
                            dd = '0' + dd
                        }
                        if (mm < 10) {
                            mm = '0' + mm
                        }
                        today = dd + '/' + mm + '/' + yyyy;
                        var today2 = dd + '-' + mm + '-' + yyyy;

                        var d = new Date(),
                            h = (d.getHours() < 10 ? '0' : '') + d.getHours(),
                            m = (d.getMinutes() < 10 ? '0' : '') + d.getMinutes();
                        var s = (d.getSeconds() < 10 ? '0' : '') + d.getSeconds();
                        var timenow = h + '-' + m + '-' + s;
                        var os = require("os");
                        //os
                        if (confirm('Benchmark completed in ' + seconds2 + ' seconds. Would you like to submit this result to HBBatchBeast.io? The following data will be sent: \n\n Processor model and clock speed: ' + os.cpus()[0].model + '  \n RAM: ' + os.totalmem() / 1000000000 + ' \n Completion time: ' + seconds2 + ' \n Completion date: ' + today2 + "," + timenow)) {

                            var request = require('request')


                            request.post(serverStem + 'api/', {
                                json: {

                                    "ProcessorName": os.cpus()[0].model,
                                    "RAM": os.totalmem() / 1000000000,
                                    "ProcessorTime": seconds2,
                                    "ProcessorDate": today2 + "," + timenow
                                }
                            }, (error, res, body) => {
                                if (error) {
                                    console.error(error)

                                    updateConsole("" + "Error submitting benchmark" + "")
                                    return
                                }
                                console.log(`statusCode: ${res.statusCode}`)
                                console.log(body)
                                updateConsole("" + "Benchmark submitted" + "")

                            })

                        }


                        updateConsole("" + "Cleaning up files" + "")

                        cleanupFiles()


                        updateConsole("" + "Finished" + "")




                        Bench = 0




                    } else {

                        alert(document.getElementById("alert_benchmark_failed").textContent);
                        //location.reload()

                    }




                }
                Bench = 0













                updateInfo = 0;
                sourceQueueArray = [];
                AllCompleted = 1;
                clearInterval(windowRefresh);
                windowRefresh = window.setInterval("runScan();", 1000)

                updateConsole("" + "Finished" + "")
            }
        }

        if (countDownOn == 1 && AllCompleted == "1") {



            if (mode == "scanandconvert") {
                if (timerSeconds % 2 == 0) {
                    if (process.platform == 'win32') {
                        ipcRenderer.send('item:add', 'iconwatching');
                    }

                } else {
                    if (errorCount != 0) {
                        if (process.platform == 'win32') {
                            ipcRenderer.send('item:add', 'iconerror');
                        }

                    } else {
                        if (process.platform == 'win32') {
                            ipcRenderer.send('item:add', 'icon');
                        }
                    }
                }



                // for daily timer function

                if (document.getElementById("dailyRunTimeOnOff").checked == true) {

                    //convertFiles('scanandconvert');





                    AllCompleted = 0
                    setTimeout(convertFiles, 5000, 'scanandconvert');




                }




                // for periodic scan
                if (document.getElementById("scanOnOff").checked == true) {

                    timerSeconds--;
                    document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\">Time until next scan: <font color=\"#66ccff\">" + timerSeconds + "</font> seconds</p>";
                    exportStatus = "<p style=\"font-size: 2em;\">Time until next scan: <font color=\"#66ccff\">" + timerSeconds + "</font> seconds</p>";
                    apiStatusSend();


                    if (timerSeconds == 0) {



                        convertFiles('scanandconvert');

                        timerSeconds = document.getElementById("timer").value


                    }
                }
            }

            //

        }
    }


    function selectFolder(folder) {


        var folderPaths
        var app = require('electron').remote;
        var dialog = app.dialog;

        dialog.showOpenDialog({
            title: "Select a folder",
            properties: ["openDirectory"]
        }, (folderPaths) => {
            // folderPaths is an array that contains all the selected paths
            if (folderPaths === undefined) {

                return;
            } else {

                document.getElementById(folder).value = folderPaths;
            }
        });




    }


    function viewLogs(logType) {

        if (process.platform == 'win32') {

            var stringProcessingSlash = "\\";
        }

        if (process.platform == 'linux' || process.platform == 'darwin') {
            var stringProcessingSlash = "/";
        }



        //view logs

        var fullPath = __dirname;

        fullPath = fullPath.slice(0, fullPath.lastIndexOf(stringProcessingSlash));


        fullPath = fullPath.slice(0, fullPath.lastIndexOf(stringProcessingSlash));


        if (process.platform == 'win32') {

            if (process.env.NODE_ENV == 'production') {

                //production
                // var logPath = fullPath + "\\HBBatchBeast\\Logs\\" + logType + ".txt";
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/" + logType + ".txt";


            } else {

                //development
                //var logPath = __dirname + "\\HBBatchBeast\\Logs\\" + logType + ".txt";
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/" + logType + ".txt";

            }


        }

        if (process.platform == 'linux' || process.platform == 'darwin') {

            if (process.env.NODE_ENV == 'production') {

                //production

                // var logPath = fullPath + "/Documents/HBBatchBeast/Logs/" + logType + ".txt";
                //   var logPath = homePath+"/Documents/HBBatchBeast/Logs/"+ logType + ".txt";
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/" + logType + ".txt";
            } else {

                //development
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/" + logType + ".txt";


            }
        }



        if (process.platform == 'win32') {

            logPath = logPath

        }

        if (process.platform == 'linux' || process.platform == 'darwin') {

            //  logPath = "\"" + logPath + "\"";

            logPath = logPath


        }


        var opener = require("opener");



        if (fs.existsSync(logPath)) {

            opener(logPath);

        } else {

            alert(document.getElementById("alert_log_not_exist").textContent)
        }




    }



    function viewFolder(folderPath) {

        if (process.platform == 'win32') {

            var stringProcessingSlash = "\\";
        }

        if (process.platform == 'linux' || process.platform == 'darwin') {
            var stringProcessingSlash = "/";
        }



        //view logs

        var fullPath = __dirname;

        fullPath = fullPath.slice(0, fullPath.lastIndexOf(stringProcessingSlash));


        fullPath = fullPath.slice(0, fullPath.lastIndexOf(stringProcessingSlash));


        if (process.platform == 'win32') {

            if (process.env.NODE_ENV == 'production') {

                //production
                //var logPath = fullPath + "\\HBBatchBeast\\Logs\\";
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/";

            } else {

                //development
                // var logPath = __dirname + "\\HBBatchBeast\\Logs\\";
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/";

            }


        }

        if (process.platform == 'linux' || process.platform == 'darwin') {

            if (process.env.NODE_ENV == 'production') {

                //production

                // var logPath = fullPath + "/Documents/HBBatchBeast/Logs/" + logType + ".txt";
                //   var logPath = homePath+"/Documents/HBBatchBeast/Logs/"+ logType + ".txt";
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/";
            } else {

                //development
                var logPath = homePath + "/Documents/HBBatchBeast/Logs/";


            }
        }

        var opener = require("opener");



        if (fs.existsSync(logPath)) {

            opener(logPath);

        } else {

            alert(document.getElementById("alert_folder_not_exist").textContent)
        }




    }


    function openURL(link) {

        var opener = require("opener");
        opener(link);

        // var opn = require('opn');

        // opn(link);

    }




    function OnInput() {
        this.style.height = 'auto';
        this.style.height = (this.scrollHeight) + 'px';
    }



    const remote = require('electron').remote;

    (function handleWindowControls() {
        // When document has loaded, initialise
        document.onreadystatechange = () => {
            if (document.readyState == "complete") {
                init();
            }
        };

        function init() {
            let window = remote.getCurrentWindow();
            const minButton = document.getElementById('min-button'),
                maxButton = document.getElementById('max-button'),
                restoreButton = document.getElementById('restore-button'),
                closeButton = document.getElementById('close-button');

            minButton.addEventListener("click", event => {
                window = remote.getCurrentWindow();
                window.minimize();
            });

            maxButton.addEventListener("click", event => {
                window = remote.getCurrentWindow();
                window.maximize();
                toggleMaxRestoreButtons();
            });

            restoreButton.addEventListener("click", event => {
                window = remote.getCurrentWindow();
                window.unmaximize();
                toggleMaxRestoreButtons();
            });

            // Toggle maximise/restore buttons when maximisation/unmaximisation
            // occurs by means other than button clicks e.g. double-clicking
            // the title bar:
            toggleMaxRestoreButtons();
            window.on('maximize', toggleMaxRestoreButtons);
            window.on('unmaximize', toggleMaxRestoreButtons);

            closeButton.addEventListener("click", event => {
                window = remote.getCurrentWindow();

                if (confirm('Are you sure you want to close the program? Any running conversions/scans will end.')) {
                    window.close();
                }



            });

            function toggleMaxRestoreButtons() {
                window = remote.getCurrentWindow();
                if (window.isMaximized()) {
                    maxButton.style.display = "none";
                    restoreButton.style.display = "flex";
                } else {
                    restoreButton.style.display = "none";
                    maxButton.style.display = "flex";
                }
            }
        }
    })();



    function openTab(evt, tabName) {
        // Declare all variables
        var i, tabcontent, tablinks;

        if (document.getElementById(tabName).style.display == "block") {

            document.getElementById(tabName).style.display = "none";
        } else {

            // Get all elements with class="tabcontent" and hide them
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }

            // Get all elements with class="tablinks" and remove the class "active"
            tablinks = document.getElementsByClassName("tablinks");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }

            // Show the current tab, and add an "active" class to the button that opened the tab

            document.getElementById(tabName).style.display = "block";

            evt.currentTarget.className += " active";
        }

        textAreaHeight();
    }



    function toggleView(id) {

        if (document.getElementById(id).style.display == 'none') {

            document.getElementById(id).style.display = 'block';


        } else {

            document.getElementById(id).style.display = 'none';

        }
    }


    function emailAlert(emailMode) {

        try {

            if (emailMode == "Test") {

                var errorList = "Test";

                var subjectLine = "Test"

            } else {

                var errorList = "";
                for (var i = 0; i < errorArray.length; i++) { errorList += errorArray[i] + "\r\n" }
                var subjectLine = "HBBatchBeast:Error with " + errorCount + " files!"

            }






            var email = require("./node_modules/emailjs");
            var server = email.server.connect({
                user: document.getElementById("emailAddress").value,
                password: document.getElementById("emailPassword").value,
                host: document.getElementById("SMTPServer").value,
                ssl: true
            });

            // send the message and get a callback with an error or details of the message that was sent
            server.send({
                text: errorList,
                from: document.getElementById("emailAddress").value,
                to: document.getElementById("emailAddress").value,
                subject: subjectLine
            }, function (err, message) {
                (err || message);

                if (err) {

                    if (emailMode == "Test") {
                        alert(document.getElementById("alert_err_sending_email").textContent)

                        updateConsole("" + document.getElementById("alert_err_sending_email").textContent + "")


                    }
                }
            });

            if (emailMode == "Test") {

                alert(document.getElementById("alert_test_email_sent").textContent)
                updateConsole("" + document.getElementById("alert_test_email_sent").textContent + "")

            }

        } catch (err) { }

    }

    function verifyContinue() {

        var continueQueueProcess = 1;


        //check if all workers have finished their current items before re-enabling 'Continue' button
        for (var j = 0; j < document.getElementById("instanceNumber").value; j++) {

            if (workerStatusFinishedArray[j] != "Finished") {

                var continueQueueProcess = 0;

            }
        }

        if (continueQueueProcess == 1) {

            workersRunning = false
            document.getElementById("continueButtonDiv").style.display = 'block';
            document.getElementById("continueButtonGreyDiv").style.display = 'none';

        }


    }

    function stopQueue() {

        if (confirm('Are you sure you want to stop the queue and end all running processes?')) {

            updateConsole("" + "Stop initiated." + "")


            for (var j = 0; j < document.getElementById("instanceNumber").value; j++) {

                var messageOut = [
                    "suicide",
                ];

                workers[j].send(messageOut);


            }

            document.getElementById("pauseButtonDiv").style.display = 'none';
            document.getElementById("stopButtonDiv").style.display = 'none';
            document.getElementById("continueButtonDiv").style.display = 'none';
            document.getElementById("continueButtonGreyDiv").style.display = 'none';




            alert(document.getElementById("alert_all_workers_stopped").textContent)

        }


    }


    function pauseQueue() {




        if (confirm(document.getElementById("alert_confirm_queue_pause_1").textContent)) {

            pauseQueueInitiate(1)


            alert(document.getElementById("alert_confirm_queue_pause_2").textContent)

        }
    }

    function pauseQueueInitiate(statusMessage) {

        if (statusMessage == 1) {


            document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Paused by user</font></p>";
            exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Paused by user</font></p>";
        } else if (statusMessage == 2) {
            document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Paused by daily scan scheduler</font></p>";
            exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Paused by daily scan scheduler</font></p>";

        }

        updateConsole("" + "Queue pause initiated." + "")

        queueStatusPaused = 1;
        updateInfo = 0

        fs.writeFileSync(homePath + '/Documents/HBBatchBeast/Config/queueStartStop.txt', "0", 'utf8');


        document.getElementById("pauseButtonDiv").style.display = 'none';
        document.getElementById("continueButtonDiv").style.display = 'none';
        document.getElementById("continueButtonGreyDiv").style.display = 'block';
    }



    function queueWorkerMessage() {

        return [

            "queueNumber",
            globalQueueNumberManager,
            skipOrCopyArray[globalQueueNumberManager],
            document.getElementById("copyFilteredFiles").checked,
            document.getElementById("replaceOriginalFile").checked,
            document.getElementById("moveCorruptFileOnOff").checked,
            document.getElementById("corruptDestinationPath").value,
            mode,
            document.getElementById("runPriority").checked,
            document.getElementById("tableQueueNumber" + (globalQueueNumberManager + 1)).checked,
            document.getElementById("includePropertyFileFilter").value + "",
            document.getElementById("excludePropertyFileFilter").value + "",
            document.getElementById("replaceOriginalFileAlways").checked,

            document.getElementById("includeAnyFilesWithProperties").checked,
            document.getElementById("includeAllFilesWithProperties").checked,
            document.getElementById("excludeAnyFilesWithProperties").checked,
            document.getElementById("excludeAllFilesWithProperties").checked,
            document.getElementById("handBrakeMode").checked,
            document.getElementById("FFmpegMode").checked,
            document.getElementById("deleteSourceFiles").checked,
            document.getElementById("customBatPath").value,
            document.getElementById("selectTemporaryConversionFolder").checked,
            sourceQueueArray[globalQueueNumberManager],
            presetArray2[globalQueueNumberManager],
            destinationQueue[globalQueueNumberManager],
            destinationFinalQueue[globalQueueNumberManager],
            document.getElementById("minimumFileSizeOnOff").checked,
            document.getElementById("minimumFileSize").value,
            document.getElementById("maximumFileSizeOnOff").checked,
            document.getElementById("maximumFileSize").value,
            document.getElementById("runThoroughHealthCheck").checked,
            document.getElementById("repairAttempt").checked,
            document.getElementById("CRFRepairValue").value,
            getHandBrakeCLIPath(),
            getFFmpegCLIPath(),
            document.getElementById("saveWorkerLogs").checked,






        ]

    }








    function continueQueue() {



        workersRunning = true

        updateConsole("" + "Continue queue initiated." + "")

        document.getElementById("timerDiv").innerHTML = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Running</font></p>";
        exportStatus = "<p style=\"font-size: 2em;\"><font color=\"#66ccff\">Running</font></p>";


        queueStatusPaused = 0;
        updateInfo = 1;

        document.getElementById("pauseButtonDiv").style.display = 'block';
        document.getElementById("continueButtonDiv").style.display = 'none';
        document.getElementById("continueButtonGreyDiv").style.display = 'none';


        fs.writeFileSync(homePath + '/Documents/HBBatchBeast/Config/queueStartStop.txt', "1", 'utf8');

        for (var i = 0; i < workers.length; i++) {

            var messageOut = [
                "continueWork",
            ];
            workers[i].send(messageOut);



            // //  workers[i].send(currentNumber);



            // if (globalQueueNumberManager <= sourceQueueArray.length - 1) {
            //     var messageOut = queueWorkerMessage();

            //     globalQueueNumberManager++;

            // } else {

            //     //Update worker IPC when changing this

            //    // workerStatusArray.push("Complete")

            //     var messageOut = [
            //         "completed",
            //     ];

            // }
            // workers[i].send(messageOut);


        }





    }


    function clearHealthyFileCache() {

        fs.writeFileSync(homePath + '/Documents/HBBatchBeast/Logs/healthyFileList.txt', "", 'utf8');
        alert(document.getElementById("alert_healthy_file_cache_cleared").textContent)

        updateConsole("" + document.getElementById("alert_healthy_file_cache_cleared").textContent + "")

    }

    function clearOriginalFileCompressAttemptCache() {

        fs.writeFileSync(homePath + '/Documents/HBBatchBeast/Logs/originalFileReplacedList.txt', "", 'utf8');

        alert(document.getElementById("alert_cache_cleared").textContent)

        updateConsole("" + document.getElementById("alert_cache_cleared").textContent + "")
    }


    function cancelItemProcess(workerNumber) {


        document.getElementById("cancelButtonDiv" + workerNumber).innerHTML = "<input type='button' class=\"infoButtonGrey\" value='" + document.getElementById("button_cancel_item").textContent + "' />"
        var messageOut = [
            "exitThread",
        ];
        workers[workerNumber - 1].send(messageOut);
    }



    //big buck bunny
    // var benchFileProperties = [

    //     "index: '0'",
    //     "codec_name: 'h264'",
    //     "codec_long_name: 'H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10'",
    //     "profile: 'Main'",
    //     "codec_type: 'video'",
    //     "codec_time_base: '1/50'",
    //     "codec_tag_string: 'avc1'",
    //     "codec_tag: '0x31637661'",
    //     "width: '1280'",
    //     "height: '720'",
    //     "coded_width: '1280'",
    //     "coded_height: '720'",
    //     "has_b_frames: '0'",
    //     "sample_aspect_ratio: '1:1'",
    //     "display_aspect_ratio: '16:9'",
    //     "pix_fmt: 'yuv420p'",
    //     "level: '31'",
    //     "chroma_location: 'left'",
    //     "refs: '1'",
    //     "is_avc: 'true'",
    //     "nal_length_size: '4'",
    //     "r_frame_rate: '25/1'",
    //     "avg_frame_rate: '25/1'",
    //     "time_base: '1/12800'",
    //     "start_pts: '0'",
    //     "start_time: '0.000000'",
    //     "duration_ts: '67584'",
    //     "duration: '5.280000'",
    //     "bit_rate: '1205959'",
    //     "bits_per_raw_sample: '8'",
    //     "nb_frames: '132'",
    //     "disposition: '[object Object]'",
    //     "tags: '[object Object]'",
    //     "index: '1'",
    //     "codec_name: 'aac'",
    //     "codec_long_name: 'AAC (Advanced Audio Coding)'",
    //     "profile: 'LC'",
    //     "codec_type: 'audio'",
    //     "codec_time_base: '1/48000'",
    //     "codec_tag_string: 'mp4a'",
    //     "codec_tag: '0x6134706d'",
    //     "sample_fmt: 'fltp'",
    //     "sample_rate: '48000'",
    //     "channels: '6'",
    //     "channel_layout: '5.1'",
    //     "bits_per_sample: '0'",
    //     "r_frame_rate: '0/0'",
    //     "avg_frame_rate: '0/0'",
    //     "time_base: '1/48000'",
    //     "start_pts: '0'",
    //     "start_time: '0.000000'",
    //     "duration_ts: '254976'",
    //     "duration: '5.312000'",
    //     "bit_rate: '384828'",
    //     "max_bit_rate: '400392'",
    //     "nb_frames: '249'",
    //     "disposition: '[object Object]'",
    //     "tags: '[object Object]'",

    // ]


    //big buck bunny h265


    var benchFileProperties = [
        "index: '0'",
        "codec_name: 'hevc'",
        "codec_long_name: 'H.265 / HEVC (High Efficiency Video Coding)'",
        "profile: 'Main'",
        "codec_type: 'video'",
        "codec_time_base: '1/24'",
        "codec_tag_string: 'hvc1'",
        "codec_tag: '0x31637668'",
        "width: '3840'",
        "height: '2160'",
        "coded_width: '3840'",
        "coded_height: '2160'",
        "has_b_frames: '2'",
        "pix_fmt: 'yuv420p'",
        "level: '180'",
        "color_range: 'tv'",
        "refs: '1'",
        "r_frame_rate: '24/1'",
        "avg_frame_rate: '24/1'",
        "time_base: '1/24000'",
        "start_pts: '2000'",
        "start_time: '0.083333'",
        "duration_ts: '240000'",
        "duration: '10.000000'",
        "bit_rate: '2010185'",
        "nb_frames: '240'",
        "disposition: '[object Object]'",
        "tags: '[object Object]'",

    ]


    function verifyBenchFiles() {


        updateConsole("" + "Initialising benchmark" + "")
        try { fs.mkdirSync(homePath2 + "/HBBatchBeast") } catch (err) { }
        try { fs.mkdirSync(homePath2 + "/Documents/HBBatchBeast/Bench") } catch (err) { }
        try { fs.mkdirSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input") } catch (err) { }
        try { fs.mkdirSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output") } catch (err) { }

        // var home = require("os").homedir();
        // if (process.platform == 'win32' || process.platform == 'linux') {
        //     var homePath = "."
        // }
        // if (process.platform == 'darwin') {
        //     var homePath = home
        // }

        var fs = require('fs');


        cleanupFiles()

        var ffprobe = require('ffprobe'),
            ffprobeStatic = require('ffprobe-static');
        //var path = require("path");
        var ffprobeStaticPath = ''

        if (process.env.NODE_ENV == 'production') {
            ffprobeStaticPath = require('ffprobe-static').path.replace('app.asar', 'app.asar.unpacked')
        } else { ffprobeStaticPath = require('ffprobe-static').path }

        updateConsole("" + "Checking benchmark files" + "")


        if (fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test1.mp4")) {

            var fileObject

            ffprobe(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test1.mp4", { path: ffprobeStaticPath }, function (err, info) {
                if (err) {
                    console.log("FFprobe encountered an error while trying to read Test1.mp4")

                }
                fileObject = info

                FFprobeDone()


            });

            function FFprobeDone() {
                var redownloadFilesVar = false

                try {
                    var k = 0
                    for (var i = 0; i < fileObject.streams.length; i++) {
                        Object.keys(fileObject.streams[i]).forEach(function (key) {

                            if (benchFileProperties[k] != key + ": '" + fileObject.streams[i][key] + "'") {
                                redownloadFilesVar = true

                            }
                            k++


                        });
                    }

                } catch (err) {
                    console.log("FFprobe encountered an error while trying to read Test1.mp4")
                    redownloadFilesVar = true
                }

                if (redownloadFilesVar == true) {

                    console.log("Test1.mp4 does not match template properties. Redownloading files.")
                    redownloadFiles()

                } else {
                    console.log("Test1.mp4 matches template properties. Copying files.")

                    copyFiles()
                }

            }




        } else {

            console.log("Test1.mp4 does not exist.Redownloading files.")
            redownloadFiles()
        }





    }



    function redownloadFiles() {

        updateConsole("" + "Downloading benchmark files" + "")

        const download = require('download');

        download('https://s3.amazonaws.com/x265.org/video/BigBuckBunny_2000hevc.mp4', homePath2 + "/Documents/HBBatchBeast/Bench/Input/").then(() => {
            //download('https://sample-videos.com/video123/mp4/720/big_buck_bunny_720p_1mb.mp4', homePath2 + "/Documents/HBBatchBeast/Bench/Input/").then(() => {
            //   download('http://downloads.4ksamples.com/videos/sample-Elysium.2013.2160p.mkv', homePath2 + "/Documents/HBBatchBeast/Bench/Input/").then(() => {
            console.log('done!');
            fs.renameSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/BigBuckBunny_2000hevc.mp4", homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test1.mp4")
            console.log("Files downloaded. Now copying.")
            copyFiles()
        });
    }



    function copyFiles() {
        fs.copyFileSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test1.mp4", homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test2.mp4");
        fs.copyFileSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test1.mp4", homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test3.mp4");
        fs.copyFileSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test1.mp4", homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test4.mp4");

        updateConsole("" + "Copying files" + "")
        convertFiles("scanandconvert", 1)
        updateConsole("" + "Running benchmark" + "")

    }



    function cleanupFiles() {
        if (fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test2.mp4")) { fs.unlinkSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test2.mp4") }
        if (fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test3.mp4")) { fs.unlinkSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test3.mp4") }
        if (fs.existsSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test4.mp4")) { fs.unlinkSync(homePath2 + "/Documents/HBBatchBeast/Bench/Input/Test4.mp4") }

        try { fs.unlinkSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test1.mp4") } catch (err) { }
        try { fs.unlinkSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test2.mp4") } catch (err) { }
        try { fs.unlinkSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test3.mp4") } catch (err) { }
        try { fs.unlinkSync(homePath2 + "/Documents/HBBatchBeast/Bench/Output/Test4.mp4") } catch (err) { }


    }


    function selectAllItems() {


        for (var i = 1; i <= (sourceQueueArray.length); i++) {
            document.getElementById("tableQueueNumber" + (i)).checked = true
        }
    }


    function deselectAllItems() {


        for (var i = 1; i <= (sourceQueueArray.length); i++) {
            document.getElementById("tableQueueNumber" + (i)).checked = false
        }
    }

    function invertAllItems() {
        for (var i = 1; i <= (sourceQueueArray.length); i++) {

            if (document.getElementById("tableQueueNumber" + (i)).checked == true) {
                document.getElementById("tableQueueNumber" + (i)).checked = false
            } else {
                document.getElementById("tableQueueNumber" + (i)).checked = true

            }

        }
    }


    function hideTabs() {
        var i, tabcontent, tablinks;
        // Get all elements with class="tabcontent" and hide them
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
    }


    function launchRemoteView() {

        if (document.getElementById("remoteViewOnOFF").checked == true) {


            if (process.env.NODE_ENV == 'production') {
                var URLStem = serverStem + "statuspage/"
            } else {
                var URLStem = serverStem + "statuspage/"
            }



            var apiLink = document.getElementById("apiKEY").innerHTML


            var apiKEYVal = (document.getElementById("apiKEY").innerHTML).trim();

            if (apiKEYVal.length < 40) {

                alert(document.getElementById("alert_validation_api_invalid").textContent);
            } else {
                apiStatusSend();
                openURL(URLStem + apiLink)

            }

        } else {
            alert(document.getElementById("alert_enable_remove_view").textContent);


        }

    }

    function apiStatusSend() {

        if (document.getElementById("remoteViewOnOFF").checked == true) {

            var allWorkerPercentages = "";

            for (var i = 1; i <= document.getElementById("instanceNumber").value; i++) {

                try {
                    allWorkerPercentages += "Worker " + i + ": " + document.getElementById("worker" + i + "Percentage").innerHTML + "  ";
                } catch (err) { }
            }

            var request = require('request')


            request.put(serverStem + 'api/status', {
                json: {

                    "apiKEY": document.getElementById("apiKEY").innerHTML,
                    "StatusMessage": exportStatus,
                    "Remaining": exportRemaining,
                    "Success": exportSuccess,
                    "Error": exportError,
                    "Cancelled": exportCancelled,
                    "Other": exportOther,
                    "Percentages": allWorkerPercentages,
                    "LastCompletedTime": exportLastCompletedTime

                }
            }, (error, res, body) => {
                if (error) {
                    console.error(error)
                    return
                }
                console.log(`statusCode: ${res.statusCode}`)
                console.log(body)
            })


        }
    }


    function generateNewAPIKey() {


        updateConsole("" + "Generating new API Key" + "")


        var result = '';
        var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        var charactersLength = characters.length;
        for (var i = 0; i < 40; i++) {
            result += characters.charAt(Math.floor(Math.random() * charactersLength));
        }

        document.getElementById("apiKEY").innerHTML = result;




    }




    function setProcessPriority() {


        //var path = require("path");
        var childProcess = require("child_process");
        var priorityModulePath = "/modules/priorityModule.js"


        if (process.platform == 'win32') {

            if (mode == "healthCheck") {

                if (document.getElementById("runThoroughHealthCheck").checked) {
                    var workerCommand = 'wmic process where name=\"ffmpeg.exe\" CALL setpriority \"Below normal\"'

                } else {
                    var workerCommand = 'wmic process where name=\"HandBrakeCLI.exe\" CALL setpriority \"Below normal\"'
                }


            } else if (mode != "healthCheck") {

                if (document.getElementById("handBrakeMode").checked) {
                    var workerCommand = 'wmic process where name=\"HandBrakeCLI.exe\" CALL setpriority \"Below normal\"'

                }

                if (document.getElementById("FFmpegMode").checked) {
                    var workerCommand = 'wmic process where name=\"ffmpeg.exe\" CALL setpriority \"Below normal\"'
                }
            }
        }




        if (process.platform == 'linux') {

            if (mode == "healthCheck") {

                if (document.getElementById("runThoroughHealthCheck").checked) {
                    var workerCommand = 'for p in $(pgrep ^ffmpeg$); do renice -n 20 -p $p; done'

                } else {
                    var workerCommand = 'for p in $(pgrep ^HandBrakeCLI$); do renice -n 20 -p $p; done'
                }


            } else if (mode != "healthCheck") {

                if (document.getElementById("handBrakeMode").checked) {
                    var workerCommand = 'for p in $(pgrep ^HandBrakeCLI$); do renice -n 20 -p $p; done'

                }

                if (document.getElementById("FFmpegMode").checked) {
                    var workerCommand = 'for p in $(pgrep ^ffmpeg$); do renice -n 20 -p $p; done'
                }
            }
        }





        if (process.platform == 'darwin') {

            if (mode == "healthCheck") {

                if (document.getElementById("runThoroughHealthCheck").checked) {
                    var workerCommand = 'for p in $(pgrep ^ffmpeg$); do renice -n 20 -p $p; done'

                } else {
                    var workerCommand = 'for p in $(pgrep ^HandBrakeCLI$); do renice -n 20 -p $p; done'
                }


            } else if (mode != "healthCheck") {

                if (document.getElementById("handBrakeMode").checked) {
                    var workerCommand = 'for p in $(pgrep ^HandBrakeCLI$); do renice -n 20 -p $p; done'

                }

                if (document.getElementById("FFmpegMode").checked) {
                    var workerCommand = 'for p in $(pgrep ^ffmpeg$); do renice -n 20 -p $p; done'
                }
            }
        }





        var priorityModule = childProcess.fork(path.join(__dirname, priorityModulePath), [], { silent: true });

        var infoArray = [
            "setPriority",
            workerCommand
        ];


        priorityModule.send(infoArray);

    }



    function toggleConsole() {

        if (document.getElementById("consoleBar").style.height == "50%") {

            document.getElementById("consoleBar").style.height = "5%";
            document.body.style.height = "100%";
            //   document.getElementById("main").style.marginBottom = "0";

        } else {

            document.getElementById("consoleBar").style.height = "50%";
            document.body.style.height = "50%";
            // document.getElementById("main").style.marginBottom = "250px";


        }

    }

    function toggleShowRowsQ(obj, colour, colour1) {

        //  var tb = document.getElementById("sessionConversionsTable");
        // tb.getElementsByTagName("th")[0].style.display = "none";
        //  tb.getElementsByTagName("th")[0].style.display = "block";

        try {

            if (obj.checked == false) {
                for (var i = 1; i < queueTable.rows.length; i++) {

                    //  console.log("here"+queueTable.rows[i].style.backgroundColor)

                    if (queueTable.rows[i].style.backgroundColor == colour || queueTable.rows[i].style.backgroundColor == colour1) {

                        queueTable.rows[i].style.display = 'none';

                    }
                }
            } else if (obj.checked == true) {

                for (var i = 1; i < queueTable.rows.length; i++) {
                    if (queueTable.rows[i].style.backgroundColor == colour || queueTable.rows[i].style.backgroundColor == colour1) {

                        queueTable.rows[i].style.display = 'table-row';


                        queueTable.rows[i].cells[0].style.width = "10%"


                    }
                }
            }

        } catch (err) { }
    }



    function toggleShowRowsO(obj, colour) {

        //  var tb = document.getElementById("sessionConversionsTable");
        // tb.getElementsByTagName("th")[0].style.display = "none";
        //  tb.getElementsByTagName("th")[0].style.display = "block";

        try {

            if (obj.checked == false) {
                for (var i = 0; i < sessionConversionsTable.rows.length; i++) {

                    if (sessionConversionsTable.rows[i].style.backgroundColor == colour) {

                        sessionConversionsTable.rows[i].style.display = 'none';

                    }
                }
            } else if (obj.checked == true) {

                for (var i = 0; i < sessionConversionsTable.rows.length; i++) {
                    if (sessionConversionsTable.rows[i].style.backgroundColor == colour) {

                        sessionConversionsTable.rows[i].style.display = 'table-row';


                        sessionConversionsTable.rows[i].cells[0].style.width = "10%"


                    }
                }
            }
        } catch (err) { }
    }

</script>










<style>
    ::-webkit-scrollbar {
        width: 12px;
        /* for vertical scrollbars */
        height: 12px;
        /* for horizontal scrollbars */
    }

    ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.1);
    }

    ::-webkit-scrollbar-thumb {
        background: #66ccff;
    }





    .folderPaths {


        width: 70%;
        border-radius: 2px;

    }

    .customPresetBox {

        height: 10em;

        width: 70%;
        border-radius: 2px;

    }




    .button1 {
        background-color: #66ccff;
        /* Green */
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        border-radius: 10px;
    }



    .button2one1 {
        background-color: #ffffff;
        border: none;
        color: #4CAF50;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        border-radius: 10px;
    }

    .toggleButton {
        background-color: #0019a8;
        border: none;
        color: rgb(255, 255, 255);

        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        border-radius: 5px;
    }


    .button2one {
        background-color: #88fc80;
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        border-radius: 10px;
    }


    .button2 {
        background-color: #4CAF50;
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        border-radius: 10px;
    }

    .button3 {
        background-color: #66ccff;
        border: none;
        color: white;

        text-align: left;
        text-decoration: none;

        display: block;
        font-size: 1em;
        border-radius: 5px;
        margin-top: 1px;
        margin-bottom: 15px;
        margin-right: 1px;
        margin-left: 1px;
    }

    .button4 {
        background-color: #66ccff;
        border: none;
        color: white;

        text-align: left;
        text-decoration: none;

        font-size: 20px;
        border-radius: 5px;
        margin-top: 1px;
        margin-bottom: 15px;
        margin-right: 1px;
        margin-left: 1px;
    }

    .rounded {

        border-radius: 10px;
    }


    h1 {
        color: white;

    }

    .selectbox {



        width: 30em;
        border-radius: 5px;

    }

    .selectboxlang {


        border-radius: 5px;

    }

    .infoBox {
        width: 5em;
        border-radius: 5px;


    }

    .infoBox2 {
        width: 15em;
        border-radius: 5px;


    }

    .infoButton {

        border-radius: 2px;
        background-color: #ffda6d;
        color: black;


    }

    .infoButtonGrey {

        border-radius: 2px;
        background-color: #4d4d4d;
        color: black;


    }



    table.outputTable th {
        background-color: #0088cc;
        color: black;
    }

    table.outputTable td {

        color: black;
    }

    table.outputTable tr:nth-child(even) {
        background-color: #f2f2f2;
    }

    table.outputTable tr:nth-child(odd) {
        background-color: #c4feff;
    }

    table.outputTable tr:hover {
        background-color: #66ccff;
    }

    table.outputTable {
        border-radius: 5px;
        width: 100%;
        table-layout: auto;
        white-space: normal;

    }




    table.historicTable th {
        background-color: #9b9b9b;
        color: black;
    }

    table.historicTable td {

        color: black;
    }

    table.historicTable tr {
        /* display: table;
  width: auto;
   table-layout: fixed;  */
    }


    table.historicTable tr:nth-child(even) {
        background-color: #828282;
    }

    table.historicTable tr:nth-child(odd) {
        background-color: #545454;
    }


    table.historicTable tr:hover {
        background-color: #66ccff;
    }

    table.historicTable {
        border-radius: 5px;
        width: 100%;
        table-layout: auto;
        white-space: normal;

    }







    .box {
        display: none;
        background: #ccc;
        width: 200px;
        height: 100px;
    }

    #trigger:checked+.box {
        display: block;
    }

    .box {
        display: none;
        background: #ccc;
        width: 200px;
        height: 100px;
    }

    #trigger:checked+.box {
        display: block;
    }

    .alert {
        background-color: #ff9800;
        padding: 0px;

        border-style: solid;
        border: #87001b;
        border-width: 5px;
        width: 40%;
    }


    textarea {
        border: 0 none white;
        overflow: hidden;
        padding: 0;
        outline: none;
        background-color: #D0D0D0;



    }




    * {
        margin: 0;
        padding: 0;
        border: 0;
        vertical-align: baseline;
    }

    html {
        box-sizing: border-box;
    }

    *,
    *:before,
    *:after {
        box-sizing: inherit;
    }

    html,
    body {
        height: 100%;
        margin: 0;
        padding-bottom: 1%;
    }

    body {
        font-family: "Segoe UI", sans-serif;
        background: #1A2933;
        color: #FFF;

    }

    h1 {
        margin: 0 0 10px 0;
        font-weight: 600;
        line-height: 1.2;
    }

    p {
        margin-top: 10px;
        /* color: rgba(255, 255, 255, 0.4); */
        color: #d1e2ff;
    }

    .toolTipClass {
        color: #66ccff;
    }


    body {
        border: 1px solid #48545c;
        overflow-y: hidden;
    }

    #titlebar {
        display: block;
        position: fixed;
        height: 32px;
        width: calc(100% - 2px);

        padding: 4px;
        color: #FFF;




    }

    #titlebar #drag-region {
        width: 100%;
        height: 100%;
        -webkit-app-region: drag;
        display: grid;
        grid-template-columns: auto 138px;

    }

    #main {
        height: calc(100% - 32px);
        margin-top: 32px;
        padding: 20px;
        overflow-y: auto;


    }

    #window-controls {
        display: grid;
        grid-template-columns: repeat(3, 46px);
        position: absolute;
        top: 0;


        /* set left 0 if win/lin */

        /* right: 0; */

        /* set left 0 if macos */

        /* left: 0; */


        height: 100%;
        font-family: "Segoe MDL2 Assets";
        font-size: 10px;
        -webkit-app-region: no-drag;
    }

    #window-controls .button {
        grid-row: 1 / span 1;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 100%;
        user-select: none;
        cursor: default;
        opacity: 0.8;
    }

    #window-controls .button:hover {
        background: rgba(255, 255, 255, 0.2);
        opacity: 1;
    }

    #window-controls #close-button:hover {
        background: #E81123;
    }

    #window-controls #restore-button {
        display: none;
    }



    /* reverse order if not macos */

    /* #window-controls #min-button {
        grid-column: 1;
    }

    #window-controls #max-button,
    #window-controls #restore-button {
        grid-column: 2;
    }

    #window-controls #close-button {
        grid-column: 3;
    } */

    #window-title {

        /* include if  macos */

        /* top: 0;
        right: 0;
        position: absolute; */



        grid-column: 1;
        display: flex;
        overflow-x: hidden;

        align-items: center;
        font-family: "Segoe UI", sans-serif;
        font-size: 12px;
        margin-left: 8px;



    }

    #window-title span {
        overflow: hidden;
        text-overflow: ellipsis;
        line-height: 1.5;

    }


    /* Style the tab */
    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }

    /* Style the buttons that are used to open the tab content */
    .tab button {
        background-color: inherit;
        float: center;
        width: 16%;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
    }

    /* Change background color of buttons on hover */
    .tab button:hover {
        background-color: #ddd;
    }

    /* Create an active/current tablink class */
    .tab button.active {
        background-color: #ccc;
    }

    /* Style the tab content */
    .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
    }



    .grid-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        background-color: #1A2933;
        border: none;

    }

    .wrapper {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
    }

    .grid-itemleft {

        text-align: left;
        border: none;

    }

    .grid-itemright {

        text-align: right;
        border: none;

    }

    .rowitem {}

    .rowitem :hover {
        background-image: linear-gradient(transparent, #2b4b60, transparent);
        /* background-color: #2b4b60; */
        border: none;
        /* box-shadow: 0 2px 2px white; */
        z-index: 0;
        position: relative;


        transition: 0.1s
    }


    .grid-container2 {
        display: grid;
        grid-template-columns: 15% 70% 15%;
        background-color: #1A2933;

    }

    .grid-container3 {
        display: grid;
        grid-template-columns: 15% 70% 15%;
        background-color: #1A2933;

    }





    .grid-item2 {

        text-align: left;

    }


    @font-face {
        font-family: "Elianto-Regular";
        src: url('./assets/Fonts/Blanka-Regular.otf') format("truetype");
    }



    .titleDiv {
        display: inline-block;



    }

    .titleSpan {
        display: inline-block;
        font-family: "Elianto-Regular";
        font-size: 1.5em;


        background: -webkit-linear-gradient(#66ccff, rgb(255, 255, 255));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .HaveAGitGat {

        background-color: #00476b;
        border: none;
        color: white;

        text-align: left;
        text-decoration: none;

        display: block;
        font-size: 1em;
        border-radius: 5px;
        margin-top: 1px;
        margin-bottom: 15px;
        margin-right: 1px;
        margin-left: 1px;


    }


    .HaveAGitGat2 {

        background-color: #00476b;
        border: none;
        color: white;

        text-align: left;
        text-decoration: none;

        display: block;
        font-size: 5em;
        border-radius: 5px;
        margin-top: 1px;
        margin-bottom: 15px;
        margin-right: 1px;
        margin-left: 1px;


    }










    .remoteTab {

        padding-right: 30%;
        padding-left: 30%;
        text-align: left;
    }


    .para {

        padding-right: 20%;
        padding-left: 20%;
        text-align: left;
    }





    .consoleBarClass {
        height: 5%;
        width: 100%;
        position: fixed;
        z-index: 1;
        bottom: 0;
        left: 0;
        background-color: #111;
        overflow-x: hidden;
        transition: 0.2s;

    }

    .consoleBarClass a {
        padding: 8px 8px 8px 8px;
        text-decoration: none;
        font-size: 1em;
        color: #818181;
        display: block;
        transition: 0.3s;
    }

    .consoleBarClass a:hover {
        color: #f1f1f1;
    }

    .consoleBarClass .closebtn {
        position: fixed;
        bottom: 0;
        right: 75px;
        font-size: 1em;
        /* margin-left: 50px; */
        color: #66ccff;
    }

    .consoleBarClass .openbtn {
        position: fixed;
        bottom: 0;
        right: 25px;
        font-size: 1em;
        /* margin-left: 50px; */
        color: #66ccff;
    }

    .github-button {
    position: relative;
    overflow: visible;
    display: inline-block;
    padding: 0.5em 1em;
    border: 1px solid #d4d4d4;
    margin: 0;
    text-decoration: none;
    text-align: center;
    text-shadow: 1px 1px 0 #fff;
    font:11px/normal sans-serif;
    color: #333;
    white-space: nowrap;
    cursor: pointer;
    outline: none;
    background-color: #e9cc49;
    background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#f4f4f4), to(#ececec));
    background-image: -moz-linear-gradient(#f4f4f4, #ececec);
    background-image: -ms-linear-gradient(#f4f4f4, #ececec);
    background-image: -o-linear-gradient(#f4f4f4, #ececec);
    background-image: linear-gradient(#f4f4f4, #ececec);
    -moz-background-clip: padding; /* for Firefox 3.6 */
    background-clip: padding-box;
    border-radius: 0.2em;
    /* IE hacks */
    zoom: 1;
    *display: inline;
}



    #main {
        transition: margin-left .5s;
        padding: 16px;
    }

    /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */
    @media screen and (max-height: 450px) {
        .sidebar {
            padding-top: 15px;
        }

        .sidebar a {
            font-size: 18px;
        }
    }


    .consoleDivClass {}

    .consoleDivClass p {
        color: white;
        font-family: monospace;
    }
</style>





<body>

    <header id="titlebar">
        <div id="drag-region">


            <div id="window-title">
                <span>HBBatchBeast 2.1.5</span>
            </div>

            <div id="window-controls">
                <div class="button" id="min-button">
                    <span>&#xE921;</span>
                </div>
                <div class="button" id="max-button">
                    <span>&#xE922;</span>
                </div>
                <div class="button" id="restore-button">
                    <span>&#xE923;</span>
                </div>
                <div class="button" id="close-button">
                    <span>&#xE8BB;</span>
                </div>
            </div>



        </div>

    </header>

    <div id="main">

        <div id="newVersionDiv" style="display: none; background-color:orange;">
            <center>
                <p font style="color:black">New version available <span id="downloadID"></span></p>
            </center>
        </div>


        <span name="lang_text" id="alert_validation_custom_preset_1" style="display: none;">The number of custom presets
            does not match the number of source folders!</span>
        <span name="lang_text" id="alert_validation_custom_preset_2" style="display: none;">source folders have been
            detected.</span>
        <span name="lang_text" id="alert_validation_custom_preset_3" style="display: none;">custom preset lines have
            been detected. Please double check for invisible line breaks. There should be one folder path or preset per
            line. Make sure you haven't accidentally created a blank line.</span>

        <span name="lang_text" id="alert_validation_filenamesuffix_1" style="display: none;">The number of filename
            suffixes does not match the number of source folders! </span>
        <span name="lang_text" id="alert_validation_filenamesuffix_2" style="display: none;">source folders have been
            detected.</span>
        <span name="lang_text" id="alert_validation_filenamesuffix_3" style="display: none;">filename suffix lines have
            been detected. Please double check for invisible line breaks. There should be one folder path or filename
            suffix per line. Make sure you haven't accidentally created a blank line.</span>


        <span name="lang_text" id="alert_validation_source_folderno_1" style="display: none;">The number of source
            folders does not match the number of destination folders!</span>
        <span name="lang_text" id="alert_validation_source_folderno_2" style="display: none;">source folders have been
            detected.</span>
        <span name="lang_text" id="alert_validation_source_folderno_3" style="display: none;">destination folders have
            been detected. Please double check for invisible line breaks. There should be one folder path per line. Make
            sure you haven't accidentally created a blank line.</span>


        <span name="lang_text" id="alert_validation_temp_folderno_1" style="display: none;">The number of source folders
            does not match the number of temporary conversion folders!</span>
        <span name="lang_text" id="alert_validation_temp_folderno_2" style="display: none;">source folders have been
            detected.</span>
        <span name="lang_text" id="alert_validation_temp_folderno_3" style="display: none;">temporary conversion folders
            have been detected. Please double check for invisible line breaks. There should be one folder path per line.
            Make sure you haven't accidentally created a blank line.</span>


        <span name="lang_text" id="alert_validation_dest_folderno_1" style="display: none;">The number of source folders
            does not match the number of destination folders!</span>
        <span name="lang_text" id="alert_validation_dest_folderno_2" style="display: none;">source folders have been
            detected.</span>
        <span name="lang_text" id="alert_validation_dest_folderno_3" style="display: none;">destination folders have
            been detected. Please double check for invisible line breaks. There should be one folder path per line. Make
            sure you haven't accidentally created a blank line.</span>

        <span name="lang_text" id="alert_validation_container" style="display: none;">Please enter a valid container
            such as '.mp4'. Make sure to include the '.'</span>

        <span name="lang_text" id="alert_validation_corrupt_file_folder_1" style="display: none;">Corrupt file
            folder</span>
        <span name="lang_text" id="alert_validation_corrupt_file_folder_2" style="display: none;">does not exist! Please
            make sure there are no spaces or hidden characters before/after the path</span>


        <span name="lang_text" id="alert_validation_source_folder_exist_1" style="display: none;">Source folder</span>
        <span name="lang_text" id="alert_validation_source_folder_exist_2" style="display: none;">does not exist! Please
            make sure there are no spaces or hidden characters before/after the path</span>


        <span name="lang_text" id="alert_validation_tempOn_tempinside_source_1" style="display: none;">Temporary
            conversion folder</span>
        <span name="lang_text" id="alert_validation_tempOn_tempinside_source_2" style="display: none;">appears to be the
            same as or is within source folder</span>
        <span name="lang_text" id="alert_validation_tempOn_tempinside_source_3" style="display: none;">which will
            prevent HBBatchBeast from functioning correctly. Please change the temporary conversion folder to a folder
            outside of the source folder. If you're wanting to use the 'Replace original files feature', please
            select a destination folder that is not the same as, or within, the source folder, and then check the
            'Replace original files always' checkbox in the advanced settings section. Uncheck the temporary 'Temporary
            conversion folder' checkbox as it will serve no use in this case. Files will be converted into the
            destination folder and then moved back into the source folder.</span>


        <span name="lang_text" id="alert_validation_tempOn_destinside_source_1" style="display: none;">Destination
            folder</span>
        <span name="lang_text" id="alert_validation_tempOn_destinside_source_2" style="display: none;">appears to be the
            same as or is within source folder</span>
        <span name="lang_text" id="alert_validation_tempOn_destinside_source_3" style="display: none;">which will
            prevent HBBatchBeast from functioning correctly. Please change the destination folder to a folder outside of
            the source folder. If you're wanting to use the 'Replace original files feature', please select a
            destination folder that is not the same as, or within, the source folder, and then check the 'Replace
            original files always' checkbox in the advanced settings section. Uncheck the temporary 'Temporary
            conversion folder' checkbox as it will serve no use in this case. Files will be converted into the
            destination folder and then moved back into the source folder.</span>


        <span name="lang_text" id="alert_validation_tempOff_destinside_source_1" style="display: none;">Destination
            folder</span>
        <span name="lang_text" id="alert_validation_tempOff_destinside_source_2" style="display: none;">appears to be
            the same as or is within source folder</span>
        <span name="lang_text" id="alert_validation_tempOff_destinside_source_3" style="display: none;">which will
            prevent HBBatchBeast from functioning correctly. Please change the destination folder to a folder outside of
            the source folder. If you're wanting to use the 'Replace original files feature', please select a
            destination folder that is not the same as, or within, the source folder, and then check the 'Replace
            original files always' checkbox in the advanced settings section. Uncheck the temporary 'Temporary
            conversion folder' checkbox as it will serve no use in this case. Files will be converted into the
            destination folder and then moved back into the source folder.</span>

        <span name="lang_text" id="alert_validation_tempOn_err_creating_temp_1" style="display: none;">Error creating
            temporary conversion folder</span>

        <span name="lang_text" id="alert_validation_tempOn_temp_not_exist_1" style="display: none;">Temporary conversion
            folder</span>
        <span name="lang_text" id="alert_validation_tempOn_temp_not_exist_2" style="display: none;">does not exist!
            Please make sure there are no spaces or hidden characters before/after the path</span>

        <span name="lang_text" id="alert_validation_tempOff_err_creating_dest_1" style="display: none;">Error creating
            destination folder</span>

        <span name="lang_text" id="alert_validation_tempOff_dest_not_exist_1" style="display: none;">Destination
            folder</span>
        <span name="lang_text" id="alert_validation_tempOff_dest_not_exist_2" style="display: none;">does not exist!
            Please make sure there are no spaces or hidden characters before/after the path</span>

        <span name="lang_text" id="alert_validation_tempOn_err_creating_dest_1" style="display: none;">Error creating
            destination folder</span>

        <span name="lang_text" id="alert_validation_tempOn_dest_not_exist_1" style="display: none;">Destination
            folder</span>
        <span name="lang_text" id="alert_validation_tempOn_dest_not_exist_2" style="display: none;">does not exist!
            Please make sure there are no spaces or hidden characters before/after the path</span>


        <span name="lang_text" id="alert_validation_HandBrake_or_FFmpeg" style="display: none;">Please select to use
            HandBrake or FFmpeg!</span>

        <span name="lang_text" id="alert_validation_standard_or_custom" style="display: none;">Please select a standard
            preset or input a custom one!</span>

        <span name="lang_text" id="alert_validation_scan_interval_min" style="display: none;">Please select a scan
            interval of 5 seconds or greater!</span>

        <span name="lang_text" id="alert_validation_worker_numbers" style="display: none;">Please make sure the number
            of simultaneous HandBrake/FFmpeg instances to use is one or greater!</span>

        <span name="lang_text" id="alert_validation_api_invalid" style="display: none;">Invalid API key! Please click
            'New' on the remote monitoring tab to generate a new key.</span>


        <span name="lang_text" id="alert_validation_daily_run_time" style="display: none;">Please enter a daily scan
            START
            time in 24 hour format: hh:mm (for example 13:02)</span>

        <span name="lang_text" id="alert_validation_daily_run_time_end" style="display: none;">Please enter a daily scan
            END
            time in 24 hour format: hh:mm (for example 13:02)</span>

        <span name="lang_text" id="alert_chkbx_delete_source_files" style="display: none;">SOURCE FILES WILL BE DELETED
            AFTER CONVERSION! Please test before proper use!</span>



        <span name="lang_text" id="alert_benchmark_failed" style="display: none;">Benchmark failed!</span>



        <span name="lang_text" id="alert_log_not_exist" style="display: none;">Log does not exist!</span>

        <span name="lang_text" id="alert_folder_not_exist" style="display: none;">Folder does not exist!</span>

        <span name="lang_text" id="alert_err_sending_email" style="display: none;">Error sending email! Please check
            your settings.</span>



        <span name="lang_text" id="alert_test_email_sent" style="display: none;">Test email sent!</span>
        <span name="lang_text" id="alert_all_workers_stopped" style="display: none;">All worker processes have been
            stopped.</span>

        <span name="lang_text" id="alert_confirm_queue_pause_1" style="display: none;">Queue will be paused once current
            items have finished processing. Are you sure you want to pause the queue?</span>


        <span name="lang_text" id="alert_confirm_queue_pause_2" style="display: none;">Queue pause initiated.'Continue'
            button will appear once all workers have paused.</span>

        <span name="lang_text" id="alert_healthy_file_cache_cleared" style="display: none;">Healthy file cache
            cleared!</span>

        <span name="lang_text" id="alert_cache_cleared" style="display: none;">Cache cleared!</span>

        <span name="lang_text" id="button_cancel_item" style="display: none;">Cancel item</span>
        <span name="lang_text" id="alert_enable_remove_view" style="display: none;">Please check the above checkbox to
            use this feature.</span>


        <div class="grid-container3">

            <div ALIGN="LEFT" style="display:inline">

                <img src="./assets/Images/Refresh.png" alt="Italian Trulli" style="width:50x;height:25px;"
                    onclick="location.reload()">

                <p style="display:inline"><span name="lang_text">Configuration</span></p>
                <select name="select_configuration" class="selectboxlang" id="select_configuration">

                    <option value="0">1</option>
                    <option value="1">2</option>
                    <option value="2">3</option>
                    <option value="3">4</option>
                    <option value="4">5</option>
                    <option value="5">6</option>
                    <option value="6">7</option>
                    <option value="7">8</option>
                    <option value="8">9</option>
                    <option value="9">10</option>



                </select>



            </div>

            <div id="consoleBar" class="consoleBarClass">
                <a href="javascript:void(0)" class="openbtn" onclick="viewLogs('MasterLog')">txt</a>
                <a href="javascript:void(0)" class="closebtn" onclick="toggleConsole()"></a>
                <p>
                    <p>
                        <div id="consoleDiv" class="consoleDivClass"></div>


            </div>





            <center>
                <div class="titleDiv" style="display:inline">
                    <span class="titleSpan"
                        onclick="openURL('https://github.com/HaveAGitGat/HBBatchBeast')">HBBatchBeast </span>
                </div>


            </center>





            <div ALIGN="RIGHT">

    <input type="button" class="github-button"
    onclick="openURL('https://github.com/HaveAGitGat/HBBatchBeast')"
    value=" Star" data-icon="octicon-star" >


    
                <div class="lang_select_div" style="position: static; right:95px;">
                    <select name="language_select" class="selectboxlang" id="language_select">
                        <option value="nil">-</option>
                        <option value="af">Afrikaans </option>
                        <option value="az">Azrbaycan </option>
                        <option value="id">bahasa Indonesia </option>
                        <option value="ca">Catal </option>
                        <option value="cs">etina </option>
                        <option value="cy">Cymraeg </option>
                        <option value="da">dansk </option>
                        <option value="de">Deutsche </option>
                        <option value="et">Eesti keel </option>
                        <option value="en">English</option>
                        <option value="es">Espaol </option>
                        <option value="eo">Esperanto </option>
                        <option value="eu">Euskal </option>
                        <option value="tl">Filipino </option>
                        <option value="fr">franais </option>
                        <option value="ga">Gaeilge </option>
                        <option value="gl">Galego </option>
                        <option value="hr">Hrvatski </option>
                        <option value="is">slensku </option>
                        <option value="it">italiano </option>
                        <option value="ht">Kreyl Ayisyen </option>
                        <option value="la">Latine </option>
                        <option value="lv">Latvieu valoda </option>
                        <option value="lt">Lietuvi </option>
                        <option value="hu">Magyar </option>
                        <option value="mt">Malti </option>
                        <option value="ms">Melayu </option>
                        <option value="nl">Nederlands </option>
                        <option value="no">norsk </option>
                        <option value="pl">Polskie </option>
                        <option value="pt">Portugus </option>
                        <option value="ro">Romn </option>
                        <option value="sq">shqiptar </option>
                        <option value="sl">Slovenina </option>
                        <option value="sk">slovensk </option>
                        <option value="fi">Suomalainen </option>
                        <option value="sv">svenska </option>
                        <option value="sw">Swahili </option>
                        <option value="vi">Ting Vit </option>
                        <option value="tr">Trk </option>
                        <option value="yi">Yiddish </option>
                        <option value="el"> </option>
                        <option value="be"> </option>
                        <option value="bg"> </option>
                        <option value="mk"> </option>
                        <option value="ru"> </option>
                        <option value="sr"> </option>
                        <option value="uk"> </option>
                        <option value="ka"> </option>
                        <option value="iw"> </option>
                        <option value="ur"> </option>
                        <option value="ar"> </option>
                        <option value="fa"> </option>
                        <option value="hi"> </option>
                        <option value="bn"> </option>
                        <option value="gu"> </option>
                        <option value="ta"> </option>
                        <option value="te"> </option>
                        <option value="kn"> </option>
                        <option value="th"> </option>
                        <option value="ko"> </option>
                        <option value="zh-TW"> </option>
                        <option value="ja"> </option>
                        <option value="zh-CN"> </option>
                    </select>

                </div>





            </div>

        </div>



        <center>

            <p><span onclick="toolTip('tooltip_source_folders')" class="toolTipClass"></span><span
                    name="lang_text">Source folders</span> </p>




            <div id="tooltip_source_folders" style="display: none;">
                <br>
                <span name="lang_text">This is the source folder which will be scanned for media. The folder needs to be
                    entered
                    with no
                    trailing slash. For example:</span> <br>
                Windows: <br>
                C:\Users\HaveAGitGat\Desktop\Input <br>
                Linux: <br>
                /home/haveagitgat/Desktop/Input <br>
                macOS: <br>
                /Users/haveagitgat/Desktop/Input <br>
                <span name="lang_text">The source folder path box is expandable (press enter to create a new
                    line). If you want to specify multiple source folders, make sure each source folder path is
                    on its own line such as:</span>

                <br>C:\Users\HaveAGitGat\Desktop\Input1
                <br>C:\Users\HaveAGitGat\Desktop\Input2


            </div>


            <textarea type="text" class="folderPaths" id="sourcePath"></textarea>
            <img src="./assets/Images/Folder-Open-icon.png" alt="Italian Trulli" style="width:50x;height:25px;"
                onclick="selectFolder('sourcePath')">


        </center>


        <!-- Tab links -->
        <div class="tab">






            <button class="tablinks" onclick="openTab(event, 'mediaHealthCheck')"><span name="lang_text">Video health
                    check</span></button>



            <button class="tablinks" onclick="openTab(event, 'batchConversion')"><span name="lang_text">Batch conversion
                    and Folder watching</span></button>


            <button class="tablinks" onclick="openTab(event, 'remoteMonitoringSection')"><span
                    id="remoteMonitoringSpan"><span name="lang_text">Remote Monitoring (Beta)</span><span></button>



            <button class="tablinks" onclick="openTab(event, 'benchmarkSection')"><span name="lang_text">Benchmark
                    (Beta)</span></button>




            <button class="tablinks" onclick="openTab(event, 'systemSettings')"><span
                    name="lang_text">System</span></button>

            <button class="tablinks" onclick="openTab(event, 'helpSection')"><span name="lang_text">Help</span></button>

        </div>

        <!-- Tab content -->
        <div id="batchConversion" class="tabcontent">

            <center>




                <div class="rowitem">
                    <div class="grid-container">




                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_temporary_conversion_folders')"
                                    class="toolTipClass"></span><span name="lang_text">Temporary conversion
                                    folders</span></p>
                        </div>

                        <div id="tooltip_temporary_conversion_folders" style="display: none;">
                            <br>

                            <span name="lang_text">If "Temporary conversion folder?" is checked, then HandBrake will
                                convert files into that
                                folder. Once the conversion is finished, the file will be moved into your "Destination
                                folder". You'll need to
                                specify as many temporary conversion folders as source folders. Your first source folder
                                will be converted into
                                your first temporary conversion folder, your second source folder into your second
                                temporary conversion folder
                                and so on. Make sure each temporary conversion folder path is
                                on its own line.</span>


                        </div>



                        <div class="grid-itemright"> <input type="checkbox" class="rounded"
                                id="selectTemporaryConversionFolder" onchange="cbChange2()"></div>




                    </div>
                </div>




                <div id="ShowHide1">

                    <div class="grid-container">

                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_destination_folders')" class="toolTipClass"></span><span
                                    name="lang_text">Destination folders</span></p>
                        </div>
                        <div class="grid-itemright"></div>

                    </div>



                </div>
                <div id="ShowHide2"> </div>


                <div id="tooltip_destination_folders" style="display: none;">
                    <br>

                    <span name="lang_text">Specify destination folder paths. Again, you'll need to
                        specify as many
                        destination folders as source folders. Files from your first source folder will end up in your
                        first destination
                        folder, your second source folder files in your second destination folder and so on.</span>
                    <br>
                    <span name="lang_text">First source folder ---------> First temporary conversion folder --------->
                        First destination folder</span>
                    <br>
                    <span name="lang_text">Second source folder ---------> Second temporary conversion folder --------->
                        Second destination folder</span>
                    <br>
                    <span name="lang_text">etc</span>
                    <br>
                    <span name="lang_text">HBBatchBeast won't work properly if you set the destination folder the same
                        as, or
                        within, the source folder. </span>



                </div>


                <div style="text-align: right">
                    <textarea type="text" class="folderPaths" id="destinationPath"> </textarea>
                    <img src="./assets/Images/Folder-Open-icon.png" alt="Italian Trulli" style="width:50x;height:25px;"
                        onclick="selectFolder('destinationPath')">

                </div>





                <div style="display: none;" id="tempConversionFolderDiv">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_destination_folders')" class="toolTipClass"></span><span
                                    name="lang_text">Destination folder</span></p>
                        </div>
                        <div class="grid-itemright"></div>

                    </div>

                    <div style="text-align: right"> <textarea type="text" class="folderPaths"
                            id="tempDestinationPath"></textarea>

                        <img src="./assets/Images/Folder-Open-icon.png" alt="Italian Trulli"
                            style="width:50x;height:25px;" onclick="selectFolder('tempDestinationPath')">
                    </div>
                </div>


                <div class="rowitem">

                    <p>HandBrake:<input type="checkbox" id="handBrakeMode" class="cb7"
                            onchange="cbChange7(this)">FFmpeg:<input type="checkbox" id="FFmpegMode" class="cb7"
                            onchange="cbChange7(this)"></p>

                </div>




                <div id="standardPresetOptionDiv" style="display: none;">
                    <div class="rowitem">
                        <div class="grid-container">


                            <div class="grid-itemleft">
                                <p><span onclick="toolTip('tooltip_standard_preset')" class="toolTipClass"></span><span
                                        name="lang_text">Standard preset:</span></p>
                            </div>

                            <div class="grid-itemright"> <input type="checkbox" id="selectStandardPreset" class="cb1"
                                    onchange="cbChange1(this)">
                            </div>
                        </div>
                    </div>
                </div>

                <div id="tooltip_standard_preset" style="display: none;">
                    <br>

                    <span name="lang_text">Select the HandBrake preset you'd like to convert your files with. If
                        "Standard preset" is
                        selected, then all files in the folders selected will be converted using the specified HandBrake
                        preset. You can
                        find more about HandBrake presets here:</span>
                    <br>
                    https://handbrake.fr/docs/en/latest/workflow/select-preset.html


                </div>


                <div class="rowitem">
                    <div class="grid-container">

                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_custom_preset')" class="toolTipClass"></span><span
                                    name="lang_text">Custom preset:</span></p>
                        </div>

                        <div class="grid-itemright"> <input type="checkbox" id="selectCustomPreset" class="cb1"
                                onchange="cbChange1(this)">
                        </div>
                    </div>
                </div>

                <div id="tooltip_custom_preset" style="display: none;">
                    <br>

                    <span name="lang_text">If "Custom preset" then you need to enter your own custom preset.
                        HBBatchBeast covers
                        the "HandBrakeCLI -i
                        source -o destination" part of the HandBrakeCLI input so you need to enter the conversion
                        parameters. For
                        example:</span>
                    <br><br>
                    -e x264 -q 20 -B
                    <br><br>
                    -Z "Very Fast 1080p30"
                    <br> <br>
                    -Z "Very Fast 480p30"
                    <br><br>
                    <br><br><span name="lang_text">If using FFmpeg, you need to separate the input and output parameters
                        with a comma. Such as:</span>

                    <br><br>-r 1,-r 24
                    <br><br><span name="lang_text">You can also link to a custom preset that's been exported from the
                        official
                        HandBrake GUI
                        application for example:</span>
                    <br><br>
                    --preset-import-file "C:\Users\HaveAGitGat\Desktop\testpreset.json" -Z "My Preset"
                    <br><br>
                    <span name="lang_text">If you're having trouble with custom presets, it may be due to a known bug
                        with the HandBrakeCLI
                        (will be fixed in next HandBrakeCLI release). Please see this for a temporary solution:</span>
                    <br><br>
                    https://github.com/HandBrake/HandBrake/issues/2047
                    <br><br>
                    <span name="lang_text">Each custom preset needs to be on its own line and, similar to the folders,
                        there need to be as
                        many custom presets as source folders.</span>
                    <br><br> <span name="lang_text">First source folder ---------> First temporary conversion folder
                        ---------> First
                        destination folder @ Custom preset 1</span>
                    <br><br> <span name="lang_text">Second source folder ---------> Second temporary conversion folder
                        ---------> Second
                        destination folder @ Custom preset 2</span>
                    <br><br> <span name="lang_text">etc</span>
                    <br> <br><span name="lang_text">See the following image for guidance:</span>
                    <br>https://imgur.com/a/2tl8dIw
                    <br><br> <span name="lang_text">If using graphics card encoding (such as NVENC), then you may need
                        to reduce the number of
                        HandBrake instances (try 2 or fewer) due to VRAM limitations.</span>

                </div>





                <div style="display: none;" id="standardPresetDiv">

                    <div class="rowitem">

                        <div class="grid-container">

                            <div class="grid-itemleft">
                                <p><span name="lang_text">Select standard preset:</span></p>
                            </div>
                            <div class="grid-itemright"> <select name="preset" class="selectbox" id="preset">
                                    <option value="0">Very Fast 1080p30</option>
                                    <option value="1">Very Fast 720p30</option>
                                    <option value="2">Very Fast 576p25</option>
                                    <option value="3">Very Fast 480p30</option>
                                    <option value="4">Fast 1080p30</option>
                                    <option value="5">Fast 720p30</option>
                                    <option value="6">Fast 576p25</option>
                                    <option value="7">Fast 480p30</option>
                                    <option value="8">HQ 1080p30 Surround</option>
                                    <option value="9">HQ 720p30 Surround</option>
                                    <option value="10">HQ 576p25 Surround</option>
                                    <option value="11">HQ 480p30 Surround</option>
                                    <option value="12">Super HQ 1080p30 Surround</option>
                                    <option value="13">Super HQ 720p30 Surround</option>
                                    <option value="14">Super HQ 576p25 Surround</option>
                                    <option value="15">Super HQ 480p30 Surround</option>
                                    <option value="16">Gmail Large 3 Minutes 720p30</option>
                                    <option value="17">Gmail Medium 5 Minutes 480p30</option>
                                    <option value="18">Gmail Small 10 Minutes 288p30</option>
                                    <option value="19">Vimeo YouTube HQ 2160p60 4K</option>
                                    <option value="20">Vimeo YouTube HQ 1440p60 2.5K</option>
                                    <option value="21">Vimeo YouTube HQ 1080p60</option>
                                    <option value="22">Vimeo YouTube HQ 720p60</option>
                                    <option value="23">Vimeo YouTube 720p30</option>
                                    <option value="24">Android 1080p30</option>
                                    <option value="25">Android 720p30</option>
                                    <option value="26">Android 576p25</option>
                                    <option value="27">Android 480p30</option>
                                    <option value="28">Apple 2160p60 4K HEVC Surround</option>
                                    <option value="29">Apple 1080p60 Surround</option>
                                    <option value="30">Apple 1080p30 Surround</option>
                                    <option value="31">Apple 720p30 Surround</option>
                                    <option value="32">Apple 540p30 Surround</option>
                                    <option value="33">Apple 240p30</option>
                                    <option value="34">Chromecast 2160p60 4K HEVC Surround</option>
                                    <option value="35">Chromecast 1080p60 Surround</option>
                                    <option value="36">Chromecast 1080p30 Surround</option>
                                    <option value="37">Amazon Fire 2160p60 4K HEVC Surround</option>
                                    <option value="38">Amazon Fire 1080p30 Surround</option>
                                    <option value="39">Amazon Fire 720p30</option>
                                    <option value="40">Playstation 1080p30 Surround</option>
                                    <option value="41">Playstation 720p30</option>
                                    <option value="42">Playstation 540p30</option>
                                    <option value="43">Roku 2160p60 4K HEVC Surround</option>
                                    <option value="44">Roku 1080p30 Surround</option>
                                    <option value="45">Roku 720p30 Surround</option>
                                    <option value="46">Roku 576p25</option>
                                    <option value="47">Roku 480p30</option>
                                    <option value="48">Windows Mobile 1080p30</option>
                                    <option value="49">Windows Mobile 720p30</option>
                                    <option value="50">Windows Mobile 540p30</option>
                                    <option value="51">Windows Mobile 480p30</option>
                                    <option value="52">Xbox 1080p30 Surround</option>
                                    <option value="53">Xbox Legacy 1080p30 Surround</option>
                                    <option value="54">H.265 MKV 2160p60</option>
                                    <option value="55">H.265 MKV 1080p30</option>
                                    <option value="56">H.265 MKV 720p30</option>
                                    <option value="57">H.265 MKV 576p25</option>
                                    <option value="58">H.265 MKV 480p30</option>
                                    <option value="59">H.264 MKV 2160p60</option>
                                    <option value="60">H.264 MKV 1080p30</option>
                                    <option value="61">H.264 MKV 720p30</option>
                                    <option value="62">H.264 MKV 576p25</option>
                                    <option value="63">H.264 MKV 480p30</option>
                                    <option value="64">VP9 MKV 2160p60</option>
                                    <option value="65">VP9 MKV 1080p30</option>
                                    <option value="66">VP9 MKV 720p30</option>
                                    <option value="67">VP9 MKV 576p25</option>
                                    <option value="68">VP9 MKV 480p30</option>
                                    <option value="69">VP8 MKV 1080p30</option>
                                    <option value="70">VP8 MKV 720p30</option>
                                    <option value="71">VP8 MKV 576p25</option>
                                    <option value="72">VP8 MKV 480p30</option>
                                    <option value="73">Production Max</option>
                                    <option value="74">Production Standard</option>
                                    <option value="75">Production Proxy 1080p</option>
                                    <option value="76">Production Proxy 540p</option>



                                </select> </div>

                        </div>
                    </div>
                </div>

                <div style="display: none;" id="customPresetDiv">


                    <div style="text-align: right">
                        <textarea type="text" class="customPresetBox" id="customPresets"></textarea>
                    </div>

                </div>

                <div id="custompresetNotification" style="display: none;">
                    <p>
                        <font color="#66ccff"><span name="lang_text">NVENC detected, please make sure to lower the
                                number of HandBrakeCLI instances to 2 or below (for most graphics cards) or you may
                                encounter errors due to not enough VRAM. This setting can be found in the "System"
                                tab.</span></font>



                    </p>
                </div>

                <div id="custompresetNotificationImportedJSON" style="display: none;">
                    <p>
                        <font color="#66ccff"><span name="lang_text">Imported preset detected.If you're having trouble
                                with imported custom presets, it may be due to a known bug with the HandBrakeCLI (will
                                be fixed in next HandBrakeCLI release). A temporary solution is to remove
                                '"PictureRotate": "0:0"' from the .json file. More info here:</span></font>
                    </p>
                    <br>https://github.com/HandBrake/HandBrake/issues/2047
                </div>

                <div class="rowitem">
                    <div class="grid-container">



                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_container')" class="toolTipClass"></span><span
                                    name="lang_text">Container:</span></p>
                        </div>
                        <div class="grid-itemright">


                            <div class="grid-itemright">
                                <input type="text" class="infoBox" id="container">



                            </div>
                        </div>
                    </div>
                </div>

                <div id="tooltip_container" style="display: none;">
                    <br>

                    <span name="lang_text">Specify the container you'd like the output file to have such as '.mp4'. You
                        can find out more about containers at:</span>
                    <br>
                    <br>
                    https://handbrake.fr/docs/en/latest/technical/containers.html

                </div>






                <div class="rowitem">
                    <div class="grid-container">

                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_periodic_scanning')" class="toolTipClass"></span><span
                                    name="lang_text">Enable periodic scanning:</span></p>
                        </div>

                        <div class="grid-itemright"><input type="checkbox" id="scanOnOff" onchange="cbChange4(this)"
                                class="cb4"></div>

                    </div>
                </div>

                <div id="tooltip_periodic_scanning" style="display: none;">
                    <br>

                    <span name="lang_text">HBBatchBeast can monitor your source folders and run scans for new files at a
                        specified
                        interval. The interval time is in seconds with the default being 300 seconds (5 minutes). If
                        this option is
                        selected, then when you press "Scan and convert", the program will convert any new files and
                        then a countdown
                        timer will begin. This will loop infinitely until stopped. The scan interval is in the advanced
                        settings
                        section.</span>


                </div>


                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_daily_scanning')" class="toolTipClass"></span><span
                                    name="lang_text">Enable daily scanning:</span></p>
                        </div>

                        <div class="grid-itemright"><input type="checkbox" id="dailyRunTimeOnOff"
                                onchange="cbChange4(this)" class="cb4"></div>

                    </div>
                </div>

                <div id="tooltip_daily_scanning" style="display: none;">
                    <br>

                    <span name="lang_text">Instead of periodic scanning, you can choose for a scan to be run once a day
                        during a specified time window.
                        The scan time
                        is entered in the advanced settings section in hh:mm format such as '18:30'. Once "Scan and
                        convert" is selected, the program
                        will wait until the specified time until running a scan and conversion process. The program will
                        continue scanning and transcoding until the end of the time window is reached. If a transcode
                        queue is running, the queue will be paused. The program will then wait until the start time
                        before starting a new scan/convert or continuing the previous queue.</span>


                </div>






                <div class="rowitem">
                    <div class="grid-container">

                        <div class="grid-itemleft">
                            <p><span name="lang_text">Show/hide advanced:</span></p>
                        </div>

                        <div class="grid-itemright"><input id="showHideAdvanced" type="checkbox" onchange="cbChange3()">
                        </div>

                    </div>
                </div>





                <div id="advancedSettings" style="display: none;">





                    <div id="showHideScanInterval" style="display: none;">
                        <div class="rowitem">
                            <div class="grid-container">

                                <div class="grid-itemleft">
                                    <p><span name="lang_text">Scan interval (minimum 5 seconds):</span></p>
                                </div>

                                <div class="grid-itemright"><input type="text" class="infoBox" id="timer"></div>
                            </div>
                        </div>

                    </div>






                    <div id="showHideDailyRunTime" style="display: none;">
                        <div class="rowitem">
                            <div class="grid-container">
                                <div class="grid-itemleft">
                                    <p><span name="lang_text">Daily run time (hh:mm to hh:mm):</span></p>
                                </div>

                                <div class="grid-itemright"><input type="text" class="infoBox" id="dailyRunTime"> -
                                    <input type="text" class="infoBox" id="dailyRunTimeEnd">
                                </div>



                            </div>

                        </div>
                    </div>

                    <div class="rowitem">
                        <div class="grid-container">

                            <div class="grid-itemleft">
                                <p><span onclick="toolTip('tooltip_filename_suffix')" class="toolTipClass"></span><span
                                        name="lang_text">Output filename suffix:</span><input type="checkbox"
                                        id="fileNameSuffixToggle"></p>
                            </div>
                            <div class="grid-itemright">


                                <div class="grid-itemright">
                                    <textarea type="text" class="customPresetBox" id="fileNameSuffix"></textarea>



                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="tooltip_filename_suffix" style="display: none;">

                        <br><br><span name="lang_text">This is optional. You can specify a suffix to add to the end of
                            your
                            filename like
                            '_1080p' or '_testconversion' etc.</span>
                        <br><br><span name="lang_text">If 'standard preset' is selected then all output files will have
                            the
                            same suffix.</span>
                        <br><br><span name="lang_text">If 'custom preset' is selected then you can specify one suffix
                            per
                            source folder/custom
                            preset. Make sure each suffix is on its own line. For example, if you have 2 source folders
                            and
                            are using 'custom preset', you could put this in the filename suffix box:</span>
                        <br><br> _720p
                        <br>_1080p
                        <br><br><span name="lang_text">Files in the first source folder will have '_720p' added to
                            output
                            filename. Files in the second source folder will have '_1080p' added to output filename
                            etc.</span>

                    </div>





                    <div class="rowitem">
                        <div class="grid-container">

                            <div style="text-align: left">
                                <p><span onclick="toolTip('tooltip_exclude_files_smaller_than')"
                                        class="toolTipClass"></span><span name="lang_text">Exclude files smaller than
                                        (MB):</span><input type="checkbox" id="minimumFileSizeOnOff"></p>

                            </div>
                            <div style="text-align: right">
                                <input type="text" class="infoBox" id="minimumFileSize">
                            </div>

                        </div>
                    </div>

                    <div id="tooltip_exclude_files_smaller_than" style="display: none;">
                        <br>

                        <span name="lang_text">Specify whether to exclude files smaller than a certain size from
                            conversion (in megabytes)</span>


                    </div>


                    <div class="rowitem">
                        <div class="grid-container">

                            <div style="text-align: left">
                                <p><span onclick="toolTip('tooltip_exclude_files_larger_than')"
                                        class="toolTipClass"></span><span name="lang_text">Exclude files larger than
                                        (MB):</span><input type="checkbox" id="maximumFileSizeOnOff"></p>

                            </div>
                            <div style="text-align: right">
                                <input type="text" class="infoBox" id="maximumFileSize">
                            </div>

                        </div>
                    </div>

                    <div id="tooltip_exclude_files_larger_than" style="display: none;">
                        <br>

                        <span name="lang_text">Specify whether to exclude files larger than a certain size from
                            conversion (in megabytes)</span>


                    </div>


                    <div class="rowitem">
                        <div class="grid-container">

                            <div style="text-align: left">
                                <p><span onclick="toolTip('tooltip_exclude_files_with_words')"
                                        class="toolTipClass"></span><span name="lang_text">Exclude filenames which
                                        include any of these words:</span>
                                </p>
                            </div>

                            <div style="text-align: right">
                                <textarea type="text" class="folderPaths" id="titleWordFilter"></textarea>
                            </div>

                        </div>
                    </div>

                    <div id="tooltip_exclude_files_with_words" style="display: none;">
                        <br>

                        <span name="lang_text">Enter keywords to be filtered out when scanning for files. For example,
                            if "720p" is entered,
                            then any files with "720p" in the title will not be converted. Again, keywords need to be
                            separated by a comma.
                            For example, enter the following in the filter box:</span>

                        <br>
                        <br>
                        720p,Sample,Trailer


                    </div>



                    <div class="rowitem">
                        <div class="grid-container">
                            <div style="text-align: left">
                                <p><span onclick="toolTip('tooltip_include_files_with_properties')"
                                        class="toolTipClass"></span><span name="lang_text">Include files with any
                                    </span><input type="checkbox" id="includeAnyFilesWithProperties"
                                        onchange="cbChange6(this)" class="cb6"><span name="lang_text"> or all
                                    </span><input type="checkbox" id="includeAllFilesWithProperties"
                                        onchange="cbChange6(this)" class="cb6"><span name="lang_text"> of
                                        these</span><span id="includeAllFilesWithPropertiesNumber"
                                        style="display:inline"></span><span name="lang_text">properties:</span></p>


                            </div>

                            <div style="text-align: right">
                                <textarea type="text" class="folderPaths" id="includePropertyFileFilter"></textarea>
                            </div>

                        </div>
                    </div>


                    <div id="tooltip_include_files_with_properties" style="display: none;">
                        <br><span name="lang_text">Here you can input video and audio properties that files must
                            have in order to be
                            converted (info extracted using FFprobe). The properties must be separated by a comma. Use
                            the media info viewer
                            tool to help determine what properties you'd like to include. Make sure to put a comma after
                            the last property. For
                            example, to only convert files which are encoded using h264 and aac stereo audio:</span>
                        <br><br>codec_name: 'h264',codec_name: 'aac',channel_layout: 'stereo',

                        <br><br><span name="lang_text">It's worth noting that this property check is done once the
                            conversion process starts
                            (to save time while building the queue), so although files may appear in the conversion
                            queue, they will be
                            skipped/included if the correct conditions are met.</span>
                        <br><br><span name="lang_text">If FFprobe is able to extract properties, then an 'OK' will
                            appear in the "FFprobe" column in the queue view.</span>

                    </div>


                    <div class="rowitem">
                        <div class="grid-container">

                            <div style="text-align: left">
                                <p><span onclick="toolTip('tooltip_exclude_files_with_properties')"
                                        class="toolTipClass"></span><span name="lang_text">Exclude files with any
                                    </span><input type="checkbox" id="excludeAnyFilesWithProperties"
                                        onchange="cbChange6(this)" class="cb6"><span name="lang_text"> or all
                                    </span><input type="checkbox" id="excludeAllFilesWithProperties"
                                        onchange="cbChange6(this)" class="cb6"><span name="lang_text"> of these
                                    </span><span id="excludeAllFilesWithPropertiesNumber" style="display:inline"></span>
                                    <span name="lang_text">properties:</span>

                                </p>




                            </div>

                            <div style="text-align: right">
                                <textarea type="text" class="folderPaths" id="excludePropertyFileFilter"></textarea>
                            </div>

                        </div>
                    </div>
                    <div id="tooltip_exclude_files_with_properties" style="display: none;">
                        <br><span name="lang_text">The opposite of 'Include files with any or all of these
                            properties'</span>


                    </div>



                    <span onclick="toolTip('tooltip_media_info_viewer_tool')" class="toolTipClass"></span> <input
                        type="button" onclick="createViewMediaInfo()" value="Media info viewer tool" class="infoButton">

                    <div id="tooltip_media_info_viewer_tool" style="display: none;">
                        <br><span name="lang_text">This is a small tool to analyse file properties with in order to
                            help you determine which
                            properties you'd like to include/exclude in the above options. It uses FFprobe to return
                            information. Drag and drop
                            files into the grey box to analyse them. For example, dropping in a test file might return
                            the following:</span>

                        <br> <br>index: '0'
                        <br>codec_name: 'h264'
                        <br>codec_long_name: 'H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10'
                        <br>profile: 'Main'
                        <br>codec_type: 'video'
                        <br>codec_time_base: '72001/180000'
                        <br>codec_tag_string: 'avc1'
                        <br>codec_tag: '0x31637661'
                        <br>width: '32'
                        <br>height: '32'
                        <br><br><span name="lang_text">If you're looking to exclude files like this from being
                            converted, then you can put several file properties into the "Exclude files with any or all
                            of these properties" box and check the checkbox next to 'all' instead of 'any', like
                            so:</span>
                        <br><br>codec_name: 'h264',codec_long_name: 'H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10',


                    </div>


                    <div class="rowitem">
                        <div class="grid-container">

                            <div class="grid-itemleft">
                                <p><span onclick="toolTip('tooltip_copy_filtered_files')"
                                        class="toolTipClass"></span><span name="lang_text">Copy excluded files to
                                        destination:</span>
                                </p>
                            </div>

                            <div class="grid-itemright"><input type="checkbox" id="copyFilteredFiles"></div>
                        </div>
                    </div>
                    <div id="tooltip_copy_filtered_files" style="display: none;">
                        <br><span name="lang_text">If you select this option, then files which have been excluded
                            from conversion will
                            be
                            copied directly to the destination folder. This applies to the following filters:</span>

                        <br><br><span name="lang_text">Exclude filenames which include any of these words</span>
                        <br><span name="lang_text">Include files with any or all of these properties</span>
                        <br><span name="lang_text">Exclude files with any or all of these properties</span>
                        <br><span name="lang_text">Exclude files smaller than (MB)</span>
                        <br><span name="lang_text">Exclude files larger than (MB)</span>
                        <br><br><span name="lang_text">Note this also applies to files excluded because they don't meet
                            the
                            "Include" property
                            conditions of the above so don't accidentally copy you're entire library when you're only
                            trying to convert a
                            few
                            files.</span>
                        <br><br><span name="lang_text">The copy feature does not apply to the following filters (i.e.
                            files excluded due to the filter)</span>
                        <br><br><span name="lang_text">Include these file types</span>

                    </div>


                    <div class="rowitem">
                        <div class="grid-container">
                            <div class="grid-itemleft">

                                <div id="deleteItemDiv">
                                    <p id="deleteSourceFilesdiv"><span onclick="toolTip('tooltip_delete_source_files')"
                                            class="toolTipClass"></span><span name="lang_text">Delete source files
                                            after
                                            conversion:</span></p>

                                </div>
                            </div>

                            <div class="grid-itemright">


                                <div id="deleteItemDiv2">
                                    <input type="checkbox" name="deleteSourceFilesname" id="deleteSourceFiles"
                                        onchange="showAlert(document.getElementById('alert_chkbx_delete_source_files').textContent,this)"
                                        class="cb5">
                                </div>

                            </div>

                        </div>
                    </div>

                    <div id="tooltip_delete_source_files" style="display: none;">

                        <br><span name="lang_text">If this is selected, then if a conversion attempt is successful, the
                            source file
                            will be deleted. This process is done at the very end, after conversion of all files. This
                            means that you can convert the
                            same source files using multiple presets, all in one go. The source files will then be
                            deleted afterwards.</span>


                    </div>


                    <div class="rowitem">
                        <div class="grid-container">

                            <div class="grid-itemleft">
                                <p><span onclick="toolTip('tooltip_compress_attempt')"
                                        class="toolTipClass"></span><span name="lang_text">Replace original file if
                                        converted file is smaller?(Compress
                                        attempt)</span></p>

                            </div>

                            <div class="grid-itemright"><input type="checkbox" id="replaceOriginalFile"
                                    onchange="cbChange5(this)" class="cb5"></div>
                        </div>
                    </div>

                    <div id="tooltip_compress_attempt" style="display: none;">
                        <br><span name="lang_text">Select this check box if you'd like HBBatchBeast to automatically
                            replace the
                            original
                            source file if the new file is smaller. If the new file is not smaller, then it will be left
                            in the destination
                            folder.</span>
                        <br> <br><span name="lang_text">Make sure your destination folder is not the same as/or within,
                            your source folder
                            or it won't work properly.</span>
                        <br> <br><span name="lang_text">Once HBBatchBeast has attempted to compress a specific file, it
                            will add
                            that file path to a
                            cache so that it won't be attempted again in future. You can view/edit/clear the cache using
                            the yellow
                            buttons.</span>


                    </div>





                    <div class="rowitem">
                        <div class="grid-container">
                            <div class="grid-itemleft">
                                <p><span onclick="toolTip('tooltip_replace_source_always')"
                                        class="toolTipClass"></span><span name="lang_text">Replace original file
                                        always?</span>
                                </p>
                            </div>

                            <div class="grid-itemright"><input type="checkbox" id="replaceOriginalFileAlways"
                                    onchange="cbChange5(this)" class="cb5"></div>

                        </div>
                    </div>

                    <div id="tooltip_replace_source_always" style="display: none;">

                        <br><span name="lang_text">The original file will be replaced regardless of whether the new file
                            is larger or
                            smaller.</span>
                        <br> <br><span name="lang_text">Again, make sure your destination folder is not the same as/or
                            within, your source
                            folder or it won't work properly.</span>

                        <br> <br><span name="lang_text">Once HBBatchBeast has transcoded a specific file, it
                            will add
                            that file path to a
                            cache so that it won't be attempted again in future. You can view/edit/clear the cache using
                            the yellow
                            buttons.</span>


                    </div>

                    <input type="button" onclick="viewLogs('originalFileReplacedList')" value="View replaced file cache"
                        class="infoButton">


                    <input type="button" onclick="clearOriginalFileCompressAttemptCache()"
                        value="Clear replaced file cache" class="infoButton">


                    <div class="rowitem">
                        <div class="grid-container">

                            <div class="grid-itemleft">
                                <p><span onclick="toolTip('tooltip_copy_srt_files')" class="toolTipClass"></span><span
                                        name="lang_text">Copy subtitle (srt) files to destination?</span></p>
                            </div>



                            <div class="grid-itemright"><input type="checkbox" id="copySRTFiles"></div>

                        </div>
                    </div>

                    <div id="tooltip_copy_srt_files" style="display: none;">

                        <br><span name="lang_text">Subtitle '.srt' files will be copied to the destination folder
                            automatically.</span>


                    </div>



                    <div class="rowitem">
                        <div class="grid-container">
                            <div class="grid-itemleft">
                                <p><span name="lang_text">Automatically create temporary/destination folders if they
                                        don't
                                        exist?</span></p>

                            </div>

                            <div class="grid-itemright"><input type="checkbox" id="autoCreateFolders"></div>

                        </div>
                    </div>




                    <div id="customBatPathDiv" style="display: none;">

                        <div class="rowitem">
                            <div class="grid-container">

                                <div style="text-align: left">
                                    <p><span onclick="toolTip('tooltip_custom_bat')" class="toolTipClass"></span><span
                                            name="lang_text">Custom bat path to run after each conversion (leave blank
                                            if not using):</span></p>

                                </div>

                                <div style="text-align: right">
                                    <textarea type="text" class="folderPaths" id="customBatPath"></textarea>
                                </div>

                            </div>
                        </div>

                    </div>


                    <div id="tooltip_custom_bat" style="display: none;">

                        <br><span name="lang_text">Input the path to a custom batch file which you'd like to execute
                            after each conversion. For example:</span>
                        <br> <br>C:\Users\HaveAGitGat\Desktop\Input\CopyToBackupDrive.bat
                        <br> <br><span name="lang_text">Batch files with timeout statements won't work. More info
                            here:</span>
                        <br>
                        <br>https://comm.support.ca.com/kb/the-timeout-command-in-batch-script-job-results-in-error-input-redirection-is-not-supported-exiting-the-process-immediately/kb000029524
                        <br> <br><span name="lang_text">Leave box completely empty if you do not wish to use this option
                            (make sure there are no hidden characters in the box)</span>


                    </div>


                    <div id="runPriorityDiv" style="display: block;">

                        <div class="rowitem">
                            <div class="grid-container">

                                <div style="text-align: left">
                                    <p><span onclick="toolTip('tooltip_run_low_priority')"
                                            class="toolTipClass"></span><span name="lang_text">Run processes at low
                                            priority?</span>
                                    </p>
                                </div>

                                <div style="text-align: right">
                                    <input type="checkbox" id="runPriority">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="tooltip_run_low_priority" style="display: none;">

                        <br><span name="lang_text">All conversion processes will be run at low priority, reducing
                            processor
                            usage.</span>


                    </div>



                    <div class="rowitem">
                        <div class="grid-container">

                            <div style="text-align: left">
                                <p><span onclick="toolTip('tooltip_remove_apostrophes')"
                                        class="toolTipClass"></span><span name="lang_text">Remove apostrophes from
                                        filenames:</span>
                                </p>
                            </div>

                            <div style="text-align: right">
                                <input type="checkbox" id="removeApostrophes">
                            </div>
                        </div>
                    </div>


                    <div id="tooltip_remove_apostrophes" style="display: none;">

                        <br><span name="lang_text">Conversions/health check scans may fail if filenames have apostrophes
                            in. Check this to
                            automatically remove apostrophes from filenames.</span>


                    </div>



                    <div class="rowitem">
                        <div class="grid-container">

                            <div style="text-align: left">
                                <p><span onclick="toolTip('tooltip_reverse_file_queue')"
                                        class="toolTipClass"></span><span name="lang_text">Reverse file queue:</span>
                                </p>
                            </div>

                            <div style="text-align: right">
                                <input type="checkbox" id="reverseFileQueue">
                            </div>
                        </div>
                    </div>


                    <div id="tooltip_reverse_file_queue" style="display: none;">

                        <br><span name="lang_text">Check this option to reverse the file queue when scanning for
                            files.Items will be processed in reverse order.</span>


                    </div>















                </div> <!-- end of advanced settings  -->











                <br>
                <br>


                <input type='button' class="button1" value='Save config' onclick='saveConfig()' />



                <input type='button' class="button2one" value='Scan only' onclick='convertFiles("scanonly")' />
                <input type='button' class="button2" value='Scan and convert'
                    onclick='convertFiles("scanandconvert")' />


                <div id="HBCLIStatus"></div>

                <div id="conversionInfo"></div>



                <p>---------------------------------------------------------------------------------------</p>




                <input type="button" onclick="viewLogs('Scans')" value="View scan/conversion summary log"
                    class="infoButton">

                <input type="button" onclick="viewLogs('fileConversionLog')"
                    value="View individual file check/conversion log" class="infoButton">


                <input type="button" onclick="viewFolder('')" value="View worker console output" class="infoButton">

            </center>

        </div>





        <div id="mediaHealthCheck" class="tabcontent">
            <center>

                <span onclick="toolTip('tooltip_health_check_tab')" class="toolTipClass"></span>


                <div id="tooltip_health_check_tab" style="display: none;">
                    <br>
                    <span name="lang_text"> This feature can scan for corrupt video files using HandBrake's '--scan'
                        feature, although
                        this is not always accurate. It also uses FFprobe to provide a second reference point. If both
                        FFprobe and
                        HandBrake fail then there is a high chance that the file is corrupt.</span>
                </div>




                <p></p>
                <p></p>
                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_move_corrupt_files')" class="toolTipClass"></span><span
                                    name="lang_text">Move corrupt files into the following folder:</span></p>
                        </div>

                        <div class="grid-itemright"> <input type="checkbox" id="moveCorruptFileOnOff">
                        </div>
                    </div>
                </div>




                <div id="tooltip_move_corrupt_files" style="display: none;">
                    <br>
                    <span name="lang_text"> If checked, then any files which give errors will be moved into the
                        specified folder.</span>
                </div>

                <div class="grid-container">
                    <div class="grid-itemleft">
                        <p><span name="lang_text">Corrupt file folder:</span></p>
                    </div>
                    <div class="grid-itemright"></div>

                </div>

                <div style="text-align: right"> <textarea type="text" class="folderPaths"
                        id="corruptDestinationPath"></textarea>

                    <img src="./assets/Images/Folder-Open-icon.png" alt="Italian Trulli" style="width:50x;height:25px;"
                        onclick="selectFolder('corruptDestinationPath')">
                </div>


                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_thorough_health_check')"
                                    class="toolTipClass"></span><span name="lang_text">Run thorough file health
                                    check:</span></p>
                        </div>

                        <div class="grid-itemright"> <input type="checkbox" id="runThoroughHealthCheck">
                        </div>
                    </div>
                </div>

                <div id="tooltip_thorough_health_check" style="display: none;">
                    <br>
                    <span name="lang_text"> If checked, then a much slower, more thorough video health check will be run
                        using FFmpeg instead of HandBrake.</span>
                    <span name="lang_text"> Based on Desani's 'ScanMedia.ps1' found at:</span>
                    <br>
                    https://gist.github.com/Desani/129be27da7d735d7c75192ec1aa96c65
                </div>

                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_thorough_health_check_repair_attempt')"
                                    class="toolTipClass"></span><span name="lang_text">Attempt to repair files after
                                    thorough check:</span></p>
                        </div>

                        <div class="grid-itemright"> <input type="checkbox" id="repairAttempt">
                        </div>
                    </div>
                </div>

                <div id="tooltip_thorough_health_check_repair_attempt" style="display: none;">
                    <br>
                    <br><span name="lang_text"> If checked, HBBatchBeast will attempt to repair files using FFmpeg. A
                        new file with the suffix '_repaired' will be created in the same folder as the source
                        file.</span>

                    <br>

                </div>

                <div class="rowitem">
                    <div class="grid-container">

                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_repair_crf_value')" class="toolTipClass"></span><span
                                    name="lang_text">'CRF' value to use when attempting to repair files:</span></p>
                        </div>
                        <div class="grid-itemright"><input type="text" class="infoBox" id="CRFRepairValue">
                        </div>
                    </div>
                </div>
                <div id="tooltip_repair_crf_value" style="display: none;">

                    <br><span name="lang_text">The default 'CRF' value is 23. Please see the following for more
                        information:</span>
                    <br><br>https://trac.ffmpeg.org/wiki/Encode/H.264

                    <br> <br><span name="lang_text">The range of the CRF scale is 051, where 0 is lossless, 23 is the
                        default, and 51 is worst quality possible. A lower value generally leads to higher quality, and
                        a subjectively sane range is 1728. Consider 17 or 18 to be visually lossless or nearly so; it
                        should look the same or nearly the same as the input but it isn't technically lossless.</span>



                </div>



                <input type='button' class="button1" value='Save config' onclick='saveConfig()' />
                <input type='button' class="button2one1" value='Health check' onclick='convertFiles("healthCheck")' />



                <p></p>
                <p></p>
                <p><span name="lang_text">HBBatchBeast saves a list of scanned file paths reported as uncorrupt. Clear
                        the cache
                        to perform a fresh scan on all files.</span>
                    <p>




                        <input type="button" onclick="clearHealthyFileCache()" value="Clear healthy file cache"
                            class="infoButton">
                        <input type="button" onclick="viewLogs('ErrorLog')" value="View error log" class="infoButton">
            </center>
        </div>



        <div id="systemSettings" class="tabcontent">

            <center>

                <div class="rowitem">
                    <div class="grid-container">

                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_no_workers')" class="toolTipClass"></span><span
                                    name="lang_text">Number of simultaneous HandBrake/FFmpeg instances to
                                    use?(Recommended 4
                                    or fewer):</span></p>
                        </div>
                        <div class="grid-itemright"><input type="text" class="infoBox" id="instanceNumber">
                        </div>
                    </div>
                </div>
                <div id="tooltip_no_workers" style="display: none;">

                    <br><span name="lang_text">This setting applies to both the "Video health check" and "Scan and
                        convert"
                        processes. Specify how many HandBrake threads to use. There is no maximum although it's
                        recommended not to use
                        more than 4. A higher amount may freeze your computer if it's not very powerful.</span>


                </div>

                <div class="rowitem">
                    <div class="grid-container">

                        <div style="text-align: left">
                            <p><span onclick="toolTip('tooltip_included_file_types')" class="toolTipClass"></span><span
                                    name="lang_text">Include these file
                                    containers:</span>
                            </p>
                        </div>

                        <div style="text-align: right">
                            <textarea type="text" class="folderPaths" id="includedFileTypes"></textarea>
                        </div>

                    </div>
                </div>

                <div id="tooltip_included_file_types" style="display: none;">
                    <br>

                    <span name="lang_text">Enter the file containers to scan for. Each type needs to be separated by a
                        comma. The default entry is:</span>
                    <br>
                    <br>
                    mp4,mkv,mov,m4v,mpg,mpeg,avi,flv,webm,wmv,vob,evo,mts,m2ts,ts,iso,

                </div>

                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span name="lang_text">Queue size view limit?(Recommended 1000 or fewer):</span> </p>
                        </div>
                        <div class="grid-itemright"><input type="text" class="infoBox" id="queueSizeViewLimit">
                        </div>
                    </div>
                </div>

                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span name="lang_text">Automatically start "Scan and convert" when program
                                    opened?:</span>
                            </p>
                        </div>

                        <div class="grid-itemright"><input type="checkbox" id="autoStart"></div>
                    </div>
                </div>


                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_save_verbose_logs')" class="toolTipClass"></span><span
                                    name="lang_text">Save verbose logs?:</span>
                            </p>
                        </div>

                        <div class="grid-itemright"><input type="checkbox" id="saveWorkerLogs"></div>
                    </div>
                </div>

                <div id="tooltip_save_verbose_logs" style="display: none;">

                    <br> <span name="lang_text">Check this checkbox to save detailed sub-process logs. This includes
                        worker console output. This will cause very large logs.</span>



                </div>

                <br>
                <br>
                <br>

                <div class="remoteTab">
                    <p><span name="lang_text">Fill in email details to receive email notifications if an error is
                            encountered during a health
                            check or conversion/folder watching. Won't work with accounts that require 2FA. You need to
                            enable access to
                            less secure apps on Gmail accounts.</span></p>
                </div>

                <br>
                <br>
                <br>

                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span onclick="toolTip('tooltip_email_settings')" class="toolTipClass"></span><span
                                    name="lang_text">Email address:</span></p>
                        </div>

                        <div class="grid-itemright"><input type="text" class="infoBox2" id="emailAddress"> </div>
                    </div>
                </div>

                <div id="tooltip_email_settings" style="display: none;">

                    <br> <span name="lang_text">For example:</span>
                    <br>
                    <br><br>Email e.g.: example@exampleemail.com
                    <br><br>Password: Is not saved for security purposes.
                    <br><br>SMTP server e.g.: smtp.gmail.com


                </div>




                <div class="rowitem">
                    <div class="grid-container">

                        <div class="grid-itemleft">
                            <p><span name="lang_text">Email password(not saved):</span></p>
                        </div>

                        <div class="grid-itemright"><input type="password" class="infoBox2" id="emailPassword"> </div>

                    </div>
                </div>


                <div class="rowitem">
                    <div class="grid-container">
                        <div class="grid-itemleft">
                            <p><span name="lang_text">SMTP server:</span></p>
                        </div>

                        <div class="grid-itemright"><input type="text" class="infoBox2" id="SMTPServer"> </div>
                    </div>
                </div>




                <input type='button' class="infoButton" value='Email test' onclick='emailAlert("Test")' /><br>
                <input type="button" onclick="viewLogs('MasterLog')" value="View master log" class="infoButton">

                <br>
                <br>
                <br>

                <input type='button' class="button1" value='Save config' onclick='saveConfig()' />




            </center>
        </div>

        <div id="helpSection" class="tabcontent">

            <center>



                <input type="button" class="HaveAGitGat2"
                    onclick="openURL('https://github.com/HaveAGitGat/HBBatchBeast/wiki')" value="Wiki help">


                <input type="button" class="HaveAGitGat"
                    onclick="openURL('https://github.com/HaveAGitGat/HBBatchBeast')"
                    value="An application by HaveAGitGat">


                <p>
                    <font color="#66ccff">Discord: https://discord.gg/MSsgDqJ</font>
                </p>

                <p>
                    <font color="#66ccff">Email: HBBatchBeast@gmail.com</font>
                </p>

                <p>
                    <font color="#66ccff">hbbatchbeast.io</font>
                </p>
            </center>



        </div>


        <div id="remoteMonitoringSection" class="tabcontent">

            <center>

                <p><span name="lang_text">This feature allows monitoring of conversion/health check status using any
                        web-browser. Useful when running servers etc. No filenames are sent.</span></p>



                <div style="text-align: left">
                    <p>API Key:</p>
                </div>

                <div style="text-align: right">
                    <p><span id="apiKEY">fosifjiosfd8</span>
                        <p>
                            <input type="button" onclick="generateNewAPIKey()" value="New" class="infoButton">
                </div>


                <div class="remoteTab">


                    <p><span name="lang_text">If enabled, the following anonymous data will be sent to
                            HBBatchBeast.io:</span></p>

                    <p><span name="lang_text">API key</span></p>
                    <p><span name="lang_text">Current status ('Searching', 'Running', 'Finished' etc)</span></p>
                    <p><span name="lang_text">Number of:</span></p>
                    <p><span name="lang_text">Remaining items</span></p>
                    <p><span name="lang_text">Successful items</span></p>
                    <p><span name="lang_text">Errored items</span></p>
                    <p><span name="lang_text">Cancelled items</span></p>
                    <p><span name="lang_text">Worker percentages</span></p>
                    <p><span name="lang_text">Last completed item time</span></p>


                </div>
                <div class="grid-itemleft">
                    <p><span name="lang_text">Enable remote monitoring?:</span></p>
                </div>
                <div class="grid-itemright"><input type="checkbox" id="remoteViewOnOFF"></div>





                <input type='button' class="button2" value='Launch' onclick="launchRemoteView()"
                    style="display: block;" />



            </center>



        </div>

        <div id="benchmarkSection" class="tabcontent">

            <center>

                <center>

                    <div class="para">
                        <p><span name="lang_text">A basic benchmarking utility built mainly to see how 16+ core
                                processors perform using multiple HandBrake instances although it can be run on any type
                                of processor.</span></p>



                        <p><span name="lang_text">This will download a h265 4k sample file (2.5MB) and run a benchmark
                                using 4 HandBrake instances with preset "Very Fast 1080p30"</span></p>




                        <p><span name="lang_text">Results can be uploaded to hbbatchbeast.io if you choose.</span></p>

                    </div>



                </center>

                <input type='button' class="button2" value='Benchmark' onclick='verifyBenchFiles()'
                    style="display: block;" />

                <input type='button' class="infoButton" value='See results'
                    onclick="openURL('http://hbbatchbeast.io/overallresults')">

            </center>



        </div>


        <center>


            <div id="timerDiv"></div>




            <div id="worker1progress"> </div>




            <br>
            <br>
            <div ALIGN="LEFT">
                <div id='totalFilesDiv'></div>
                <div id='buildQueueDiv'></div>
                <div id='totalUnconvertedFilesDiv'></div>
                <div id='startTimeDiv'></div>
                <div id='durationDiv'></div>
                <div id='endTimeDiv'></div>
            </div>


            <div id='myChartDiv' style="display: none;">


            </div>





            <div id="pauseButtonDiv" style="display: none;">
                <input type="button" onclick="pauseQueue()" value="Pause queue" class="infoButton">
            </div>

            <div id="continueButtonDiv" style="display: none;">
                <input type="button" onclick="continueQueue()" value="Continue queue" class="infoButton">
            </div>

            <div id="continueButtonGreyDiv" style="display: none;">
                <input type="button" value="Continue queue" class="infoButtonGrey">
            </div>

            <div id="stopButtonDiv" style="display: none;">
                <br>
                <input type="button" onclick="stopQueue()" value="Stop queue" class="infoButton">
            </div>






            <div id="workerStatusDiv"> </div>



            <div id="healthCheckDiv"></div>


            <input type='button' class="button2" id="convertSelectedButton" value='Convert selected files'
                onclick='launchWorkerModules("launchModules")' style="display: none;" />


            <div ALIGN="LEFT">

                <div id="viewStatus"></div>
                <input type='button' id="queueButton" class="button4" value='Toggle queue view'
                    onclick='toggleView("fullQueueDiv")' style="display: none;" />





            </div>



            <div id="fullQueueDiv" style="display: none;">

                <div ALIGN="RIGHT">

                    <input type='button' id="deselectAllButton" class="infoButton" value='Deselect all'
                        onclick='deselectAllItems()' />
                    <input type='button' id="invertAllButton" class="infoButton" value='Invert all'
                        onclick='invertAllItems()' />
                    <input type='button' id="selectAllButton" class="infoButton" value='Select all'
                        onclick='selectAllItems()' />
                </div>


                <p><span name="lang_text">Queue</span></p>

                <span name="lang_text">Success</span><input type="checkbox" class="rounded" id="showSuccess1"
                    onchange='toggleShowRowsQ(this,"rgb(89, 255, 116)","rgb(89, 255, 116)")' checked>
                <span name="lang_text">Error</span><input type="checkbox" class="rounded" id="showError1"
                    onchange='toggleShowRowsQ(this,"rgb(255, 45, 45)","rgb(255, 45, 45)")' checked>
                <span name="lang_text"> Cancelled</span><input type="checkbox" class="rounded" id="showCancelled1"
                    onchange='toggleShowRowsQ(this,"rgb(255, 218, 109)","rgb(255, 218, 109)")' checked>

                <span name="lang_text"> Remaining</span><input type="checkbox" class="rounded" id="showRemaining1"
                    onchange='toggleShowRowsQ(this,"rgb(242 , 242, 242)","")' checked>

                <span name="lang_text"> Other</span><input type="checkbox" class="rounded" id="showOther1"
                    onchange='toggleShowRowsQ(this,"rgb(255, 162, 76)","rgb(255, 162, 76)")' checked></p>


                <div id="fullQueue">

                </div>
            </div>



            <div id="files"></div>
            <div id="files2"></div>
            <div ALIGN="LEFT">
                <input type='button' id="outputButton" class="button4" value='Toggle output view'
                    onclick='toggleView("sessionConversions")' style="display: none;" />




            </div>






            <div id="sessionConversions" style="display: none;">



                <p><span name="lang_text">Output this session:</span></p>


                <p> <span name="lang_text">Success</span><input type="checkbox" class="rounded" id="showSuccess"
                        onchange='toggleShowRowsO(this,"rgb(89, 255, 116)")' checked>
                    <span name="lang_text">Error</span><input type="checkbox" class="rounded" id="showError"
                        onchange='toggleShowRowsO(this,"rgb(255, 45, 45)")' checked>
                    <span name="lang_text"> Cancelled</span><input type="checkbox" class="rounded" id="showCancelled"
                        onchange='toggleShowRowsO(this,"rgb(255, 218, 109)")' checked>
                    <span name="lang_text"> Other</span><input type="checkbox" class="rounded" id="showOther"
                        onchange='toggleShowRowsO(this,"rgb(255, 162, 76)")' checked></p>





                <table id="sessionConversionsTable" class="historicTable">


 

                    <th class="headcol2">Source file</th>
                    <th class="headcol2">No.</th>

                    <th class="headcol2">Preset</th>

                    <th class="headcol2">FFprobe</th>

                    <th class="headcol2">Status</th>
                    <th class="headcol2">Finish time</th>
                    <th class="headcol2">Old size (GB)</th>
                    <th class="headcol2">New size (GB)</th>

                    

                    


                </table>



            </div>


        </center>

    </div>



</body>





</html>